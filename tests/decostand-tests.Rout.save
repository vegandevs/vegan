
R version 4.5.1 (2025-06-13) -- "Great Square Root"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###<--- BEGIN TESTS --->
> suppressPackageStartupMessages(require(vegan))
> 
> ############################### CLR ####################################
> # Calculates clr-transformation. Should be equal.
> 
> # Test data
> data(varespec)
> set.seed(42)
> testdata <- matrix(round(runif(1000, 0, 100)), nrow = 20)
> testdata <- testdata - 50
> testdata[testdata < 0] <- 0
> rownames(testdata) <- paste0("row", seq_len(nrow(testdata)))
> colnames(testdata) <- paste0("col", seq_len(ncol(testdata)))
> testdata.with.pseudo <- testdata + 1
> 
> # Calculates relative abundance table
> relative <- decostand(testdata, "total")
> relative.with.pseudo <- decostand(testdata + 1, "total")
> 
> # CLR data
> x.clr  <- decostand(testdata + 1, method = "clr")
> x.rclr <- decostand(testdata, method = "rclr")
> x.clr.pseudo <- decostand(testdata, method = "clr", pseudocount = 1)
> 
> max(abs(x.clr - x.clr.pseudo)) < 1e-6
[1] TRUE
> max(abs(decostand(testdata + 1, method = "clr", pseudocount = 0) - x.clr.pseudo)) < 1e-6
[1] TRUE
> 
> # Tests clr
> alt.clr <- t(apply(as.matrix(relative.with.pseudo), 1, FUN = function(x){log(x) - mean(log(x))}))
> max(abs(x.clr - alt.clr)) < 1e-6
[1] TRUE
> 
> # Test that NAs are handled as expected in CLR
> x <- testdata
> set.seed(24)
> x[sample(prod(dim(x)), 50)] <- NA # insert some NAs in the data
> # NAs in the original data remain NAs in the returned data
> all(is.na(decostand(x, "clr", na.rm = FALSE, pseudocount = 1)[is.na(x)])) == TRUE # NAs
[1] TRUE
> # For the other (non-NA) values, we get non-NA values back
> any(is.na(decostand(x, "clr", na.rm = FALSE, pseudocount = 1)[!is.na(x)])) == FALSE
[1] TRUE
> any(is.na(decostand(x, "clr", MARGIN = 2, na.rm = FALSE, pseudocount = 1)[!is.na(x)])) == FALSE 
[1] TRUE
> # Results match for the non-NA values always (with tolerance 1e-6)
> inds <- !is.na(x) # Non-NA values
> max(abs(decostand(x, "clr", na.rm = FALSE, pseudocount = 1)[inds] -
+         decostand(x, "clr", na.rm = TRUE, pseudocount = 1)[inds])) < 1e-6
[1] TRUE
Warning message:
In .calc_clr(x, na.rm = na.rm, ...) :
  replacing missing values with zero for `method = "clr"`
	         - disable this with `na.rm = FALSE`
> # For the other (non-NA) values, we get non-NA values back
> any(is.na(decostand(x, "alr", na.rm = FALSE, pseudocount = 1)[!is.na(x[, -1] - x[, 1])])) == FALSE
[1] TRUE
> any(is.na(decostand(x, "alr", na.rm = FALSE, pseudocount = 1, reference=3)[!is.na(x[, -3] - x[, 3])])) == FALSE
[1] TRUE
> # Works correctly also with other MARGIN
> inds <- !is.na(x) # Non-NA values
> max(abs(decostand(x, "clr", MARGIN = 2, na.rm = FALSE, pseudocount = 1)[inds] -
+         decostand(x, "clr", MARGIN = 2, na.rm = TRUE, pseudocount = 1)[inds])) < 1e-6
[1] TRUE
Warning message:
In .calc_clr(t(x), na.rm = na.rm, ...) :
  replacing missing values with zero for `method = "clr"`
	         - disable this with `na.rm = FALSE`
> # Results match for the non-NA values always (with tolerance 1e-6)
> inds <- !is.na(x) # Non-NA values
> max(abs(na.omit(decostand(x, "alr", na.rm = FALSE, pseudocount = 1)[inds] -
+                 decostand(x, "alr", na.rm = TRUE, pseudocount = 1)[inds]))) < 1e-6
[1] TRUE
Warning message:
In .calc_alr(x, na.rm = na.rm, ...) :
  replacing missing values with zero for `method = "alr"`
	         - disable this with `na.rm = FALSE`
> 
> # Test that NAs are handled as expected in ALR
> set.seed(4354353)
> x <- testdata
> x[sample(prod(dim(x)), 50)] <- NA
> x[4, c(2, 10)] <- NA  # insert some NAs in the data
> # NAs in the output share NAs with the reference vector
> all(is.na(decostand(x, "alr", na.rm = FALSE, pseudocount = 1, reference = 4))[which(is.na(x[,4])),])
[1] TRUE
> # Output vector has same NAs than the original vector and reference vector
> all(is.na(decostand(x, "alr", na.rm = FALSE, pseudocount = 1, reference = 4)[,2]) == (is.na(x[,4]) | is.na(x[,2])))
[1] TRUE
> # No NAs after removing them
> !any(is.na(decostand(x, "alr", na.rm = TRUE, pseudocount = 1, reference = 4)))
[1] TRUE
Warning message:
In .calc_alr(x, na.rm = na.rm, ...) :
  replacing missing values with zero for `method = "alr"`
	         - disable this with `na.rm = FALSE`
> # All NAs are replaced by zero
> all((rowMeans(decostand(x, "alr", na.rm = TRUE, pseudocount = 1, reference = 4) == 0) == 1) == is.na(x[,4]))
[1] TRUE
Warning message:
In .calc_alr(x, na.rm = na.rm, ...) :
  replacing missing values with zero for `method = "alr"`
	         - disable this with `na.rm = FALSE`
> 
> # Expect that error does not occur
> decostand(testdata, method = "rclr")
            col1         col2         col3        col4        col5        col6
row1   0.1226672  0.083885024  0.041910621  0.05447274 -0.04533134 -0.18908731
row2   0.8149653  0.470058458  0.231710691  0.71124682 -0.49189567 -1.52781566
row3   0.1724082 -0.031650021 -0.065869203  1.13460213  0.10815032 -0.32149030
row4  -0.3834569 -0.211244585 -0.071207355 -0.70849645 -0.10970962  0.45166721
row5  -0.3323267 -0.136124506 -0.070393221 -0.45427055  0.38525044  0.84787503
row6  -0.6673927 -0.486535840 -0.182866040 -0.80583839 -0.50368486  0.37265881
row7  -0.6709047 -0.504589464 -0.226883982 -0.39074608 -0.15214518  0.64519808
row8   0.1730506  0.051337111  0.000253358  0.58139842  0.04619966 -0.26448486
row9   0.1190910  0.097046186  0.083635587 -0.36515926 -0.39605885 -0.45224452
row10  0.6633127  0.713521620  0.336569470 -0.44523499  0.64989868  0.05506890
row11  0.8000872  0.792864087  0.344564514 -0.00761715  0.91595579  0.08565031
row12 -0.1798694  0.003479676  0.060982931 -1.14853716 -0.26767294  0.16929812
row13  0.1797414  0.107851412  0.035063958  0.32803205  0.10472611 -0.15629534
row14 -0.3444308 -0.291768542 -0.121991147 -0.19307592 -0.28375752  0.11920058
row15  0.1526191 -0.031350577 -0.089973902  1.32487681  0.42205256 -0.02089938
row16  0.2057127  0.080116509  0.017885806  0.53903869  0.01447757 -0.32249231
row17  1.4429676  1.029915281  0.354660623  2.12775042  1.36374012 -0.60902694
row18 -1.3538426 -1.224333827 -0.552222580 -0.12779398 -0.93626704  0.51363144
row19 -0.1677221  0.066362031  0.102374070 -1.44400292 -0.24228797  0.24697846
row20 -0.7466771 -0.578840033 -0.228204199 -0.71064524 -0.58164026  0.35660970
             col7         col8         col9       col10       col11
row1  -0.10333753 -0.061834870 -0.012419388  0.04117590 -0.28080372
row2  -0.89784013 -0.484099540 -0.179036025  0.36712737 -1.65200123
row3   0.00728522 -0.089018878 -0.074921712 -0.27311489  0.71680279
row4   0.07205560  0.146266729  0.016665885  0.17407605  0.21073783
row5   0.56590088  0.259725772  0.148156481 -0.27156541  0.63213431
row6  -0.21703996  0.141627821 -0.113953063  0.48254975  0.57873862
row7   0.14473972  0.225449581 -0.047680646  0.11941434  1.19963319
row8  -0.04323735 -0.079969095 -0.036089782 -0.12286064  0.15136965
row9  -0.46101834 -0.142544547 -0.078394040  0.40366352 -0.88791467
row10  0.40793913 -0.035111289  0.291155487 -0.37806286 -1.66624913
row11  0.61706750 -0.029899200  0.336867458 -0.65938725 -1.42512023
row12 -0.17228727  0.045706663  0.025940983  0.40553883 -0.81041005
row13  0.02269258 -0.052724636  0.009319004 -0.12455575 -0.06960365
row14 -0.14333581  0.055046591 -0.089714574  0.22852207  0.49553636
row15  0.34262514  0.001004873  0.002213205 -0.56683512  1.14123008
row16 -0.08996213 -0.099375213 -0.039571947 -0.08557087  0.01040923
row17  0.74909800 -0.244763765  0.291912531 -1.33776835 -0.71488346
row18 -0.39146255  0.237571508 -0.362921281  0.63804357  2.65824999
row19 -0.14263463  0.063281026  0.065728145  0.43918825 -1.10545605
row20 -0.26724808  0.143660469 -0.153256723  0.52042149  0.81760012
             col12        col13        col14        col15       col16
row1  -0.122964042 -0.007136787 -0.035329798 -0.036293705 -0.06642869
row2  -0.733540240 -0.170630594 -0.384590264 -0.421075707 -0.67895229
row3   0.363381390  0.385791664 -0.306207478 -0.170724832 -0.70351516
row4   0.049564876 -0.347295915  0.197766838  0.081298833  0.49407193
row5   0.295864760  0.224976099  0.252299898  0.310211487  0.40245592
row6   0.158194441 -0.836690371  0.139981604 -0.123686179  0.55767827
row7   0.479797884 -0.390702004  0.114364062 -0.009455921  0.36059180
row8   0.092902386  0.207615303 -0.164760310 -0.092291798 -0.38055824
row9  -0.438765872 -0.454855805 -0.007749531 -0.149166441  0.13506805
row10 -0.655670797  0.726238661  0.255644265  0.463498826  0.21574722
row11 -0.505134490  1.121299723  0.192109481  0.525299778 -0.03834541
row12 -0.422042031 -0.554061046  0.268657326  0.083031048  0.69022193
row13 -0.004874668  0.216634347 -0.077506359 -0.007028283 -0.22136049
row14  0.171850220 -0.410015073  0.002417544 -0.123090721  0.15055476
row15  0.587884633  0.742800478 -0.276563978 -0.031773452 -0.76752170
row16  0.027401760  0.173755687 -0.163121526 -0.101431447 -0.36697547
row17 -0.066420935  2.170835810 -0.340266457  0.344168429 -1.39704267
row18  1.024310427 -1.296960126 -0.123369073 -0.511788933  0.23901335
row19 -0.556893853 -0.586530082  0.358844331  0.158160156  0.86864891
row20  0.255154150 -0.915069970  0.097379425 -0.187861137  0.50664797
             col17         col18        col19       col20       col21
row1   0.067775402 -0.0727300354 -0.002342813 -0.13030273 -0.33220235
row2   0.433619583 -0.4300366165  0.068725070 -0.69521048 -2.50608287
row3  -0.443486819  0.2247009327  0.252705503  0.89797532  0.19170754
row4   0.169024295  0.0247487910 -0.123056534 -0.26620031  0.36117527
row5  -0.230878036  0.1713977899 -0.067561501  0.27492891  1.36077917
row6   0.325574375  0.0905017794 -0.111158678 -0.31468107  0.09703062
row7  -0.072604473  0.2838758239 -0.010011213  0.32771074  0.95562532
row8  -0.179667389  0.0595393417  0.118800681  0.35297781 -0.09573147
row9   0.463776775 -0.2626815501 -0.103693214 -0.76777890 -1.17576737
row10  0.081811039 -0.3971354254 -0.190697124 -0.69553738 -0.13810761
row11 -0.200899269 -0.3052436973 -0.101877782 -0.26328416  0.25908609
row12  0.549370437 -0.2591011928 -0.255286052 -1.02188761 -0.51319911
row13 -0.112311634 -0.0009122632  0.056748572  0.16128400 -0.05920870
row14  0.093665629  0.1022672877 -0.003515761  0.02004537  0.06353517
row15 -0.734451700  0.3586538344  0.301509058  1.32906192  0.94159661
row16 -0.125881258  0.0202978869  0.104408420  0.25233030 -0.24131969
row17 -1.038378136 -0.0296182586  0.333799548  1.23406342  0.47284067
row18 -0.003078877  0.6139392921  0.138957096  0.78137896  0.80241174
row19  0.657977094 -0.3418340495 -0.328237568 -1.28287521 -0.56903376
row20  0.299042961  0.1493703290 -0.078215709 -0.19399890  0.12486475
            col22       col23       col24       col25      col26      col27
row1   0.01493330  0.09272288 -0.03331729 -0.12515308  0.2084107  0.1022861
row2   1.05681310  0.69685352 -0.18337484 -1.03784667  0.9189843  0.8812151
row3   1.40063639 -0.25217825 -0.01657225  0.04330262 -1.3004483  0.8060816
row4  -0.41579725  0.04197484  0.10730421  0.09500940  0.1991080 -0.6679457
row5  -1.07387437 -0.40167281  0.04618015  0.62723424 -0.1790447 -0.4476095
row6   0.60875018  0.23842584  0.24219229 -0.17654709 -0.2035482 -0.9213644
row7   0.57836781 -0.15134783  0.22310650  0.23162434 -0.9060153 -0.6440303
row8   0.62178785 -0.07519320 -0.03576216 -0.04026921 -0.4727124  0.4620809
row9   0.04584542  0.47896521 -0.01216727 -0.52816195  0.9013176 -0.1819387
row10 -2.94350066 -0.08083124 -0.31611948  0.31344358  1.9930196  0.1598638
row11 -2.95352383 -0.32743751 -0.37137170  0.53963163  1.5954333  0.5274092
row12 -1.08966741  0.38475521  0.03645154 -0.21873247  1.3429961 -0.8300005
row13  0.08012005 -0.06336801 -0.05651639  0.01540257 -0.1003876  0.3142592
row14  0.72643187  0.09272167  0.13814855 -0.11253964 -0.4259220 -0.3401583
row15  1.10139929 -0.56863956 -0.03651956  0.41364267 -1.7008588  0.9330633
row16  0.57274547 -0.02122994 -0.04508165 -0.09710546 -0.3290401  0.4530034
row17 -1.24389389 -0.83237616 -0.53660831  0.70048521 -0.1922073  2.2479616
row18  3.52297572  0.07220864  0.55240373 -0.22535207 -2.6433131 -0.9367051
row19 -1.64025313  0.43679784  0.01564416 -0.20476390  1.7974781 -1.0027870
row20  1.02970409  0.23884887  0.28197978 -0.21330472 -0.5032498 -0.9146848
            col28       col29       col30       col31       col32       col33
row1   0.19770943 -0.12303937  0.07846402  0.09345842  0.02381466  0.37893567
row2   1.14535525 -0.90579599  0.78358231  1.45675694 -0.29562538  2.51565864
row3  -0.68077053  0.47316625 -0.02162212  1.55410267 -0.81749767 -0.85247814
row4  -0.03207079 -0.14395848  0.02448791 -0.77330190  0.24388257 -0.17817513
row5  -0.44494324  0.52671523 -0.56024441 -1.12752224  0.40027531 -1.19978495
row6  -0.21385957 -0.45549809  0.46162855 -0.20605357 -0.18612247 -0.16615732
row7  -0.76642840  0.14691905  0.05823185 -0.06644553 -0.32453251 -1.24246395
row8  -0.19514177  0.16890057  0.01294821  0.76861061 -0.35251503 -0.17781282
row9   0.74106288 -0.72112433  0.47945435 -0.05108295  0.16086368  1.43807789
row10  1.13078778  0.12050916 -0.73811813 -1.99117723  1.43292752  1.14917765
row11  0.85665594  0.52479352 -1.01323211 -1.75796110  1.33475440  0.60832053
row12  0.77462118 -0.66789603  0.21659633 -1.33656615  0.71243935  1.13881571
row13 -0.01363103  0.13077787 -0.07766026  0.27718246 -0.07335128 -0.01046656
row14 -0.27627125 -0.17216918  0.28462053  0.28202816 -0.31716936 -0.26699026
row15 -1.05744370  0.94890937 -0.39803622  1.40100730 -0.78986694 -1.67893218
row16 -0.08473237  0.08871831  0.05380125  0.73243735 -0.30771438  0.01669270
row17 -0.01401816  1.47878961 -1.30828126  0.65004724  0.24057118 -0.53571028
row18 -1.70367143 -0.19799430  0.94543546  1.84395796 -1.70080286 -2.01656843
row19  1.01959017 -0.76780681  0.16455694 -1.84836202  1.01178109  1.42527361
row20 -0.38280041 -0.45291635  0.55338681  0.09888358 -0.39611186 -0.34541240
            col34       col35       col36       col37       col38       col39
row1   0.18630217  0.06808972 -0.28881453 -0.01405009 -0.08072494 -0.01944272
row2   1.29842362  0.71947256 -2.22183664 -0.05166909 -0.90339842  0.12888561
row3  -0.27472247 -0.08005733  0.04709895 -0.12029912 -0.96415579  0.45265160
row4  -0.15181802  0.09201133  0.37245212  0.14468721  0.62796548 -0.11739685
row5  -0.64930656 -0.54377138  1.22223555 -0.02726618  0.57405623 -0.21210271
row6  -0.11363333  0.59123404  0.13226339  0.32683841  0.61630029  0.14327224
row7  -0.60184245  0.14883516  0.83572680  0.20215121  0.38203378  0.21914586
row8  -0.02015018 -0.02479807 -0.13983986 -0.07630150 -0.50973622  0.19011645
row9   0.66597154  0.50886266 -0.97907682  0.11205968  0.15877470 -0.09418811
row10  0.40686667 -0.84270109 -0.02175942 -0.31282608  0.51191685 -0.84922874
row11  0.17801167 -1.16491415  0.28466590 -0.44157819  0.20784056 -0.80269623
row12  0.42308947  0.28862021 -0.32772696  0.17074076  0.92168121 -0.39168434
row13  0.02136264 -0.11334958 -0.07763145 -0.08376072 -0.27228515  0.03147012
row14 -0.11396429  0.34695117  0.05391179  0.16565696  0.11802003  0.19915998
row15 -0.66932007 -0.48443051  0.68052406 -0.21992938 -1.01565608  0.43573917
row16  0.06830364  0.01646157 -0.26013791 -0.07148722 -0.48913800  0.16333410
row17 -0.15365551 -1.62101434  0.26702051 -0.80746535 -1.56853013 -0.22025940
row18 -0.84161517  1.15830749  0.62218763  0.56799507 -0.01687293  1.03832833
row19  0.51843217  0.24188449 -0.34112807  0.17411692  1.18301640 -0.56177901
row20 -0.17673553  0.69430604  0.13986496  0.36238668  0.51889213  0.26667464
            col40       col41        col42       col43       col44
row1   0.01512375  0.32695716 -0.002892249  0.13421290  0.07718009
row2  -0.13615762  2.34342645 -0.181194784  1.49223230  0.32046087
row3  -0.52521031  0.24154602 -0.647267291  0.57451380 -0.58460107
row4   0.19346280 -0.75002171  0.369625758 -0.30230464  0.13551075
row5   0.18834640 -1.12945359  0.130694295 -1.07247454 -0.05429767
row6   0.02924656 -1.01788093  0.461390203  0.36031101  0.01238754
row7  -0.12221164 -1.39076305  0.150643316 -0.03181338 -0.30447428
row8  -0.23285737  0.32958935 -0.316547521  0.31945087 -0.22579277
row9   0.16606791  0.68278684  0.309189980  0.52109723  0.39072742
row10  0.69442857  0.92277492  0.227365305 -1.48503657  0.75205459
row11  0.57463528  0.95871648 -0.056976772 -1.68620972  0.55352434
row12  0.49331397 -0.10146599  0.686594773 -0.27958285  0.61057089
row13 -0.07632757  0.29937433 -0.181773495  0.03704768 -0.06882192
row14 -0.11360981 -0.51224969  0.114888362  0.38193509 -0.13069679
row15 -0.56817959 -0.12172580 -0.823661951  0.10110821 -0.76794384
row16 -0.20182614  0.43859779 -0.280628108  0.35436136 -0.16645536
row17 -0.21414272  1.91289545 -1.275085877 -1.04399593 -0.31059400
row18 -0.75514058 -2.21876283  0.052323943  1.58503566 -0.93845329
row19  0.66808563 -0.08448455  0.853171564 -0.52657210  0.80366740
row20 -0.07704752 -1.12985667  0.410140550  0.56668363 -0.10395289
              col45        col46       col47       col48        col49
row1   3.191799e-02 -0.029553866  0.08339981 -0.32409759  0.025292507
row2   9.906295e-02 -0.075837742  0.94201476 -2.47650776  0.125318763
row3  -3.971138e-01  0.592059796  0.25563500  0.02326134 -0.193187693
row4   1.468811e-01 -0.288692504 -0.10433910  0.45058621  0.059031536
row5   7.946166e-05  0.008316607 -0.69788502  1.34665217 -0.043613578
row6   1.280234e-01 -0.383547624  0.40276069  0.23423630  0.061030848
row7  -8.454970e-02 -0.031924975  0.06412849  0.98169328 -0.067227547
row8  -1.694910e-01  0.270557656  0.14467458 -0.17405723 -0.077134842
row9   2.434387e-01 -0.380869036  0.41921724 -1.05653230  0.152599938
row10  3.464951e-01 -0.238989396 -1.04970129 -0.11256079  0.162118964
row11  1.906561e-01  0.045276658 -1.26057103  0.19338003  0.074987263
row12  4.209807e-01 -0.654164563 -0.04006858 -0.32066299  0.215230077
row13 -7.433235e-02  0.152224855 -0.02624729 -0.10808307 -0.033944530
row14 -1.901387e-02 -0.086023907  0.31998680  0.10498708 -0.008715925
row15 -5.219228e-01  0.814325019 -0.11104011  0.69910006 -0.276660475
row16 -1.358523e-01  0.224903308  0.17384495 -0.30634456 -0.056726257
row17 -4.660468e-01  1.136110162 -1.11371124  0.08058089 -0.243404023
row18 -3.485681e-01  0.067253665  1.23443631  0.84720897 -0.180851965
row19  5.393378e-01 -0.809036870 -0.18006391 -0.33572853  0.272338126
row20  7.001738e-02 -0.332387241  0.54352892  0.25288849  0.033518813
            col50
row1  -0.01146742
row2  -0.29991806
row3  -0.71138561
row4   0.39338841
row5   0.22524476
row6   0.41291181
row7   0.13278653
row8  -0.34839714
row9   0.27027251
row10  0.40020057
row11  0.13373627
row12  0.72284725
row13 -0.18299523
row14  0.06810050
row15 -0.84680931
row16 -0.31383814
row17 -1.15104467
row18 -0.14885299
row19  0.91755915
row20  0.33766080
attr(,"scaled:center")
 [1] -0.0031079619 -0.0463480942 -0.0267762284  0.0089869339  0.0380073003
 [6] -0.0216677154 -0.0095070243 -0.0129853877 -0.0151765084  0.0739366224
[11]  0.0813752690  0.0153170116 -0.0001358339 -0.0203385433 -0.0102092705
[16] -0.0133788389  0.0543704488 -0.0876478093  0.0272043261 -0.0319186959
attr(,"parameters")
attr(,"parameters")$margin
[1] 1

attr(,"decostand")
[1] "rclr"
> decostand(testdata, method = "clr", pseudocount = 1)
            col1       col2      col3       col4        col5       col6
row1   2.1032316  2.0791341 -1.634438  1.3100010  0.56278658  1.0046193
row2   2.1761262 -1.6305363 -1.630536  2.2612840 -1.63053632 -1.6305363
row3  -1.1900323  2.7219907 -1.190032  2.1058045 -1.19003233 -1.1900323
row4   1.8206928  2.1229737  2.165533  0.3737738  1.06692099 -1.7056677
row5   1.0992724 -1.6087778 -1.608778  1.9747412  1.75851808  2.1978847
row6  -0.6739464 -1.0794115  2.077589 -1.7725587  0.17335146  2.0775889
row7   1.9153276 -1.3035482  2.385331 -1.3035482 -1.30354821  1.9153276
row8  -1.1135727  2.6240970  1.594478  2.4127879 -1.11357267  2.0644812
row9   1.5569880 -1.2762253  2.594976  1.7195069 -1.27622533  0.3332126
row10  1.9431078  2.4074134  1.417015 -1.1479346 -1.14793462 -1.1479346
row11 -1.2687951  1.9500807 -1.268795 -1.2687951  1.62157666  1.2161115
row12  1.6626874  1.9929291 -1.472807 -1.4728068 -1.47280678  2.0825413
row13  2.3237457 -1.4604440 -1.460444 -1.4604440 -1.46044396  1.7976526
row14 -1.3606232  1.6351090  2.006673 -1.3606232  2.42356641 -1.3606232
row15 -1.4083907 -1.4083907 -1.408391 -1.4083907  2.37579893  0.2010472
row16  2.2983853  2.0180833  1.749819  1.6272170  1.66977665  0.1011607
row17  2.6744936 -1.2173267  1.727112 -1.2173267 -1.21732666 -1.2173267
row18 -1.1331537 -1.1331537 -1.133154 -1.1331537 -0.03454143 -1.1331537
row19 -1.6565066  2.0811630 -1.656507 -0.9633594  1.56236920  0.8284000
row20  0.2342048  0.7732013 -1.018558 -1.7117053  0.85324403  1.8146552
            col7      col8          col9      col10      col11      col12
row1  -1.6344380 -1.634438  2.1497516329  2.1267621  2.0544415 -1.6344380
row2  -1.6305363 -1.630536  0.1612231483  1.9803816 -0.5319240 -1.6305363
row3   0.8894092 -1.190032  1.2078629468 -1.1900323  2.3934866  0.4194056
row4   0.5969174  1.661628 -1.7056677321 -1.7056677 -1.7056677  2.1444799
row5   1.5267165  1.569276  0.0006601595  1.6100981 -1.6087778 -1.6087778
row6  -1.7725587  1.723949 -1.7725586865  1.4855379 -1.7725587  1.7239489
row7   2.4576519 -1.303548 -1.3035482139  2.4576519  2.5676528 -1.3035482
row8   2.7365749  2.693090 -1.1135726669  2.2876247 -1.1135727 -1.1135727
row9  -1.2762253 -1.276225 -1.2762253269 -1.2762253 -1.2762253 -1.2762253
row10  1.9875596 -1.147935 -1.1479346150 -1.1479346 -1.1479346 -1.1479346
row11  2.4447770  1.866699  1.9092587295 -1.2687951  0.3406428 -1.2687951
row12  0.9250885 -1.472807 -1.4728067753  1.8944891  1.2997819 -1.4728068
row13  1.1786134  1.906852 -1.4604439551 -1.4604440 -1.4604440 -1.4604440
row14  2.4460393 -1.360623 -1.3606232237 -1.3606232 -1.3606232 -1.3606232
row15  2.1751282  1.536048 -1.4083907017 -1.4083907 -1.4083907  2.5234349
row16  0.6889474  1.859019 -1.5082771842 -1.5082772  2.0470709  1.9257100
row17  2.2791809 -1.217327  2.2791808981  0.1689677  0.8621149 -1.2173267
row18 -1.1331537 -1.133154  1.1694313743 -1.1331537 -1.1331537  2.5044324
row19  1.6393302 -1.656507  1.7446907552  1.5623692  0.1352528  0.1352528
row20  0.8532440  1.232734  1.6204991818  1.4663485  1.9771741 -1.7117053
            col13     col14     col15     col16      col17      col18
row1  -1.63443800  1.456604 -1.634438 -1.634438 -1.6344380 -1.6344380
row2   0.31537383 -1.630536 -1.630536 -1.630536 -1.6305363 -1.6305363
row3  -1.19003233 -1.190032 -1.190032 -1.190032 -1.1900323  2.2439549
row4  -1.70566773  2.122974  2.186153 -1.705668 -1.7056677 -1.7056677
row5   0.18298172 -1.608778 -1.608778  2.054784  0.3371324 -1.6087778
row6  -1.77255869 -1.772559 -1.772559  2.011631  2.0341038 -1.7725587
row7  -1.30354821  2.334038 -1.303548 -1.303548 -1.3035482  2.5250932
row8  -1.11357267 -1.113573 -1.113573 -1.113573  2.4417754 -1.1135727
row9  -1.27622533  2.507964 -1.276225 -1.276225  1.8592689  2.1895106
row10  2.65872787  2.540945 -1.147935 -1.147935  2.1101619  2.5897350
row11 -1.26879510 -1.268795  2.368791 -1.268795  2.4924050 -1.2687951
row12 -1.47280678  1.928391  1.705247  2.419014 -1.4728068  0.7244178
row13 -1.46044396 -1.460444 -1.460444 -1.460444 -1.4604440 -1.4604440
row14  0.02567114 -1.360623 -1.360623 -1.360623 -1.3606232 -1.3606232
row15 -1.40839070  2.280489 -1.408391 -1.408391  1.5360483  1.8104851
row16  1.92571002 -1.508277 -1.508277  2.275912 -1.5082772 -1.5082772
row17 -1.21732666 -1.217327  2.078510 -1.217327  0.1689677  1.7784056
row18  0.47628419 -1.133154  1.264742  1.639435 -1.1331537  2.6954877
row19  0.42293492 -1.656507 -1.656507  2.057065  1.8092293 -1.6565066
row20  0.85324403 -1.711705 -1.711705  2.200318 -1.7117053 -1.7117053
           col19      col20      col21         col22     col23      col24
row1   0.3114721  0.5627866 -1.6344380 -1.6344380010  1.138151 -1.6344380
row2   1.1420524 -1.6305363 -0.9373891 -1.6305363210  2.130664 -1.6305363
row3  -1.1900323 -1.1900323  1.4490250  2.7017879721 -1.190032  2.3363282
row4   2.1861526 -1.7056677 -1.7056677  1.7600681707  1.905250 -1.7056677
row5   1.0992724  0.7891175  2.0547839  0.0006601595 -1.608778 -1.6087778
row6   0.4246659  1.7239489 -1.7725587 -1.7725586865 -1.772559  0.9354915
row7   1.2614011 -1.3035482  2.5882721 -1.3035482139 -1.303548 -1.3035482
row8   2.6706170  2.7365749 -1.1135727 -1.1135726669  2.352163 -1.1135727
row9  -1.2762253 -1.2762253 -1.2762253  1.7195069467  1.614146 -1.2762253
row10 -1.1479346 -1.1479346 -1.1479346 -0.4547874344 -1.147935  2.4629833
row11 -1.2687951  2.3421228 -1.2687951 -0.5756479203 -1.268795 -1.2687951
row12 -1.4728068 -0.3741945  0.7244178  0.3189526940 -1.472807 -1.4728068
row13  1.8353929  1.3727694 -1.4604440 -1.4604439551  1.584078  2.2772257
row14 -1.3606232 -1.3606232  1.7748710 -1.3606232237  1.472590  2.4680182
row15  1.6826518  1.7271035 -1.4083907  2.3757989322 -1.408391 -1.4083907
row16  2.3629238 -1.5082772 -1.5082772 -1.5082771842 -1.508277 -1.5082772
row17 -1.2173267  2.6538743 -1.2173267 -1.2173266634 -1.217327  1.1805686
row18 -1.1331537  2.6045159  2.2341421 -1.1331537187  1.757218  2.6045159
row19 -1.6565066  0.1352528 -1.6565066 -1.6565066265  2.032373 -1.6565066
row20  1.8146552 -1.7117053 -1.7117053 -1.7117053284  1.871814  1.6894921
           col25       col26      col27       col28      col29      col30
row1  -1.6344380 -1.63443800  1.8312979  1.50105621  1.7995492 -1.6344380
row2   0.5666883 -1.63053632  2.1536533  2.21961128 -1.6305363  2.1306638
row3   2.3653157 -0.09142004  2.3363282 -0.09142004 -1.1900323  1.7003394
row4  -1.7056677  1.76006817 -1.7056677 -1.70566773 -1.7056677  1.0669210
row5   2.1047943 -1.60877775  1.1638110  0.33713240 -1.6087778 -1.6087778
row6  -1.7725587  1.91632077  1.2231736  1.52327818 -1.7725587 -1.7725587
row7   2.3853312  0.89367636 -1.3035482  1.58682354  1.9153276  2.6084748
row8  -1.1135727 -1.11357267  2.6476274 -1.11357267 -1.1135727  2.7984503
row9  -1.2762253  2.43734674 -1.2762253 -1.27622533 -0.1776130 -1.2762253
row10 -1.1479346 -1.14793462 -1.1479346 -1.14793462  2.1479023  1.9431078
row11  2.6230252 -1.26879510  2.3421228  2.44477697  1.4392551 -1.2687951
row12 -1.4728068  1.85939773 -1.4728068 -1.47280678 -1.4728068  2.0535537
row13  2.1230750 -1.46044396  1.9407534  1.48399502  2.4515791 -1.4604440
row14 -1.3606232 -1.36062322  1.4119655 -1.36062322 -1.3606232  2.5712024
row15 -1.4083907 -0.30977841 -1.4083907 -1.40839070 -1.4083907  2.0573452
row16 -1.5082772 -1.50827718 -1.5082772 -1.50827718  1.1307801 -1.5082772
row17  2.0785102 -1.21732666 -1.2173267  2.54387345 -1.2173267  0.3921112
row18 -1.1331537 -1.13315372  0.2531406 -1.13315372 -1.1331537 -1.1331537
row19 -1.6565066 -1.65650663 -0.5578943  2.03237283  0.8284000 -1.6565066
row20 -1.7117053  0.48551925 -1.7117053  1.62049918  0.3677362 -1.7117053
            col31       col32      col33      col34      col35      col36
row1  -1.63443800 -1.63443800 -1.6344380  1.6977665 -1.6344380  1.6977665
row2  -1.63053632  0.67204877 -1.6305363  2.0830357  2.0330253 -0.9373891
row3   2.17726350 -1.19003233  1.0071923 -1.1900323  2.0680642 -1.1900323
row4  -1.70566773  1.47238610  1.8206928  1.7908398  2.1444799  1.4298265
row5  -0.51016546 -1.60877775 -0.5101655 -1.6087778 -1.6087778  1.7234268
row6  -1.77255869  1.27196375  1.2231736  1.5596458  1.7239489  1.3184838
row7   2.02865630 -1.30354821 -1.3035482  0.6423619 -1.3035482 -1.3035482
row8  -1.11357267 -1.11357267 -1.1135727 -1.1135727 -1.1135727 -1.1135727
row9  -1.27622533  1.85926889  2.5739223  2.2791227  1.9018285 -1.2762253
row10 -0.04932233 -1.14793462  2.6132655 -1.1479346  0.6438249  0.9315069
row11 -1.26879510 -1.26879510 -1.2687951 -1.2687951  1.2161115  2.3947665
row12 -0.37419449 -1.47280678  2.3558346  1.8944891 -1.4728068  2.1907549
row13  1.53528832 -1.46044396  2.1771422 -1.4604440  2.2031177 -1.4604440
row14 -1.36062322 -1.36062322  1.6838992 -1.3606232  2.1947248  1.8582526
row15  2.14695736  0.53751945 -0.7152435 -1.4083907 -1.4083907  2.0255965
row16  2.25292293  1.58276527 -1.5082772 -1.5082772  1.5827653  1.6272170
row17 -1.21732666 -1.21732666 -1.2173267 -1.2173267  0.1689677 -1.2173267
row18 -1.13315372 -0.03454143 -1.1331537 -1.1331537  2.6954877 -1.1331537
row19 -1.65650663  1.92701231 -1.6565066 -1.6565066  2.0811630 -1.6565066
row20 -1.71170533  1.37933712 -1.7117053 -1.7117053 -1.7117053  1.1786664
          col37      col38      col39      col40      col41      col42
row1  -1.634438  2.1942034  2.2775850  1.0046193  2.1032316 -1.6344380
row2   1.008521  0.4489052  1.4605061  1.2026770  2.0830357  1.0775139
row3  -1.190032  0.4194056 -1.1900323 -1.1900323 -1.1900323 -1.1900323
row4  -1.705668  2.1009948 -1.7056677 -1.7056677 -0.3193734 -1.7056677
row5  -1.608778  2.0801017  1.3869545  1.3869545 -0.5101655 -1.6087778
row6   1.723949 -1.7725587  1.1718803 -1.7725587 -1.7725587  2.0775889
row7  -1.303548 -1.3035482  2.4576519 -1.3035482 -0.2049359 -1.3035482
row8  -1.113573  2.2537232 -1.1135727  1.5254847 -1.1135727 -1.1135727
row9  -1.276225  2.5079643 -1.2762253 -1.2762253 -1.2762253 -1.2762253
row10  1.249961 -1.1479346  0.4615033 -1.1479346 -1.1479346 -1.1479346
row11 -1.268795 -1.2687951 -1.2687951  2.3421228 -1.2687951 -1.2687951
row12  2.377341 -1.4728068 -1.4728068 -1.4728068  2.2883933 -1.4728068
row13  2.410757 -1.4604440 -1.4604440  1.4299278 -1.4604440 -1.4604440
row14  2.377046 -1.3606232 -1.3606232 -1.3606232  1.2043261 -1.3606232
row15 -1.408391 -1.4083907  1.7696631  0.9895046  1.8104851  0.7888339
row16 -1.508277 -1.5082772 -1.5082772 -1.5082772  1.0566722  0.9766295
row17 -1.217327  0.5744328  2.5438735 -1.2173267  2.5668630 -1.2173267
row18  1.757218 -1.1331537  2.5804183 -1.1331537 -1.1331537  1.8112853
row19  1.051544  2.1936410  1.6015899  1.8400009 -1.6565066  2.1501559
row20  1.899213  2.0949572  2.1169361 -1.7117053 -0.1022674 -1.7117053
              col43      col44     col45      col46      col47      col48
row1   1.7667593807  2.2573823  2.103232 -1.6344380  1.7667594 -1.6344380
row2   1.8351995818  1.3139027  1.665301 -1.6305363  2.2612840 -0.9373891
row3  -1.1900323260 -1.1900323  1.449025 -1.1900323  2.7017880 -1.1900323
row4   0.3737738096 -1.7056677  1.695530 -1.7056677 -1.7056677 -1.7056677
row5   0.0006601595 -1.6087778  2.152422  0.4706638  0.9561716  1.6870591
row6  -1.7725586865  1.8109603 -1.772559  2.0341038  1.8383592 -1.7725587
row7  -1.3035482139 -1.3035482 -1.303548 -1.3035482 -1.3035482 -1.3035482
row8  -1.1135726669 -1.1135727 -1.113573 -1.1135727 -1.1135727  2.0219215
row9   2.1895105759 -1.2762253  2.250135  0.3332126 -1.2762253  0.6696848
row10 -1.1479346150 -1.1479346  2.317801 -1.1479346 -1.1479346 -1.1479346
row11 -0.1701828122  2.1969408 -1.268795 -1.2687951 -1.2687951 -1.2687951
row12  1.8230300907  2.1647794 -1.472807 -1.4728068  2.3558346 -1.4728068
row13 -1.4604439551 -1.4604440  1.178613  2.3681974  2.2531281 -1.4604440
row14 -1.3606232237  2.1358843 -1.360623  2.3770464  2.4460393  1.8582526
row15  1.4819810562 -1.4083907 -1.408391  1.8874462  1.9238138 -1.4083907
row16 -1.5082771842  1.3820946  2.229392  1.7875597 -1.5082772  1.0566722
row17  0.7285834857 -1.2173267 -1.217327  2.7144990 -1.2173267  1.3476227
row18  2.6510359152 -1.1331537 -1.133154  1.0640709 -1.1331537  2.3008335
row19 -1.6565066265  2.1276830  1.434536 -1.6565066 -1.6565066  1.1160821
row20  2.0949571614  0.3677362  1.284027 -1.7117053  1.6894921  1.2327337
           col49      col50
row1  -1.6344380 -1.6344380
row2   1.2026770 -1.6305363
row3  -1.1900323 -1.1900323
row4   1.7908398  1.6955296
row5  -1.6087778 -1.6087778
row6   1.9410134 -1.7725587
row7  -1.3035482  2.3853312
row8  -1.1135727 -1.1135727
row9   2.0910705 -1.2762253
row10 -1.1479346  2.5156270
row11 -1.2687951  1.9893014
row12 -1.4728068 -1.4728068
row13  1.0244627  2.0360636
row14  0.8366014  2.2502947
row15 -1.4083907 -1.4083907
row16 -1.5082772 -1.5082772
row17 -1.2173267  0.5744328
row18 -1.1331537 -1.1331537
row19  1.4345358 -1.6565066
row20 -1.7117053 -1.7117053
attr(,"parameters")
attr(,"parameters")$means
    row1     row2     row3     row4     row5     row6     row7     row8 
1.634438 1.630536 1.190032 1.705668 1.608778 1.772559 1.303548 1.113573 
    row9    row10    row11    row12    row13    row14    row15    row16 
1.276225 1.147935 1.268795 1.472807 1.460444 1.360623 1.408391 1.508277 
   row17    row18    row19    row20 
1.217327 1.133154 1.656507 1.711705 

attr(,"parameters")$pseudocount
[1] 1

attr(,"parameters")$margin
[1] 1

attr(,"decostand")
[1] "clr"
> # Expect error
> #class(try(decostand(testdata, method = "clr"))) == "try-error"
> #class(try(decostand(testdata, method = "clr", pseudocount = 0))) == "try-error"
> 
> # Tests that clr robust gives values that are approximately same if only 
> # one value per sample are changed to zero
> # Adds pseudocount
> test <- testdata + 1
> test2 <- test
> test2[,1] <- 0
> 
> # clr robust transformations
> test <- decostand(test, method = "rclr")
> test2 <- decostand(test2, method = "rclr")
> 
> # Removes first cols
> test <- test[, -1]
> test2 <- test2[, -1]
> 
> # Expect high correlation
> cor(unlist(test), unlist(test2)) > 0.99
       col2  col3  col4  col5  col6  col7  col8  col9 col10 col11 col12 col13
col2  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col3  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col4  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col5  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col6  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col7  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col8  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col9  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col10 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col11 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col12 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col13 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col14 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col15 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col16 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col17 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col18 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col19 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col20 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col21 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col22 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col23 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col24 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col25 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col26 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col27 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col28 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col29 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col30 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col31 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col32 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col33 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col34 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col35 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col36 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col37 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col38 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col39 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col40 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col41 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col42 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col43 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col44 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col45 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col46 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col47 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col48 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col49 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col50 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
      col14 col15 col16 col17 col18 col19 col20 col21 col22 col23 col24 col25
col2  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col3  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col4  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col5  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col6  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col7  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col8  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col9  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col10 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col11 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col12 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col13 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col14 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col15 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col16 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col17 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col18 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col19 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col20 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col21 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col22 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col23 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col24 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col25 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col26 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col27 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col28 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col29 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col30 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col31 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col32 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col33 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col34 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col35 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col36 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col37 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col38 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col39 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col40 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col41 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col42 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col43 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col44 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col45 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col46 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col47 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col48 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col49 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col50 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
      col26 col27 col28 col29 col30 col31 col32 col33 col34 col35 col36 col37
col2  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col3  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col4  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col5  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col6  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col7  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col8  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col9  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col10 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col11 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col12 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col13 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col14 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col15 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col16 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col17 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col18 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col19 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col20 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col21 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col22 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col23 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col24 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col25 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col26 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col27 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col28 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col29 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col30 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col31 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col32 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col33 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col34 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col35 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col36 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col37 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col38 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col39 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col40 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col41 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col42 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col43 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col44 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col45 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col46 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col47 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col48 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col49 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col50 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
      col38 col39 col40 col41 col42 col43 col44 col45 col46 col47 col48 col49
col2  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col3  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col4  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col5  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col6  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col7  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col8  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col9  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col10 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col11 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col12 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col13 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col14 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col15 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col16 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col17 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col18 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col19 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col20 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col21 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col22 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col23 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col24 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col25 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col26 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col27 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col28 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col29 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col30 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col31 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col32 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col33 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col34 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col35 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col36 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col37 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col38 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col39 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col40 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col41 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col42 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col43 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col44 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col45 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col46 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col47 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col48 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col49 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
col50 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
      col50
col2  FALSE
col3  FALSE
col4  FALSE
col5  FALSE
col6  FALSE
col7  FALSE
col8  FALSE
col9  FALSE
col10 FALSE
col11 FALSE
col12 FALSE
col13 FALSE
col14 FALSE
col15 FALSE
col16 FALSE
col17 FALSE
col18 FALSE
col19 FALSE
col20 FALSE
col21 FALSE
col22 FALSE
col23 FALSE
col24 FALSE
col25 FALSE
col26 FALSE
col27 FALSE
col28 FALSE
col29 FALSE
col30 FALSE
col31 FALSE
col32 FALSE
col33 FALSE
col34 FALSE
col35 FALSE
col36 FALSE
col37 FALSE
col38 FALSE
col39 FALSE
col40 FALSE
col41 FALSE
col42 FALSE
col43 FALSE
col44 FALSE
col45 FALSE
col46 FALSE
col47 FALSE
col48 FALSE
col49 FALSE
col50 FALSE
> 
> # Compare rclr with imputation to without imputation + matrix completion
> # rclr transformation with matrix completion for the 0/NA entries
> x1 <- decostand(varespec, method = "rclr", impute = TRUE)
> 
> # rclr transformation with no matrix completion for the 0/NA entries
> x2 <- decostand(varespec, method = "rclr", impute = FALSE)
> 
> # Matrix completion
> x2c <- optspace(x2, ropt = 3, niter = 5, tol = 1e-5, verbose = FALSE)$M
> all(as.matrix(x1) == as.matrix(x2c))
[1] TRUE
> 
> x2c <- optspace(x2, niter = 5, tol = 1e-5, verbose = FALSE)$M
> all(as.matrix(x1) == as.matrix(x2c))
[1] TRUE
> 
> ############################# NAMES ####################################
> 
> # Tests that dimensins have correct names
> all(rownames(decostand(testdata + 1, method = "clr")) == rownames(testdata))
[1] TRUE
> all(colnames(decostand(testdata, method = "clr", pseudocount = 1)) == colnames(testdata))
[1] TRUE
> all(rownames(decostand(testdata, method = "rclr")) == rownames(testdata))
[1] TRUE
> all(colnames(decostand(testdata, method = "rclr")) == colnames(testdata))
[1] TRUE
> 
> ########################################################################
> 
> # Count vs. Relative data
> 
> # CLR is identical with count and relative data
> a1 <- decostand(testdata.with.pseudo, method = "clr")
> a2 <- decostand(relative.with.pseudo, method = "clr")
> max(abs(a1 - a2)) < 1e-6 # Tolerance
[1] TRUE
> 
> # rCLR is identical with count and relative data
> a1 <- decostand(testdata.with.pseudo, method = "rclr")
> a2 <- decostand(relative.with.pseudo, method = "rclr")
> max(abs(a1 - a2)) < 1e-6 # Tolerance
[1] TRUE
> 
> # ALR is identical with count and relative data
> a1 <- decostand(testdata.with.pseudo, method = "alr")
> a2 <- decostand(relative.with.pseudo, method = "alr")
> max(abs(a1 - a2)) < 1e-6 # Tolerance
[1] TRUE
> 
> ####### # ALR transformation drops one feature ################
> ncol(decostand(testdata.with.pseudo, "alr")) == ncol(testdata.with.pseudo) - 1
[1] TRUE
> 
> proc.time()
   user  system elapsed 
  0.437   0.048   0.482 
