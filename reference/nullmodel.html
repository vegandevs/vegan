<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The nullmodel function creates an object,
which can serve as a basis for Null Model simulation
via the simulate method.
The update method updates the nullmodel
object without sampling (effective for sequential algorithms).
smbind binds together multiple simmat objects."><title>Null Model and Simulation — nullmodel • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Null Model and Simulation — nullmodel"><meta property="og:description" content="The nullmodel function creates an object,
which can serve as a basis for Null Model simulation
via the simulate method.
The update method updates the nullmodel
object without sampling (effective for sequential algorithms).
smbind binds together multiple simmat objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Null Model and Simulation</h1>
      
      <div class="d-none name"><code>nullmodel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>nullmodel</code> function creates an object,
which can serve as a basis for Null Model simulation
via the <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></code> method.
The <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></code> method updates the nullmodel
object without sampling (effective for sequential algorithms).
<code>smbind</code> binds together multiple <code>simmat</code> objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span>, <span class="va">method</span><span class="op">)</span></span>
<span><span class="co"># S3 method for nullmodel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for nullmodel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">object</span>, nsim <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    burnin <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for nullmodel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">object</span>, nsim <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for simmat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">smbind</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, <span class="va">MARGIN</span>, strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A community matrix.
For the <code>print</code> method, it is an object to be printed.</p></dd>

  <dt>method</dt>
<dd><p>Character, specifying one of the null model algorithms
listed on the help page of <code><a href="commsim.html">commsim</a></code>.
It can be a user supplied object of class <code>commsim</code>.</p></dd>

  <dt>object</dt>
<dd><p>An object of class <code>nullmodel</code> returned by
the function <code>nullmodel</code>.
In case of <code>smbind</code> it is a <code>simmat</code> object
as returned by the <code>update</code> or <code>simulate</code> methods.</p></dd>

  <dt>nsim</dt>
<dd><p>Positive integer, the number of simulated matrices to return.
For the <code>update</code> method, it is the number of
burnin steps made for sequential algorithms
to update the status of the input model <code>object</code>.</p></dd>

  <dt>seed</dt>
<dd><p>An object specifying if and how the random number
generator should be initialized ("seeded").
Either <code>NULL</code> or an integer that will be
used in a call to <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code> before
simulating the matrices.
If set, the value is saved as the
<code>"seed"</code> attribute of the returned value.
The default, <code>NULL</code> will not change the
random generator state, and return
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">.Random.seed</a></code> as the <code>"seed"</code>
 attribute, see Value.</p></dd>

  <dt>burnin</dt>
<dd><p>Nonnegative integer, specifying the number of steps
discarded before starting simulation.
Active only for sequential null model algorithms.
Ignored for non-sequential null model algorithms.</p></dd>

  <dt>thin</dt>
<dd><p>Positive integer, number of simulation steps
made between each returned matrix.
Active only for sequential null model algorithms.
Ignored for non-sequential null model algorithms.</p></dd>

  <dt>MARGIN</dt>
<dd><p>Integer, indicating the dimension over which multiple
<code>simmat</code> objects are to be bound together by <code>smbind</code>.
1: matrices are stacked (row bound), 2: matrices are column bound,
3: iterations are combined. Needs to be of length 1.
The other dimensions are expected to match across the objects.</p></dd>

  <dt>strict</dt>
<dd><p>Logical, if consistency of the time series attributes
(<code>"start"</code>, <code>"end"</code>, <code>"thin"</code>, and number of simulated matrices)
of <code>simmat</code> objects are strictly enforced when
binding multiple objects together using <code>smbind</code>.
Applies only to input objects based on sequential
null model algorithms.</p></dd>

  <dt>...</dt>
<dd><p>Additional arguments supplied to algorithms.
In case of <code>smbind</code> it can contain multiple <code>simmat</code> objects.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The purpose of the <code>nullmodel</code> function is to
create an object, where all necessary statistics of the
input matrix are calculated only once.
This information is reused, but not recalculated
in each step of the simulation process done by
the <code>simulate</code> method.</p>
<p>The <code>simulate</code> method carries out the simulation,
the simulated matrices are stored in an array.
For sequential algorithms, the method updates the state
of the input <code>nullmodel</code> object.
Therefore, it is possible to do diagnostic
tests on the returned <code>simmat</code> object,
and make further simulations, or use
increased thinning value if desired.</p>
<p>The <code>update</code> method makes burnin steps in case
of sequential algorithms to update the status of the
input model without any attempt to return matrices.
For non-sequential algorithms the method does nothing.</p>
<p><code>update</code> is the preferred way of making burnin iterations
without sampling. Alternatively, burnin can be done
via the <code>simulate</code> method. For convergence
diagnostics, it is recommended to use the
<code>simulate</code> method without burnin.
The input nullmodel object is updated, so further
samples can be simulated if desired without having
to start the process all over again. See Examples.</p>
<p>The <code>smbind</code> function can be used to combine multiple
<code>simmat</code> objects. This comes handy when null model
simulations are stratified by sites (<code>MARGIN = 1</code>)
or by species (<code>MARGIN = 2</code>), or in the case when
multiple objects are returned by identical/consistent settings
e.g. during parallel computations (<code>MARGIN = 3</code>).
Sanity checks are made to ensure that combining multiple
objects is sensible, but it is the user's responsibility
to check independence of the simulated matrices
and the null distribution has converged
in case of sequential null model algorithms.
The <code>strict = FALSE</code> setting can relax
checks regarding start, end, and thinning values
for sequential null models.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The function <code>nullmodel</code> returns an object of class <code>nullmodel</code>.
It is a set of objects sharing the same environment:</p>
<dl><dt><code>data</code>: </dt>
<dd><p>original matrix in integer mode.</p></dd>

  <dt><code>nrow</code>: </dt>
<dd><p>number of rows.</p></dd>

  <dt><code>ncol</code>: </dt>
<dd><p>number of columns.</p></dd>

  <dt><code>rowSums</code>: </dt>
<dd><p>row sums.</p></dd>

  <dt><code>colSums</code>: </dt>
<dd><p>column sums.</p></dd>

  <dt><code>rowFreq</code>: </dt>
<dd><p>row frequencies (number of nonzero cells).</p></dd>

  <dt><code>colFreq</code>: </dt>
<dd><p>column frequencies (number of nonzero cells).</p></dd>

  <dt><code>totalSum</code>: </dt>
<dd><p>total sum.</p></dd>

  <dt><code>fill</code>: </dt>
<dd><p>number of nonzero cells in the matrix.</p></dd>

  <dt><code>commsim</code>: </dt>
<dd><p>the <code>commsim</code> object as a result
    of the <code>method</code> argument.</p></dd>

  <dt><code>state</code>: </dt>
<dd><p>current state of the permutations,
    a matrix similar to the original.
    It is <code>NULL</code> for non-sequential algorithms.</p></dd>

  <dt><code>iter</code>: </dt>
<dd><p>current number of iterations
  for sequential algorithms.
    It is <code>NULL</code> for non-sequential algorithms.</p></dd>



</dl><p>The <code>simulate</code> method returns an object of class <code>simmat</code>.
It is an array of simulated matrices (third dimension
corresponding to <code>nsim</code> argument).</p>


<p>The <code>update</code> method returns the current state (last updated matrix)
invisibly, and update the input object for sequential algorithms.
For non sequential algorithms, it returns <code>NULL</code>.</p>


<p>The <code>smbind</code> function returns an object of class <code>simmat</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen and Peter Solymos</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="commsim.html">commsim</a></code>, <code><a href="commsim.html">make.commsim</a></code>,
<code><a href="permatfull.html">permatfull</a></code>, <code><a href="permatfull.html">permatswap</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Care must be taken when the input matrix only contains a single
row or column. Such input is invalid for swapping and hypergeometric
distribution (calling <code><a href="https://rdrr.io/r/stats/r2dtable.html" class="external-link">r2dtable</a></code>) based algorithms.
This also applies to cases when the input is stratified into subsets.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## non-sequential nullmodel</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span>, <span class="st">"r00"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “nullmodel” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘r00’ method (binary, non-sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘r00’ method (binary, non-sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sequential nullmodel</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span>, <span class="st">"swap"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “nullmodel” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">sm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 5, End = 50, Thin = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">sm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 55, End = 100, Thin = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sequential nullmodel with burnin and extra updating</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span>, <span class="st">"swap"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “nullmodel” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">sm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, burnin<span class="op">=</span><span class="fl">10</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 15, End = 60, Thin = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="op">(</span><span class="va">sm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 5, End = 50, Thin = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sequential nullmodel with separate initial burnin</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span>, <span class="st">"swap"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “nullmodel” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">sm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 15, End = 60, Thin = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## combining multiple simmat objects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## stratification</span></span></span>
<span class="r-in"><span><span class="va">nm1</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="op">]</span>, <span class="st">"r00"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm1</span>, nsim<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nm2</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">12</span>,<span class="op">]</span>, <span class="st">"r00"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm2</span>, nsim<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">smbind</span><span class="op">(</span><span class="va">sm1</span>, <span class="va">sm2</span>, MARGIN<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘r00’ method (binary, non-sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## binding subsequent samples from sequential algorithms</span></span></span>
<span class="r-in"><span><span class="co">## start, end, thin retained</span></span></span>
<span class="r-in"><span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span>, <span class="st">"swap"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">20</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">smbind</span><span class="op">(</span><span class="va">sm3</span>, <span class="va">sm2</span>, <span class="va">sm1</span>, MARGIN<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 15, End = 210, Thin = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 'replicate' based usage which is similar to the output</span></span></span>
<span class="r-in"><span><span class="co">## of 'parLapply' or 'mclapply' in the 'parallel' package</span></span></span>
<span class="r-in"><span><span class="co">## start, end, thin are set, also noting number of chains</span></span></span>
<span class="r-in"><span><span class="va">smfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">burnin</span>, <span class="va">nsim</span>, <span class="va">thin</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu">nullmodel</span><span class="op">(</span><span class="va">x</span>, <span class="st">"swap"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="va">burnin</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">nm</span>, nsim<span class="op">=</span><span class="va">nsim</span>, thin<span class="op">=</span><span class="va">thin</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">smlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu">smfun</span><span class="op">(</span><span class="va">x</span>, burnin<span class="op">=</span><span class="fl">50</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, simplify<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">smbind</span><span class="op">(</span><span class="va">smlist</span>, MARGIN<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co"># Number of permuted matrices = 30</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simmat” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘swap’ method (binary, sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 x 10 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start = 55, End = 100, Thin = 5 (3 chains)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## parallel null model calculations</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"unix"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## forking on Unix systems</span></span></span>
<span class="r-in"><span><span class="va">smlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">smfun</span><span class="op">(</span><span class="va">x</span>, burnin<span class="op">=</span><span class="fl">50</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">smbind</span><span class="op">(</span><span class="va">smlist</span>, MARGIN<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## socket type cluster, works on all platforms</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">cl</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vegandevs.github.io/vegan/">vegan</a></span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"smfun"</span>, <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">smlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parLapply</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">smfun</span><span class="op">(</span><span class="va">x</span>, burnin<span class="op">=</span><span class="fl">50</span>, nsim<span class="op">=</span><span class="fl">10</span>, thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">smbind</span><span class="op">(</span><span class="va">smlist</span>, MARGIN<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

