<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Canonical correlation analysis, following Brian McArdle's
unpublished graduate course notes, plus improvements to allow the
calculations in the case of very sparse and collinear matrices, and 
permutation test of Pillai's trace statistic."><title>Canonical Correlation Analysis — CCorA • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Canonical Correlation Analysis — CCorA"><meta property="og:description" content="Canonical correlation analysis, following Brian McArdle's
unpublished graduate course notes, plus improvements to allow the
calculations in the case of very sparse and collinear matrices, and 
permutation test of Pillai's trace statistic."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Canonical Correlation Analysis</h1>
      
      <div class="d-none name"><code>CCorA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Canonical correlation analysis, following Brian McArdle's
unpublished graduate course notes, plus improvements to allow the
calculations in the case of very sparse and collinear matrices, and 
permutation test of Pillai's trace statistic.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CCorA</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, stand.Y<span class="op">=</span><span class="cn">FALSE</span>, stand.X<span class="op">=</span><span class="cn">FALSE</span>, permutations <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for CCorA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">x</span>, plot.type<span class="op">=</span><span class="st">"ov"</span>, <span class="va">xlabs</span>, plot.axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, int<span class="op">=</span><span class="fl">0.5</span>, </span>
<span>   col.Y<span class="op">=</span><span class="st">"red"</span>, col.X<span class="op">=</span><span class="st">"blue"</span>, cex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.9</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>Y</dt>
<dd><p>Left matrix (object class: <code>matrix</code> or <code>data.frame</code>).</p></dd>

  <dt>X</dt>
<dd><p>Right matrix (object class: <code>matrix</code> or <code>data.frame</code>).</p></dd>

  <dt>stand.Y</dt>
<dd><p>Logical; should <code>Y</code> be standardized?</p></dd>

  <dt>stand.X</dt>
<dd><p>Logical; should <code>X</code> be standardized?</p></dd>

  
  <dt>permutations</dt>
<dd><p>a list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the
    number of permutations required, or a permutation matrix where each
    row gives the permuted indices.</p></dd>

  
  <dt>x</dt>
<dd><p><code>CCoaR</code> result object.</p></dd>

  <dt>plot.type</dt>
<dd><p>A character string indicating which of the following 
    plots should be produced: <code>"objects"</code>, <code>"variables"</code>, <code>"ov"</code> 
    (separate graphs for objects and variables), or <code>"biplots"</code>. Any 
    unambiguous subset containing the first letters of these names can be used 
    instead of the full names.</p></dd>

  <dt>xlabs</dt>
<dd><p>Row labels. The default is to use row names, <code>NULL</code>
    uses row numbers instead, and <code>NA</code> suppresses plotting row names
    completely.</p></dd>

  <dt>plot.axes</dt>
<dd><p>A vector with 2 values containing the order numbers of 
    the canonical axes to be plotted. Default: first two axes.</p></dd>

  <dt>int</dt>
<dd><p>Radius of the inner circles plotted as visual references in 
    the plots of the variables. Default: <code>int=0.5</code>. With <code>int=0</code>, 
    no inner circle is plotted.</p></dd>

  <dt>col.Y</dt>
<dd><p>Color used for objects and variables in the first data 
    table (Y) plots. In biplots, the objects are in black.</p></dd>

  <dt>col.X</dt>
<dd><p>Color used for objects and variables in the second data 
    table (X) plots.</p></dd>

  <dt>cex</dt>
<dd><p>A vector with 2 values containing the size reduction factors 
    for the object and variable names, respectively, in the plots. 
    Default values: <code>cex=c(0.7,0.9)</code>.</p></dd>

  <dt>...</dt>
<dd><p>Other arguments passed to these functions. The function 
    <code>biplot.CCorA</code> passes graphical arguments to <code><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></code> 
    and <code><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot.default</a></code>. <code>CCorA</code> currently ignores extra 
    arguments.</p></dd>
 
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Canonical correlation analysis (Hotelling 1936) seeks linear
  combinations of the variables of <code>Y</code> that are maximally
  correlated to linear combinations of the variables of <code>X</code>. The
  analysis estimates the relationships and displays them in graphs.
  Pillai's trace statistic is computed and tested parametrically (F-test);
  a permutation test is also available.</p>
<p>Algorithmic note -- 
  The blunt approach would be to read the two matrices, compute the
  covariance matrices, then the matrix
  <code>S12 %*% inv(S22) %*% t(S12) %*% inv(S11)</code>.
  Its trace is Pillai's trace statistic. 
  This approach may fail, however, when there is heavy multicollinearity
  in very sparse data matrices. The safe approach is to replace all data
  matrices by their PCA object scores.</p>
<p>The function can produce different types of plots depending on the option 
chosen: 
<code>"objects"</code> produces two plots of the objects, one in the space 
of Y, the second in the space of X; 
<code>"variables"</code> produces two plots of the variables, one of the variables 
of Y in the space of Y, the second of the variables of X in the space of X; 
<code>"ov"</code> produces four plots, two of the objects and two of the variables; 
<code>"biplots"</code> produces two biplots, one for the first matrix (Y) and 
one for second matrix (X) solutions. For biplots, the function passes all arguments 
to <code><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot.default</a></code>; consult its help page for configuring biplots.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Function <code>CCorA</code> returns a list containing the following elements:</p>
<dl><dt> Pillai </dt>
<dd><p>Pillai's trace statistic = sum of the canonical
    eigenvalues.</p></dd>
 
  <dt> Eigenvalues </dt>
<dd><p>Canonical eigenvalues. They are the squares of the
    canonical correlations.</p></dd>

  <dt> CanCorr </dt>
<dd><p>Canonical correlations.</p></dd>

  <dt> Mat.ranks </dt>
<dd><p>Ranks of matrices <code>Y</code> and <code>X</code>.</p></dd>

  <dt> RDA.Rsquares </dt>
<dd><p>Bimultivariate redundancy coefficients
    (R-squares) of RDAs of Y|X and X|Y.</p></dd>
 
  <dt> RDA.adj.Rsq </dt>
<dd><p><code>RDA.Rsquares</code> adjusted for <code>n</code> and the number 
    of explanatory variables.</p></dd>

  <dt> nperm </dt>
<dd><p>Number of permutations.</p></dd>

  <dt> p.Pillai </dt>
<dd><p>Parametric probability value associated with Pillai's trace.</p></dd>

  <dt> p.perm </dt>
<dd><p>Permutational probability associated with Pillai's trace.</p></dd>

  <dt> Cy </dt>
<dd><p>Object scores in Y biplot.</p></dd>

  <dt> Cx </dt>
<dd><p>Object scores in X biplot.</p></dd>

  <dt> corr.Y.Cy </dt>
<dd><p>Scores of Y variables in Y biplot, computed as cor(Y,Cy).</p></dd>

  <dt> corr.X.Cx </dt>
<dd><p>Scores of X variables in X biplot, computed as cor(X,Cx).</p></dd>

  <dt> corr.Y.Cx </dt>
<dd><p>cor(Y,Cy) available for plotting variables Y in space of X manually.</p></dd>

  <dt> corr.X.Cy </dt>
<dd><p>cor(X,Cx) available for plotting variables X in space of Y manually.</p></dd>

  <dt>control</dt>
<dd><p>A list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>.</p></dd>

  <dt> call </dt>
<dd><p>Call to the CCorA function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hotelling, H. 1936. Relations between two sets of
  variates. <em>Biometrika</em> <strong>28</strong>: 321-377.</p>  
<p>Legendre, P. 2005. Species associations: the Kendall coefficient of 
  concordance revisited. <em>Journal of Agricultural, Biological, and 
  Environmental Statistics</em> <strong>10</strong>: 226-245.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Legendre, Departement de Sciences Biologiques,
  Universite de Montreal. Implemented in <span class="pkg">vegan</span> with the help of
  Jari Oksanen.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example using two mite groups. The mite data are available in vegan</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Two mite species associations (Legendre 2005, Fig. 4)</span></span></span>
<span class="r-in"><span><span class="va">group.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">10</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">17</span>,<span class="fl">19</span><span class="op">:</span><span class="fl">22</span>,<span class="fl">24</span>,<span class="fl">26</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">16</span>,<span class="fl">18</span>,<span class="fl">23</span>,<span class="fl">25</span>,<span class="fl">31</span><span class="op">:</span><span class="fl">35</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Separate Hellinger transformations of the two groups of species </span></span></span>
<span class="r-in"><span><span class="va">mite.hel.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="decostand.html">decostand</a></span><span class="op">(</span><span class="va">mite</span><span class="op">[</span>,<span class="va">group.1</span><span class="op">]</span>, <span class="st">"hel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mite.hel.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="decostand.html">decostand</a></span><span class="op">(</span><span class="va">mite</span><span class="op">[</span>,<span class="va">group.2</span><span class="op">]</span>, <span class="st">"hel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mite.hel.1</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mite.hel.2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">CCorA</span><span class="op">(</span><span class="va">mite.hel.1</span>, <span class="va">mite.hel.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical Correlation Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CCorA(Y = mite.hel.1, X = mite.hel.2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Y  X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matrix Ranks 24 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pillai's trace:  4.573009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance of Pillai's trace:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> from F-distribution:   0.0032737 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        CanAxis1 CanAxis2 CanAxis3 CanAxis4 CanAxis5 CanAxis6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical Correlations  0.92810  0.82431  0.81209  0.74981  0.70795  0.65950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        CanAxis7 CanAxis8 CanAxis9 CanAxis10 CanAxis11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical Correlations  0.50189  0.48179  0.41089   0.37823      0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Y | X  X | Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RDA R squares      0.33224 0.5376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adj. RDA R squares 0.20560 0.2910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"ob"</span><span class="op">)</span>                 <span class="co"># Two plots of objects</span></span></span>
<span class="r-plt img"><img src="CCorA-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"v"</span>, cex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Two plots of variables</span></span></span>
<span class="r-plt img"><img src="CCorA-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"ov"</span>, cex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span> <span class="co"># Four plots (2 for objects, 2 for variables)</span></span></span>
<span class="r-plt img"><img src="CCorA-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"b"</span>, cex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Two biplots</span></span></span>
<span class="r-plt img"><img src="CCorA-4.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">out</span>, xlabs <span class="op">=</span> <span class="cn">NA</span>, plot.axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>    <span class="co"># Plot axes 3, 5. No object names</span></span></span>
<span class="r-plt img"><img src="CCorA-5.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">out</span>, plot.type<span class="op">=</span><span class="st">"biplots"</span>, xlabs <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># Replace object names by numbers</span></span></span>
<span class="r-plt img"><img src="CCorA-6.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example using random numbers. No significant relationship is expected</span></span></span>
<span class="r-in"><span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>,<span class="fl">20</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,<span class="fl">20</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out2</span> <span class="op">=</span> <span class="fu">CCorA</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">mat2</span>, permutations<span class="op">=</span><span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical Correlation Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CCorA(Y = mat1, X = mat2, permutations = 99) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Y X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matrix Ranks 3 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pillai's trace:  0.480458 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance of Pillai's trace:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> from F-distribution:   0.90606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> based on permutations: 0.94 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        CanAxis1 CanAxis2 CanAxis3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Canonical Correlations  0.64421  0.23458   0.1021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Y | X   X | Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RDA R squares       0.214302  0.0839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adj. RDA R squares -0.066305 -0.0879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">out2</span>, <span class="st">"b"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CCorA-7.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

