<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function computes coefficients of dispersal direction
between geographically connected areas, as defined by Legendre and
Legendre (1984), and also described in Legendre and Legendre (2012,
section 13.3.4)."><title>Coefficients of Biogeographical Dispersal Direction — bgdispersal • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Coefficients of Biogeographical Dispersal Direction — bgdispersal"><meta property="og:description" content="This function computes coefficients of dispersal direction
between geographically connected areas, as defined by Legendre and
Legendre (1984), and also described in Legendre and Legendre (2012,
section 13.3.4)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Coefficients of Biogeographical Dispersal Direction</h1>
      
      <div class="d-none name"><code>bgdispersal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes coefficients of dispersal direction
between geographically connected areas, as defined by Legendre and
Legendre (1984), and also described in Legendre and Legendre (2012,
section 13.3.4).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bgdispersal</span><span class="op">(</span><span class="va">mat</span>, PAonly <span class="op">=</span> <span class="cn">FALSE</span>, abc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mat</dt>
<dd><p>Data frame or matrix containing a community composition
    data table (species presence-absence or abundance data).</p></dd>

  <dt>PAonly</dt>
<dd><p><code>FALSE</code> if the four types of coefficients, DD1 to
    DD4, are requested; <code>TRUE</code> if <code>DD1</code> and <code>DD2</code> only are
    sought (see Details).</p></dd>

  <dt>abc</dt>
<dd><p>If <code>TRUE</code>, return tables <code>a</code>, <code>b</code> and <code>c</code>
    used in <code>DD1</code> and <code>DD2</code>.</p></dd>

  </dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The signs of the DD coefficients indicate the 
direction of dispersal, provided that the 
asymmetry is significant. A positive sign 
indicates dispersal from the first (row in DD 
tables) to the second region (column); a negative 
sign indicates the opposite. A McNemar test of 
asymmetry is computed from the presence-absence 
data to test the hypothesis of a significant 
asymmetry between the two areas under comparison.</p>
<p>In the input data table, the rows are sites or 
areas, the columns are taxa. Most often, the taxa 
are species, but the coefficients can be computed 
from genera or families as well. DD1 and DD2 only 
are computed for presence-absence data. The four 
types of coefficients are computed for 
quantitative data, which are converted to 
presence-absence for the computation of DD1 and 
DD2. <code>PAonly = FALSE</code> indicates that the four types 
of coefficients are requested. <code>PAonly = TRUE</code> if DD1 
and DD2 only are sought.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Function <code>bgdispersal</code> returns a list containing the following matrices:</p>
<dl><dt> DD1 </dt>
<dd><p>\(DD1_{j,k} = (a(b - c))/((a + b + c)^2)\)</p></dd>

<dt> DD2 </dt>
<dd><p>\(DD2_{j,k} = (2 a (b - c))/((2a + b + c)  (a + b +
    c))\)
  where \(a\), \(b\), and \(c\) have the 
same meaning as in the computation of binary 
similarity coefficients.</p></dd>

<dt> DD3 </dt>
<dd><p>\(DD3_{j,k} = {W(A-B) / (A+B-W)^2} \)</p></dd>

<dt> DD4 </dt>
<dd><p>\(DD4_{j,k} = 2W(A-B) / ((A+B)(A+B-W))\)
where <code>W = sum(pmin(vector1, vector2))</code>, <code>A = sum(vector1)</code>,
<code>B = sum(vector2)</code></p></dd>


<dt> McNemar </dt>
<dd><p>McNemar chi-square statistic of asymmetry (Sokal and
  Rohlf 1995):
  \(2(b \log(b) + c \log(c) - (b+c) \log((b+c)/2)) / q\),
  where \(q = 1 + 1/(2(b+c))\)
  (Williams correction for continuity)</p></dd>

<dt> prob.McNemar </dt>
<dd><p>probabilities associated 
with McNemar statistics, chi-square test. H0: no 
asymmetry in \((b-c)\).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Legendre, P. and V. Legendre. 1984. Postglacial dispersal of
  freshwater fishes in the Québec
  peninsula. <em>Can. J. Fish. Aquat. Sci.</em> <strong>41</strong>: 1781-1802.</p>  
<p>Legendre, P. and L. Legendre. 2012. <em>Numerical ecology</em>, 3rd
  English edition. Elsevier Science BV, Amsterdam.</p>  
<p>Sokal, R. R. and F. J. Rohlf. 1995. <em>Biometry. The principles and
  practice of statistics in biological research.</em> 3rd
  edn. W. H. Freeman, New York.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Legendre, Departement de Sciences Biologiques,
  Universite de Montreal</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The function uses a more powerful alternative for the McNemar test
  than the classical formula. The classical formula was constructed in
  the spirit of Pearson's Chi-square, but the formula in this function
  was constructed in the spirit of Wilks Chi-square or the \(G\)
  statistic. Function <code><a href="https://rdrr.io/r/stats/mcnemar.test.html" class="external-link">mcnemar.test</a></code> uses the classical
  formula. The new formula was introduced in <span class="pkg">vegan</span> version
  1.10-11, and the older implementations of <code>bgdispersal</code> used the
  classical formula.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32</span>,<span class="fl">15</span>,<span class="fl">14</span>,<span class="fl">10</span>,<span class="fl">70</span>,<span class="fl">30</span>,<span class="fl">100</span>,<span class="fl">4</span>,<span class="fl">10</span>,<span class="fl">30</span>,<span class="fl">25</span>,<span class="fl">0</span>,<span class="fl">18</span>,<span class="fl">0</span>,<span class="fl">40</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">20</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">20</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="fl">74</span>,<span class="fl">42</span>,<span class="fl">1</span>,<span class="fl">45</span>,<span class="fl">89</span>,<span class="fl">5</span>,<span class="fl">16</span>,<span class="fl">16</span>,<span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fl">4</span>, <span class="fl">10</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bgdispersal</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DD1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2] [,3]  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.00  0.24 0.21  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.24  0.00 0.08 -0.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.21 -0.08 0.00 -0.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.00  0.24 0.21  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DD2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]      [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.0000000  0.3428571 0.3230769  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.3428571  0.0000000 0.1142857 -0.3428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.3230769 -0.1142857 0.0000000 -0.3230769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0000000  0.3428571 0.3230769  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DD3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]       [,2]      [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.00000000  0.1567922 0.1420408 -0.01325831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.15679216  0.0000000 0.1101196 -0.20049485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.14204082 -0.1101196 0.0000000 -0.13586560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.01325831  0.2004949 0.1358656  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $DD4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]       [,2]      [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.00000000  0.2513176 0.2425087 -0.01960102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.25131757  0.0000000 0.1725441 -0.30993929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.24250871 -0.1725441 0.0000000 -0.23381521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.01960102  0.3099393 0.2338152  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $McNemar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]     [,2]      [,3]     [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   NA 7.677938 9.0571232 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   NA       NA 0.2912555 7.677938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   NA       NA        NA 9.057123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   NA       NA        NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $prob.McNemar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]        [,2]        [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   NA 0.005590001 0.002616734 1.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   NA          NA 0.589417103 0.005590001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   NA          NA          NA 0.002616734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

