<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reorder a Hierarchical Clustering Tree — reorder.hclust • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reorder a Hierarchical Clustering Tree — reorder.hclust"><meta name="description" content='

Function takes a hierarchical clustering tree from
  hclust and a vector of values and reorders the
  clustering tree in the order of the supplied vector, maintaining the
  constraints on the tree. This is a method of generic function
  reorder and an alternative to reordering a
  "dendrogram" object with reorder.dendrogram'><meta property="og:description" content='

Function takes a hierarchical clustering tree from
  hclust and a vector of values and reorders the
  clustering tree in the order of the supplied vector, maintaining the
  constraints on the tree. This is a method of generic function
  reorder and an alternative to reordering a
  "dendrogram" object with reorder.dendrogram'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reorder a Hierarchical Clustering Tree</h1>

      <div class="d-none name"><code>reorder.hclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Function takes a hierarchical clustering tree from
  <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> and a vector of values and reorders the
  clustering tree in the order of the supplied vector, maintaining the
  constraints on the tree. This is a method of generic function
  <code><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></code> and an alternative to reordering a
  <code>"dendrogram"</code> object with <code><a href="https://rdrr.io/r/stats/reorder.dendrogram.html" class="external-link">reorder.dendrogram</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'hclust'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">wts</span>, </span>
<span>   agglo.FUN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"sum"</span>, <span class="st">"uwmean"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'hclust'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'hclust'</span></span>
<span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">x</span>, display <span class="op">=</span> <span class="st">"internal"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">cutreeord</span><span class="op">(</span><span class="va">tree</span>, k <span class="op">=</span> <span class="cn">NULL</span>, h <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x-tree">x, tree<a class="anchor" aria-label="anchor" href="#arg-x-tree"></a></dt>
<dd><p>hierarchical clustering from <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code>.</p></dd>

  <dt id="arg-wts">wts<a class="anchor" aria-label="anchor" href="#arg-wts"></a></dt>
<dd><p>numeric vector for reordering.</p></dd>

  <dt id="arg-agglo-fun">agglo.FUN<a class="anchor" aria-label="anchor" href="#arg-agglo-fun"></a></dt>
<dd><p>a function for weights agglomeration, see below.</p></dd>

  <dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>return <code>"internal"</code> nodes or <code>"terminal"</code> nodes (also
  called <code>"leaves"</code>).</p></dd>

<dt id="arg-k-h">k, h<a class="anchor" aria-label="anchor" href="#arg-k-h"></a></dt>
<dd><p>scalars or vectors giving the numbers of desired groups or the heights
  where the tree should be cut (passed to function
  <code><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></code>).</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments (ignored).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Dendrograms can be ordered in many ways. The <code>reorder</code> function
  reorders an <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> tree and provides an alternative to
  <code><a href="https://rdrr.io/r/stats/reorder.dendrogram.html" class="external-link">reorder.dendrogram</a></code> which can reorder a
  <code><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">dendrogram</a></code>. The current function will also work
  differently when the <code>agglo.FUN</code> is <code>"mean"</code>: the
  <code><a href="https://rdrr.io/r/stats/reorder.dendrogram.html" class="external-link">reorder.dendrogram</a></code> will always take the direct mean of
  member groups ignoring their sizes, but this function will used
  <code><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></code> weighted by group sizes, so that the
  group mean is always the mean of member leaves (terminal nodes). If
  you want to ignore group sizes, you can use unweighted mean with
  <code>"uwmean"</code>.</p>
<p>The function accepts only a limited list of <code>agglo.FUN</code>
  functions for assessing the value of <code>wts</code> for groups. The
  ordering is always ascending, but the order of leaves can be
  reversed with <code>rev</code>.</p>
<p>Function <code>scores</code> finds the coordinates of nodes as a two-column
  matrix. For terminal nodes (leaves) this the value at which the item
  is merged to the tree, and the labels can still <code>hang</code> below this
  level (see <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">plot.hclust</a></code>).</p>
<p>Function <code>cutreeord</code> cuts a tree to groups numbered from left to
  right in the tree. It is based on the standard function
  <code><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></code> which numbers the groups in the order they appear
  in the input data instead of the order in the tree.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Reordered <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> result object with added item
  <code>value</code> that gives the value of the statistic at each merge
  level.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>These functions should really be in base <span style="R">R</span>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> for getting clustering trees,
  <code><a href="spantree.html">as.hclust.spantree</a></code> to change a <span class="pkg">vegan</span> minimum
  spanning tree to an <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> object, and
  <code><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">dendrogram</a></code> and <code><a href="https://rdrr.io/r/stats/reorder.dendrogram.html" class="external-link">reorder.dendrogram</a></code> for an
  alternative implementation.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## reorder by water content of soil</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span>, <span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="fu"><a href="decostand.html">wisconsin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ohc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mite.env</span>, <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">hc</span>, <span class="va">WatrCont</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="reorder.hclust-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ohc</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="reorder.hclust-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## label leaves by the observed value, and each branching point</span></span></span>
<span class="r-in"><span><span class="co">## (internal node) by the cluster mean</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mite.env</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ohc</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">WatrCont</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ordilabel.html">ordilabel</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">ohc</span><span class="op">)</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ohc</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="reorder.hclust-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Slightly different from reordered 'dendrogram' which ignores group</span></span></span>
<span class="r-in"><span><span class="co">## sizes in assessing means.</span></span></span>
<span class="r-in"><span><span class="va">den</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">den</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mite.env</span>, <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">den</span>, <span class="va">WatrCont</span>, agglo.FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">den</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="reorder.hclust-4.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

