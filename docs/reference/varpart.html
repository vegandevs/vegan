<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content=" 

The function partitions the variation in community data or community
  dissimilarities with respect to two, three, or four explanatory
  tables, using adjusted \(R^2\) in redundancy analysis
  ordination (RDA) or distance-based redundancy analysis. If response
  is a single vector, partitioning is by partial regression. Collinear
  variables in the explanatory tables do NOT have to be removed prior
  to partitioning."><title>Partition the Variation of Community Matrix by 2, 3, or 4 Explanatory Matrices — varpart • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Partition the Variation of Community Matrix by 2, 3, or 4 Explanatory Matrices — varpart"><meta property="og:description" content=" 

The function partitions the variation in community data or community
  dissimilarities with respect to two, three, or four explanatory
  tables, using adjusted \(R^2\) in redundancy analysis
  ordination (RDA) or distance-based redundancy analysis. If response
  is a single vector, partitioning is by partial regression. Collinear
  variables in the explanatory tables do NOT have to be removed prior
  to partitioning."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Partition the Variation of Community Matrix by 2, 3, or 4 Explanatory Matrices</h1>
      
      <div class="d-none name"><code>varpart.Rd</code></div>
    </div>

    <div class="ref-description section level2">
     

<p>The function partitions the variation in community data or community
  dissimilarities with respect to two, three, or four explanatory
  tables, using adjusted \(R^2\) in redundancy analysis
  ordination (RDA) or distance-based redundancy analysis. If response
  is a single vector, partitioning is by partial regression. Collinear
  variables in the explanatory tables do NOT have to be removed prior
  to partitioning.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">varpart</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">...</span>, <span class="va">data</span>, chisquare <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">transfo</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    add <span class="op">=</span> <span class="cn">FALSE</span>, sqrt.dist <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">permutations</span><span class="op">)</span></span>
<span><span class="co"># S3 method for varpart</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">showvarparts</span><span class="op">(</span><span class="va">parts</span>, <span class="va">labels</span>, bg <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="fl">63</span>, <span class="va">Xnames</span>,</span>
<span>    id.size <span class="op">=</span> <span class="fl">1.2</span>,  <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for varpart234</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, cutoff <span class="op">=</span> <span class="fl">0</span>, digits <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>Y</dt>
<dd><p>Data frame or matrix containing the response data table or
  dissimilarity structure inheriting from <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>. In
  community ecology, that table is often a site-by-species table or a
  dissimilarity object.</p></dd>


<dt>X</dt>
<dd><p>Two to four explanatory models, variables or tables.  These can
  be defined in three alternative ways: (1) one-sided model formulae
  beginning with <code>~</code> and then defining the model, (2) name of a
  single numeric or factor variable, or (3) name of matrix with numeric
  or data frame with numeric and factor variables.  The model formulae
  can have factors, interaction terms and transformations of
  variables. The names of the variables in the model formula are found
  in data frame given in <code>data</code> argument, and if not found there,
  in the user environment.  Single variables, data frames or matrices
  are found in the user environment.  All entries till the next argument
  (<code>data</code> or <code>transfo</code>) are interpreted as explanatory models,
  and the names of these extra arguments cannot be abbreviated nor
  omitted.</p></dd>


<dt>...</dt>
<dd><p>Other parameters passed to functions. NB, arguments after
  dots cannot be abbreviated but they must be spelt out completely.</p></dd>


<dt>data</dt>
<dd><p>The data frame with the variables used in the formulae in
  <code>X</code>.</p></dd>


<dt>chisquare</dt>
<dd><p>Partition Chi-square or the inertia of Correspondence
  Analysis (<code><a href="cca.html">cca</a></code>).</p></dd>


<dt>transfo</dt>
<dd><p>Transformation for <code>Y</code> (community data) using
  <code><a href="decostand.html">decostand</a></code>.  All alternatives in <code>decostand</code> can
  be used, and those preserving Euclidean metric include
  <code>"hellinger"</code>, <code>"chi.square"</code>, <code>"total"</code>,
  <code>"norm"</code>. Ignored if <code>Y</code> are dissimilarities.</p></dd>


<dt>scale</dt>
<dd><p>Should the columns of <code>Y</code> be standardized to unit
  variance. Ignored if <code>Y</code> are dissimilarities.</p></dd>


<dt>add</dt>
<dd><p>Add a constant to the non-diagonal values to euclidify
  dissimilarities (see <code><a href="wcmdscale.html">wcmdscale</a></code> for details). Choice
  <code>"lingoes"</code> (or <code>TRUE</code>) use the recommended method of
  Legendre &amp; Anderson (1999: “method 1”) and <code>"cailliez"</code>
  uses their “method 2”. The argument has an effect only when
  <code>Y</code> are dissimilarities.</p></dd>


<dt>sqrt.dist</dt>
<dd><p>Take square root of dissimilarities. This often
  euclidifies dissimilarities. NB., the argument name cannot be
  abbreviated. The argument has an effect only when <code>Y</code> are
  dissimilarities.</p></dd>


<dt>permutations</dt>
<dd><p>If <code>chisquare = TRUE</code>, the adjusted
    \(R^2\) is estimated by permutations, and this
    paramater can be a list of control values for the permutations as
    returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the number
    of permutations required, or a permutation matrix where each row
    gives the permuted indices.</p></dd>


<dt>parts</dt>
<dd><p>Number of explanatory tables (circles) displayed.</p></dd>

<dt>labels</dt>
<dd><p>Labels used for displayed fractions. Default is to use
  the same letters as in the printed output.</p></dd>

<dt>bg</dt>
<dd><p>Fill colours of circles or ellipses.</p></dd>

<dt>alpha</dt>
<dd><p>Transparency of the fill colour.  The argument takes
    precedence over possible transparency definitions of the
    colour. The value must be in range \(0...255\), and low values
    are more transparent.  Transparency is not available in all
    graphics devices or file formats.</p></dd>

  
<dt>Xnames</dt>
<dd><p>Names for sources of variation. Default names are <code>X1</code>,
  <code>X2</code>, <code>X3</code> and <code>X4</code>. <code>Xnames=NA</code>,
  <code>Xnames=NULL</code> and <code>Xnames=""</code> produce no names. The names
  can be changed to other names. It is often best to use short names.</p></dd>


<dt>id.size</dt>
<dd><p>A numerical value giving the character expansion factor
  for the names of circles or ellipses.</p></dd>


<dt>x, object</dt>
<dd><p>The <code>varpart</code> result.</p></dd>

<dt>cutoff</dt>
<dd><p>The values below <code>cutoff</code> will not be displayed.</p></dd>

<dt>digits</dt>
<dd><p>The number of significant digits; the number of decimal
  places is at least one higher.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>The functions partition the variation in <code>Y</code> into components
  accounted for by two to four explanatory tables and their combined
  effects. If <code>Y</code> is a multicolumn data frame or matrix, the
  partitioning is based on redundancy analysis (RDA, see
  <code><a href="cca.html">rda</a></code>) or on constrained correspondence analysis if
  <code>chisquare = TRUE</code> (CCA, see <code><a href="cca.html">cca</a></code>).  If <code>Y</code>
  is a single variable, the partitioning is based on linear
  regression.  If <code>Y</code> are dissimilarities, the decomposition is
  based on distance-based redundancy analysis (db-RDA, see
  <code><a href="dbrda.html">dbrda</a></code>) following McArdle &amp; Anderson (2001). The
  input dissimilarities must be compatible to the results of
  <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>. <span class="pkg">Vegan</span> functions <code><a href="vegdist.html">vegdist</a></code>,
  <code><a href="designdist.html">designdist</a></code>, <code><a href="raupcrick.html">raupcrick</a></code> and
  <code><a href="betadiver.html">betadiver</a></code> produce such objects, as do many other
  dissimilarity functions in <span style="R">R</span> packages. Partitioning will be made
  to squared dissimilarities analogously to using variance with
  rectangular data -- unless <code>sqrt.dist = TRUE</code> was specified.</p>
<p>The function primarily uses adjusted \(R^2\) to assess
  the partitions explained by the explanatory tables and their
  combinations (see <code><a href="RsquareAdj.html">RsquareAdj</a></code>), because this is the
  only unbiased method (Peres-Neto et al., 2006). The raw
  \(R^2\) for basic fractions are also displayed, but
  these are biased estimates of variation explained by the explanatory
  table. In correspondence analysis (<code>chisquare = TRUE</code>), the
  adjusted \(R^2\) are found by permutation and they vary
  in repeated analyses.</p>
<p>The identifiable fractions are designated by lower case alphabets. The
  meaning of the symbols can be found in the separate document (use
  <code>browseVignettes("vegan")</code>), or can be displayed graphically
  using function <code>showvarparts</code>.</p>
<p>A fraction is testable if it can be directly expressed as an RDA or
  db-RDA model.  In these cases the printed output also displays the
  corresponding RDA model using notation where explanatory tables
  after <code>|</code> are conditions (partialled out; see <code><a href="cca.html">rda</a></code>
  for details). Although single fractions can be testable, this does
  not mean that all fractions simultaneously can be tested, since the
  number of testable fractions is higher than the number of estimated
  models. The non-testable components are found as differences of
  testable components. The testable components have permutation
  variance in correspondence analysis (<code>chisquare = TRUE</code>), and
  the non-testable components have even higher variance.</p>
<p>An abridged explanation of the alphabetic symbols for the individual
  fractions follows, but computational details should be checked in the
  vignette (readable with <code>browseVignettes("vegan")</code>) or in the
  source code.</p>
<p>With two explanatory tables, the fractions explained 
  uniquely by each of the two tables are <code>[a]</code> and
  <code>[b]</code>, and their joint effect
  is  <code>[c]</code>.</p>
<p>With three explanatory tables, the fractions explained uniquely
  by each of the three tables are  
  <code>[a]</code> to <code>[c]</code>, joint fractions between two tables are
  <code>[d]</code> to <code>[f]</code>, and the joint fraction between all three
  tables is <code>[g]</code>.</p>
<p>With four explanatory tables, the fractions explained uniquely by each
  of the four tables are <code>[a]</code>
  to <code>[d]</code>, joint fractions between two tables are <code>[e]</code> to
  <code>[j]</code>, joint fractions between three variables are <code>[k]</code> to
  <code>[n]</code>, and the joint fraction between all four tables is
  <code>[o]</code>.</p>
<p><code>summary</code> will give an overview of unique and and overall
  contribution of each group of variables. The overall contribution
  (labelled as “Contributed”) consists of the unique contribution
  of the variable and equal shares of each fraction where the variable
  contributes. The summary tabulates how each fraction is divided
  between the variables, and the contributed component is the sum of all
  these divided fractions. The summary is based on the idea of Lai et
  al. (2022), and is similar to the output of their <a href="https://CRAN.R-project.org/package=rdacca.hp" class="external-link"><span class="pkg">rdacca.hp</span></a>
  package.</p>
<p>There is a <code>plot</code> function that displays the Venn diagram and
  labels each intersection (individual fraction) with the adjusted R
  squared if this is higher than <code>cutoff</code>.  A helper function
  <code>showvarpart</code> displays the fraction labels. The circles and
  ellipses are labelled by short default names or by names defined by
  the user in argument <code>Xnames</code>. Longer explanatory file names can
  be written on the varpart output plot as follows: use option
  <code>Xnames=NA</code>, then add new names using the <code>text</code> function. A
  bit of fiddling with coordinates (see <code><a href="https://rdrr.io/r/graphics/locator.html" class="external-link">locator</a></code>) and
  character size should allow users to place names of reasonably short
  lengths on the <code>varpart</code> plot.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Function <code>varpart</code> returns an
  object of class <code>"varpart"</code> with items <code>scale</code> and</p>
<p></p>
<p><code>transfo</code> (can be missing) which hold information on
  standardizations, <code>tables</code> which contains names of explanatory
  tables, and <code>call</code> with the function <code><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></code>. The
  function <code>varpart</code> calls function <code>varpart2</code>,</p>
<p></p>
<p><code>varpart3</code> or <code>varpart4</code> which return an object of class</p>
<p></p>
<p><code>"varpart234"</code> and saves its result in the item <code>part</code>.
  The items in this object are:</p>
<dl><dt>SS.Y</dt>
<dd><p>Sum of squares of matrix <code>Y</code>.</p></dd>

  <dt>n</dt>
<dd><p>Number of observations (rows).</p></dd>

  <dt>nsets</dt>
<dd><p>Number of explanatory tables</p></dd>

  <dt>bigwarning</dt>
<dd><p>Warnings on collinearity.</p></dd>

  <dt>fract</dt>
<dd><p>Basic fractions from all estimated constrained models.</p></dd>

  <dt>indfract</dt>
<dd><p>Individual fractions or all possible subsections in
    the Venn diagram (see <code>showvarparts</code>).</p></dd>

  <dt>contr1</dt>
<dd><p>Fractions that can be found after conditioning on single
    explanatory table in models with three or four explanatory tables.</p></dd>

  <dt>contr2</dt>
<dd><p>Fractions that can be found after conditioning on two
    explanatory tables in models with four explanatory tables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="fraction-data-frames">Fraction Data Frames<a class="anchor" aria-label="anchor" href="#fraction-data-frames"></a></h2>
    <p>Items <code>fract</code>,
  <code>indfract</code>, <code>contr1</code> and <code>contr2</code> are all data frames with
  items:</p><dl><dt><code>Df</code>: </dt>
<dd><p>Degrees of freedom of numerator of the \(F\)-statistic
    for the fraction.</p></dd>

  <dt><code>R.square</code>: </dt>
<dd><p>Raw \(R^2\). This is calculated only for
    <code>fract</code> and this is <code>NA</code> in other items.</p></dd>

  <dt><code>Adj.R.square</code>: </dt>
<dd><p>Adjusted \(R^2\).</p></dd>

  <dt><code>Testable</code>: </dt>
<dd><p>If the fraction can be expressed as a (partial) RDA
    model, it is directly <code>Testable</code>, and this field is
    <code>TRUE</code>.  In that case the fraction label also gives the
    specification of the testable RDA model.</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
     

<p>(a) References on variation partitioning</p>
<p>Borcard, D., P. Legendre &amp; P. Drapeau. 1992. Partialling out the spatial
component of ecological variation. Ecology 73: 1045--1055.</p>
<p>Lai J., Y. Zou, J. Zhang &amp; P. Peres-Neto. 2022. Generalizing
hierarchical and variation partitioning in multiple regression and
canonical analysis using the rdacca.hp R package. Methods in Ecology and
Evolution, 13: 782--788.</p>
<p>Legendre, P. &amp; L. Legendre. 2012. Numerical ecology, 3rd English edition.
Elsevier Science BV, Amsterdam.</p>
<p>(b) Reference on transformations for species data</p>
<p>Legendre, P. and E. D. Gallagher. 2001. Ecologically meaningful
transformations for ordination of species data. Oecologia 129: 271--280.</p>
<p>(c) Reference on adjustment of the bimultivariate redundancy statistic</p>
<p>Peres-Neto, P., P. Legendre, S. Dray and D. Borcard. 2006. Variation partitioning
of species data matrices: estimation and comparison of fractions.
Ecology 87: 2614--2625.</p>
<p>(d) References on partitioning of dissimilarities</p>
<p>Legendre, P. &amp; Anderson, M. J. (1999). Distance-based redundancy
analysis: testing multispecies responses in multifactorial ecological
experiments. <em>Ecological Monographs</em> 69, 1--24.</p>
<p>McArdle, B.H. &amp; Anderson, M.J. (2001). Fitting multivariate models
to community data: a comment on distance-based redundancy
analysis. Ecology 82, 290-297.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Legendre, Departement de Sciences Biologiques, Universite de
Montreal, Canada.  Further developed by Jari Oksanen.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    

<p>You can use command <code>browseVignettes("vegan")</code> to display
  document which presents Venn diagrams showing the fraction names in
  partitioning the variation of Y with respect to 2, 3, and 4 tables of
  explanatory variables, as well as the equations used in variation
  partitioning.</p>
<p>The functions frequently give negative estimates of variation.
  Adjusted \(R^2\) can be negative for any fraction;
  unadjusted \(R^2\) of testable fractions of variances
  will be non-negative.  Non-testable fractions cannot be found
  directly, but by subtracting different models, and these subtraction
  results can be negative.  The fractions are orthogonal, or linearly
  independent, but more complicated or nonlinear dependencies can
  cause negative non-testable fractions. Any fraction can be negative
  for non-Euclidean dissimilarities because the underlying db-RDA
  model can yield negative eigenvalues (see
  <code><a href="dbrda.html">dbrda</a></code>). These negative eigenvalues in the underlying
  analysis can be avoided with arguments <code>sqrt.dist</code> and
  <code>add</code> which have a similar effect as in <code><a href="dbrda.html">dbrda</a></code>:
  the square roots of several dissimilarities do not have negative
  eigenvalues, and no negative eigenvalues are produced after Lingoes
  or Cailliez adjustment, which in effect add random variation to the
  dissimilarities.</p>
<p>A simplified, fast version of RDA, CCA adn dbRDA are used (functions
  <code>simpleRDA2</code>, <code>simpleCCA</code> and <code>simpleDBRDA</code>).  The
  actual calculations are done in functions <code>varpart2</code> to
  <code>varpart4</code>, but these are not intended to be called directly by
  the user.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For analysing testable fractions, see <code><a href="cca.html">rda</a></code> and
  <code><a href="anova.cca.html">anova.cca</a></code>. For data transformation, see
  <code><a href="decostand.html">decostand</a></code>. Function <code><a href="goodness.cca.html">inertcomp</a></code> gives
  (unadjusted) components of variation for each species or site
  separately.  Function <code><a href="cca.html">rda</a></code> displays unadjusted
  components in its output, but <code><a href="RsquareAdj.html">RsquareAdj</a></code> will give
  adjusted \(R^2\) that are similar to the current
  function also for partial models.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.pcnm</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Two explanatory data frames -- Hellinger-transform Y</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">varpart</span><span class="op">(</span><span class="va">mite</span>, <span class="va">mite.env</span>, <span class="va">mite.pcnm</span>, transfo<span class="op">=</span><span class="st">"hel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition of variance in RDA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: varpart(Y = mite, X = mite.env, mite.pcnm, transfo = "hel")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species transformation:  hellinger</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Explanatory tables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1:  mite.env</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2:  mite.pcnm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of explanatory tables: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total variation (SS): 27.205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Variance: 0.39428 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of observations: 70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Df R.squared Adj.R.squared Testable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+c] = X1           11   0.52650       0.43670     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b+c] = X2           22   0.62300       0.44653     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+b+c] = X1+X2      33   0.75893       0.53794     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual fractions                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a] = X1|X2          11                 0.09141     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b] = X2|X1          22                 0.10124     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c]                   0                 0.34530    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [d] = Residuals                         0.46206    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use function ‘rda’ to test significance of fractions of interest</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unique fractions and total with shared fractions equally allocated:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unique Contributed Component</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1 0.0914       0.264  mite.env</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2 0.1012       0.274 mite.pcnm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contributions of fractions to sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         X1     X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a] 0.0914       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b]        0.1012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c] 0.1726 0.1726</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use fill colours</span></span></span>
<span class="r-in"><span><span class="fu">showvarparts</span><span class="op">(</span><span class="fl">2</span>, bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hotpink"</span>,<span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varpart-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hotpink"</span>,<span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varpart-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Test fraction [a] using partial RDA, '~ .' in formula tells to use</span></span></span>
<span class="r-in"><span><span class="co">## all variables of data mite.env.</span></span></span>
<span class="r-in"><span><span class="va">aFrac</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="fu"><a href="decostand.html">decostand</a></span><span class="op">(</span><span class="va">mite</span>, <span class="st">"hel"</span><span class="op">)</span>, <span class="va">mite.env</span>, <span class="va">mite.pcnm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">aFrac</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for rda under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: rda(X = decostand(mite, "hel"), Y = mite.env, Z = mite.pcnm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df Variance      F Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model    11 0.053592 1.8453  0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 36 0.095050                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## RsquareAdj gives the same result as component [a] of varpart</span></span></span>
<span class="r-in"><span><span class="fu"><a href="RsquareAdj.html">RsquareAdj</a></span><span class="op">(</span><span class="va">aFrac</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r.squared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1359251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $adj.r.squared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09140797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Partition Bray-Curtis dissimilarities</span></span></span>
<span class="r-in"><span><span class="fu">varpart</span><span class="op">(</span><span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>, <span class="va">mite.env</span>, <span class="va">mite.pcnm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition of squared Bray distance in dbRDA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: varpart(Y = vegdist(mite), X = mite.env, mite.pcnm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Explanatory tables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1:  mite.env</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2:  mite.pcnm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of explanatory tables: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total variation (SS): 14.696 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of observations: 70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Df R.squared Adj.R.squared Testable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+c] = X1           11   0.50512       0.41127     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b+c] = X2           22   0.60144       0.41489     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+b+c] = X1+X2      33   0.74631       0.51375     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual fractions                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a] = X1|X2          11                 0.09887     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b] = X2|X1          22                 0.10249     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c]                   0                 0.31240    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [d] = Residuals                         0.48625    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use function ‘dbrda’ to test significance of fractions of interest</span>
<span class="r-in"><span><span class="co">## Three explanatory tables with formula interface</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">varpart</span><span class="op">(</span><span class="va">mite</span>, <span class="op">~</span> <span class="va">SubsDens</span> <span class="op">+</span> <span class="va">WatrCont</span>, <span class="op">~</span> <span class="va">Substrate</span> <span class="op">+</span> <span class="va">Shrub</span> <span class="op">+</span> <span class="va">Topo</span>,</span></span>
<span class="r-in"><span>   <span class="va">mite.pcnm</span>, data<span class="op">=</span><span class="va">mite.env</span>, transfo<span class="op">=</span><span class="st">"hel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition of variance in RDA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: varpart(Y = mite, X = ~SubsDens + WatrCont, ~Substrate + Shrub +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Topo, mite.pcnm, data = mite.env, transfo = "hel")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species transformation:  hellinger</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Explanatory tables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1:  ~SubsDens + WatrCont</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2:  ~Substrate + Shrub + Topo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3:  mite.pcnm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of explanatory tables: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total variation (SS): 27.205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Variance: 0.39428 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of observations: 70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       Df R.square Adj.R.square Testable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+d+f+g] = X1         2  0.32677      0.30667     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b+d+e+g] = X2         9  0.40395      0.31454     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c+e+f+g] = X3        22  0.62300      0.44653     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+b+d+e+f+g] = X1+X2 11  0.52650      0.43670     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+c+d+e+f+g] = X1+X3 24  0.67372      0.49970     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b+c+d+e+f+g] = X2+X3 31  0.72400      0.49884     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+b+c+d+e+f+g] = All 33  0.75893      0.53794     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual fractions                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a] = X1 | X2+X3       2               0.03910     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b] = X2 | X1+X3       9               0.03824     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c] = X3 | X1+X2      22               0.10124     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [d]                    0               0.01407    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [e]                    0               0.09179    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [f]                    0               0.08306    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [g]                    0               0.17045    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [h] = Residuals                        0.46206    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Controlling 1 table X                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+d] = X1 | X3        2               0.05317     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a+f] = X1 | X2        2               0.12216     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b+d] = X2 | X3        9               0.05231     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b+e] = X2 | X1        9               0.13003     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c+e] = X3 | X1       22               0.19303     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c+f] = X3 | X2       22               0.18429     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use function ‘rda’ to test significance of fractions of interest</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unique fractions and total with shared fractions equally allocated:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unique Contributed                 Component</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1 0.0391       0.144      ~SubsDens + WatrCont</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2 0.0382       0.148 ~Substrate + Shrub + Topo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3 0.1012       0.245                 mite.pcnm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contributions of fractions to sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          X1      X2      X3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a] 0.03910                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b]         0.03824        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c]                 0.10124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [d] 0.00703 0.00703        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [e]         0.04590 0.04590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [f] 0.04153         0.04153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [g] 0.05682 0.05682 0.05682</span>
<span class="r-in"><span><span class="fu">showvarparts</span><span class="op">(</span><span class="fl">3</span>, bg<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varpart-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, bg<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varpart-4.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use RDA to test fraction [a]</span></span></span>
<span class="r-in"><span><span class="co">## Matrix can be an argument in formula</span></span></span>
<span class="r-in"><span><span class="va">rda.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="fu"><a href="decostand.html">decostand</a></span><span class="op">(</span><span class="va">mite</span>, <span class="st">"hell"</span><span class="op">)</span> <span class="op">~</span> <span class="va">SubsDens</span> <span class="op">+</span> <span class="va">WatrCont</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">Condition</span><span class="op">(</span><span class="va">Substrate</span> <span class="op">+</span> <span class="va">Shrub</span> <span class="op">+</span> <span class="va">Topo</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">Condition</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mite.pcnm</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">rda.result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for rda under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: rda(formula = decostand(mite, "hell") ~ SubsDens + WatrCont + Condition(Substrate + Shrub + Topo) + Condition(as.matrix(mite.pcnm)), data = mite.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df Variance      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model     2 0.013771 2.6079  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 36 0.095050                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Four explanatory tables</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">varpart</span><span class="op">(</span><span class="va">mite</span>, <span class="op">~</span> <span class="va">SubsDens</span> <span class="op">+</span> <span class="va">WatrCont</span>, <span class="op">~</span><span class="va">Substrate</span> <span class="op">+</span> <span class="va">Shrub</span> <span class="op">+</span> <span class="va">Topo</span>,</span></span>
<span class="r-in"><span>  <span class="va">mite.pcnm</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, <span class="va">mite.pcnm</span><span class="op">[</span>,<span class="fl">12</span><span class="op">:</span><span class="fl">22</span><span class="op">]</span>, data<span class="op">=</span><span class="va">mite.env</span>, transfo<span class="op">=</span><span class="st">"hel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition of variance in RDA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: varpart(Y = mite, X = ~SubsDens + WatrCont, ~Substrate + Shrub +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Topo, mite.pcnm[, 1:11], mite.pcnm[, 12:22], data = mite.env, transfo =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "hel")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species transformation:  hellinger</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Explanatory tables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1:  ~SubsDens + WatrCont</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2:  ~Substrate + Shrub + Topo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3:  mite.pcnm[, 1:11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4:  mite.pcnm[, 12:22] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of explanatory tables: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total variation (SS): 27.205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Variance: 0.39428 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of observations: 70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition table:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             Df R.square Adj.R.square Testable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [aeghklno] = X1              2  0.32677      0.30667     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [befiklmo] = X2              9  0.40395      0.31454     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cfgjlmno] = X3             11  0.53231      0.44361     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [dhijkmno] = X4             11  0.09069     -0.08176     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [abefghiklmno] = X1+X2      11  0.52650      0.43670     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [acefghjklmno] = X1+X3      13  0.59150      0.49667     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [adeghijklmno] = X1+X4      13  0.40374      0.26533     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [bcefgijklmno] = X2+X3      20  0.63650      0.48813     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [bdefhijklmno] = X2+X4      20  0.53338      0.34292     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cdfghijklmno] = X3+X4      22  0.62300      0.44653     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [abcefghijklmno] = X1+X2+X3 22  0.67947      0.52944     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [abdefghijklmno] = X1+X2+X4 22  0.61553      0.43557     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [acdefghijklmno] = X1+X3+X4 24  0.67372      0.49970     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [bcdefghijklmno] = X2+X3+X4 31  0.72400      0.49884     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [abcdefghijklmno] = All     33  0.75893      0.53794     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual fractions                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a] = X1 | X2+X3+X4          2               0.03910     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b] = X2 | X1+X3+X4          9               0.03824     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c] = X3 | X1+X2+X4         11               0.10237     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [d] = X4 | X1+X2+X3         11               0.00850     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [e]                          0               0.01407    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [f]                          0               0.13200    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [g]                          0               0.05355    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [h]                          0               0.00220    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [i]                          0              -0.00547    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [j]                          0              -0.00963    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [k]                          0              -0.00231    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [l]                          0               0.24037    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [m]                          0              -0.03474    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [n]                          0               0.02730    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [o]                          0              -0.06761    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [p] = Residuals              0               0.46206    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Controlling 2 tables X                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ae] = X1 | X3+X4            2               0.05317     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ag] = X1 | X2+X4            2               0.09265     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ah] = X1 | X2+X3            2               0.04131     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [be] = X2 | X3+X4            9               0.05231     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [bf] = X2 | X1+X4            9               0.17024     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [bi] = X2 | X1+X3            9               0.03277     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cf] = X3 | X1+X4           11               0.23437     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cg] = X3 | X2+X4           11               0.15592     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cj] = X3 | X1+X2           11               0.09274     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [dh] = X4 | X2+X3           11               0.01071     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [di] = X4 | X1+X3           11               0.00303     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [dj] = X4 | X1+X2           11              -0.00113     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Controlling 1 table X                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [aghn] = X1 | X2             2               0.12216     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [aehk] = X1 | X3             2               0.05306     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [aegl] = X1 | X4             2               0.34709     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [bfim] = X2 | X1             9               0.13003     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [beik] = X2 | X3             9               0.04452     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [befl] = X2 | X4             9               0.42468     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cfjm] = X3 | X1            11               0.19000     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cgjn] = X3 | X2            11               0.17359     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [cfgl] = X3 | X4            11               0.52830     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [dijm] = X4 | X1            11              -0.04134     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [dhjn] = X4 | X2            11               0.02837     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [dhik] = X4 | X3            11               0.00292     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use function ‘rda’ to test significance of fractions of interest</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unique fractions and total with shared fractions equally allocated:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unique Contributed                 Component</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1 0.0391      0.1456      ~SubsDens + WatrCont</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2 0.0382      0.1594 ~Substrate + Shrub + Topo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3 0.1024      0.2511         mite.pcnm[, 1:11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4 0.0085     -0.0181        mite.pcnm[, 12:22]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Contributions of fractions to sets:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X1       X2       X3       X4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [a]  0.03910                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [b]           0.03824                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [c]                    0.10237         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [d]                             0.00850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [e]  0.00703  0.00703                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [f]           0.06600  0.06600         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [g]  0.02678           0.02678         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [h]  0.00110                    0.00110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [i]          -0.00274          -0.00274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [j]                   -0.00482 -0.00482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [k] -0.00077 -0.00077          -0.00077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [l]  0.08012  0.08012  0.08012         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [m]          -0.01158 -0.01158 -0.01158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [n]  0.00910           0.00910  0.00910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [o] -0.01690 -0.01690 -0.01690 -0.01690</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, bg<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varpart-5.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Show values for all partitions by putting 'cutoff' low enough:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, cutoff <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, bg<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varpart-6.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

