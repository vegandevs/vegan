<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rarefaction Species Richness — rarefy • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Rarefaction Species Richness — rarefy" />
<meta property="og:description" content="Rarefied species richness for community ecologists." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rarefaction Species Richness</h1>
    
    <div class="hidden name"><code>rarefy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Rarefied species richness for community ecologists.</p>
    </div>

    <pre class="usage"><span class='fu'>rarefy</span>(<span class='no'>x</span>, <span class='no'>sample</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'>rrarefy</span>(<span class='no'>x</span>, <span class='no'>sample</span>)
<span class='fu'>drarefy</span>(<span class='no'>x</span>, <span class='no'>sample</span>)
<span class='fu'>rarecurve</span>(<span class='no'>x</span>, <span class='kw'>step</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>sample</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Sample Size"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Species"</span>,
          <span class='kw'>label</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>col</span>, <span class='no'>lty</span>, <span class='no'>...</span>)
<span class='fu'>rareslope</span>(<span class='no'>x</span>, <span class='no'>sample</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Community data, a matrix-like object or a vector.</p></td>
    </tr>
    <tr>
      <th>MARGIN</th>
      <td><p>Margin for which the index is computed.</p></td>
    </tr>
    <tr>
      <th>sample</th>
      <td><p>Subsample size for rarefying community, either a single
    value or a vector.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>Estimate standard errors.</p></td>
    </tr>
    <tr>
      <th>step</th>
      <td><p>Step size for sample sizes in rarefaction curves.</p></td>
    </tr>
    <tr>
      <th>xlab, ylab</th>
      <td><p>Axis labels in plots of rarefaction curves.</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>Label rarefaction curves by rownames of <code>x</code>
    (logical).</p></td>
    </tr>
    <tr>
      <th>col, lty</th>
      <td><p>plotting colour and line type, see
    <code><a href='https://rdrr.io/r/graphics/par.html'>par</a></code>. Can be a vector of length <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(x)</a></code>, one per
    sample, and will be extended to such a length internally.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Parameters passed to <code><a href='https://rdrr.io/r/stats/nlm.html'>nlm</a></code>, or to <code><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></code>,
    <code><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></code> and <code><a href='ordilabel.html'>ordilabel</a></code> in <code>rarecurve</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>Function <code>rarefy</code> gives the expected species richness in random
  subsamples of size <code>sample</code> from the community. The size of
  <code>sample</code> should be smaller than total community size, but the
  function will work for larger <code>sample</code> as well (with a warning)
  and return non-rarefied species richness (and standard error =
  0). If <code>sample</code> is a vector, rarefaction of all observations is
  performed for each sample size separately.  Rarefaction can be
  performed only with genuine counts of individuals.  The function
  <code>rarefy</code> is based on Hurlbert's (1971) formulation, and the
  standard errors on Heck et al. (1975).</p>
<p>Function <code>rrarefy</code> generates one randomly rarefied community
  data frame or vector of given <code>sample</code> size. The <code>sample</code>
  can be a vector giving the sample sizes for each row.  If the
  <code>sample</code> size is equal to or smaller than the observed number
  of individuals, the non-rarefied community will be returned.  The
  random rarefaction is made without replacement so that the variance
  of rarefied communities is rather related to rarefaction proportion
  than to the size of the <code>sample</code>. Random rarefaction is
  sometimes used to remove the effects of different sample
  sizes. This is usually a bad idea: random rarefaction discards valid
  data, introduces random error and reduces the quality of the data
  (McMurdie &amp; Holmes 2014). It is better to use normalizing
  transformations (<code><a href='decostand.html'>decostand</a></code> in <span class="pkg">vegan</span>) possible
  with variance stabilization (<code><a href='decostand.html'>decostand</a></code> and
  <code><a href='dispweight.html'>dispweight</a></code> in <span class="pkg">vegan</span>) and methods that are not
  sensitive to sample sizes.</p>
<p>Function <code>drarefy</code> returns probabilities that species occur in
  a rarefied community of size <code>sample</code>. The <code>sample</code> can be
  a vector giving the sample sizes for each row. If the <code>sample</code>
  is equal to or smaller than the observed number of individuals, all
  observed species will have sampling probability 1.</p>
<p>Function <code>rarecurve</code> draws a rarefaction curve for each row of
  the input data. The rarefaction curves are evaluated using the
  interval of <code>step</code> sample sizes, always including 1 and total
  sample size.  If <code>sample</code> is specified, a vertical line is
  drawn at <code>sample</code> with horizontal lines for the rarefied
  species richnesses.</p>
<p>Function <code>rareslope</code> calculates the slope of <code>rarecurve</code>
  (derivative of <code>rarefy</code>) at given <code>sample</code> size; the
  <code>sample</code> need not be an integer.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of rarefied species richness values. With a single
  <code>sample</code> and <code>se = TRUE</code>, function <code>rarefy</code> returns a
  2-row matrix with rarefied richness (<code>S</code>) and its standard error
  (<code>se</code>). If <code>sample</code> is a vector in <code>rarefy</code>, the
  function returns a matrix with a column for each <code>sample</code> size,
  and if <code>se = TRUE</code>, rarefied richness and its standard error are
  on consecutive lines.</p>
<p>Function <code>rarecurve</code> returns <code><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></code> list of
  <code>rarefy</code> results corresponding each drawn curve.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Heck, K.L., van Belle, G. &amp; Simberloff, D. (1975). Explicit
  calculation of the rarefaction diversity measurement and the
  determination of sufficient sample size. <em>Ecology</em> <strong>56</strong>,
  1459--1461.</p>
<p>Hurlbert, S.H. (1971). The nonconcept of species diversity: a critique
  and alternative parameters. <em>Ecology</em> <strong>52</strong>, 577--586.</p>
<p>McMurdie, P.J. &amp; Holmes, S. (2014). Waste not, want not: Why
  rarefying microbiome data is inadmissible. <em>PLoS Comput Biol</em>
  <strong>10(4):</strong> e1003531. doi: <a href='https://doi.org/10.1371/journal.pcbi.1003531'>10.1371/journal.pcbi.1003531</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Use <code><a href='specaccum.html'>specaccum</a></code> for species accumulation curves
  where sites are sampled instead of individuals. <code><a href='specpool.html'>specpool</a></code>
  extrapolates richness to an unknown sample size.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>BCI</span>)
<span class='no'>S</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='diversity.html'>specnumber</a></span>(<span class='no'>BCI</span>) <span class='co'># observed number of species</span>
(<span class='no'>raremax</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span>(<span class='no'>BCI</span>)))</div><div class='output co'>#&gt; [1] 340</div><div class='input'><span class='no'>Srare</span> <span class='kw'>&lt;-</span> <span class='fu'>rarefy</span>(<span class='no'>BCI</span>, <span class='no'>raremax</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>S</span>, <span class='no'>Srare</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Observed No. of Species"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Rarefied No. of Species"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>)</div><div class='img'><img src='rarefy-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>rarecurve</span>(<span class='no'>BCI</span>, <span class='kw'>step</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='no'>raremax</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>0.6</span>)</div><div class='img'><img src='rarefy-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


