<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rarefaction Species Richness — rarefy • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rarefaction Species Richness — rarefy"><meta name="description" content="Rarefied species richness for community ecologists."><meta property="og:description" content="Rarefied species richness for community ecologists."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rarefaction Species Richness</h1>

      <div class="d-none name"><code>rarefy.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Rarefied species richness for community ecologists.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rarefy</span><span class="op">(</span><span class="va">x</span>, <span class="va">sample</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, MARGIN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">rrarefy</span><span class="op">(</span><span class="va">x</span>, <span class="va">sample</span><span class="op">)</span></span>
<span><span class="fu">drarefy</span><span class="op">(</span><span class="va">x</span>, <span class="va">sample</span><span class="op">)</span></span>
<span><span class="fu">rarecurve</span><span class="op">(</span><span class="va">x</span>, step <span class="op">=</span> <span class="fl">1</span>, <span class="va">sample</span>, xlab <span class="op">=</span> <span class="st">"Sample Size"</span>, ylab <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>          label <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">col</span>, <span class="va">lty</span>, tidy <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">rareslope</span><span class="op">(</span><span class="va">x</span>, <span class="va">sample</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Community data, a matrix-like object or a vector.</p></dd>

  <dt id="arg-margin">MARGIN<a class="anchor" aria-label="anchor" href="#arg-margin"></a></dt>
<dd><p>Margin for which the index is computed.</p></dd>

  <dt id="arg-sample">sample<a class="anchor" aria-label="anchor" href="#arg-sample"></a></dt>
<dd><p>Subsample size for rarefying community, either a single
    value or a vector.</p></dd>

  <dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>Estimate standard errors.</p></dd>

  <dt id="arg-step">step<a class="anchor" aria-label="anchor" href="#arg-step"></a></dt>
<dd><p>Step size for sample sizes in rarefaction curves.</p></dd>

  <dt id="arg-xlab-ylab">xlab, ylab<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab"></a></dt>
<dd><p>Axis labels in plots of rarefaction curves.</p></dd>

  <dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>Label rarefaction curves by rownames of <code>x</code>
    (logical).</p></dd>

  <dt id="arg-col-lty">col, lty<a class="anchor" aria-label="anchor" href="#arg-col-lty"></a></dt>
<dd><p>plotting colour and line type, see
    <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>. Can be a vector of length <code>nrow(x)</code>, one per
    sample, and will be extended to such a length internally.</p></dd>

  <dt id="arg-tidy">tidy<a class="anchor" aria-label="anchor" href="#arg-tidy"></a></dt>
<dd><p>Instead of drawing a <code>plot</code>, return a “tidy”
    data frame than can be used in <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><span class="pkg">ggplot2</span></a> graphics. The data
    frame has variables <code>Site</code> (factor), <code>Sample</code> and
    <code>Species</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Parameters passed to <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm</a></code>, or to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>,
    <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></code> and <code><a href="ordilabel.html">ordilabel</a></code> in <code>rarecurve</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Function <code>rarefy</code> gives the expected species richness in random
  subsamples of size <code>sample</code> from the community. The size of
  <code>sample</code> should be smaller than total community size, but the
  function will work for larger <code>sample</code> as well (with a warning)
  and return non-rarefied species richness (and standard error =
  0). If <code>sample</code> is a vector, rarefaction of all observations is
  performed for each sample size separately.  Rarefaction can be
  performed only with genuine counts of individuals.  The function
  <code>rarefy</code> is based on Hurlbert's (1971) formulation, and the
  standard errors on Heck et al. (1975).</p>
<p>Function <code>rrarefy</code> generates one randomly rarefied community
  data frame or vector of given <code>sample</code> size. The <code>sample</code>
  can be a vector giving the sample sizes for each row.  If the
  <code>sample</code> size is equal to or larger than the observed number
  of individuals, the non-rarefied community will be returned.  The
  random rarefaction is made without replacement so that the variance
  of rarefied communities is rather related to rarefaction proportion
  than to the size of the <code>sample</code>. Random rarefaction is
  sometimes used to remove the effects of different sample
  sizes. This is usually a bad idea: random rarefaction discards valid
  data, introduces random error and reduces the quality of the data
  (McMurdie &amp; Holmes 2014). It is better to use normalizing
  transformations (<code><a href="decostand.html">decostand</a></code> in <span class="pkg">vegan</span>) possible
  with variance stabilization (<code><a href="decostand.html">decostand</a></code> and
  <code><a href="dispweight.html">dispweight</a></code> in <span class="pkg">vegan</span>) and methods that are not
  sensitive to sample sizes.</p>
<p>Function <code>drarefy</code> returns probabilities that species occur in
  a rarefied community of size <code>sample</code>. The <code>sample</code> can be
  a vector giving the sample sizes for each row. If the <code>sample</code>
  is equal to or larger than the observed number of individuals, all
  observed species will have sampling probability 1.</p>
<p>Function <code>rarecurve</code> draws a rarefaction curve for each row of
  the input data. The rarefaction curves are evaluated using the
  interval of <code>step</code> sample sizes, always including 1 and total
  sample size.  If <code>sample</code> is specified, a vertical line is
  drawn at <code>sample</code> with horizontal lines for the rarefied
  species richnesses.</p>
<p>Function <code>rareslope</code> calculates the slope of <code>rarecurve</code>
  (derivative of <code>rarefy</code>) at given <code>sample</code> size; the
  <code>sample</code> need not be an integer.</p>
<p>Rarefaction functions should be used for observed counts. If you
  think it is necessary to use a multiplier to data, rarefy first and
  then multiply. Removing rare species before rarefaction can also
  give biased results. Observed count data normally include singletons
  (species with count 1), and if these are missing, functions issue
  warnings. These may be false positives, but it is recommended to
  check that the observed counts are not multiplied or rare taxa are
  not removed.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of rarefied species richness values. With a single
  <code>sample</code> and <code>se = TRUE</code>, function <code>rarefy</code> returns a
  2-row matrix with rarefied richness (<code>S</code>) and its standard error
  (<code>se</code>). If <code>sample</code> is a vector in <code>rarefy</code>, the
  function returns a matrix with a column for each <code>sample</code> size,
  and if <code>se = TRUE</code>, rarefied richness and its standard error are
  on consecutive lines.</p>
<p>Function <code>rarecurve</code> returns <code><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></code> list of
  <code>rarefy</code> results corresponding each drawn curve. Alternatively,
  with <code>tidy = TRUE</code> it returns a data frame that can be used in
  <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><span class="pkg">ggplot2</span></a> graphics.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Heck, K.L., van Belle, G. &amp; Simberloff, D. (1975). Explicit
  calculation of the rarefaction diversity measurement and the
  determination of sufficient sample size. <em>Ecology</em> <strong>56</strong>,
  1459–1461.</p>
<p>Hurlbert, S.H. (1971). The nonconcept of species diversity: a critique
  and alternative parameters. <em>Ecology</em> <strong>52</strong>, 577–586.</p>
<p>McMurdie, P.J. &amp; Holmes, S. (2014). Waste not, want not: Why
  rarefying microbiome data is inadmissible. <em>PLoS Comput Biol</em>
  <strong>10(4):</strong> e1003531. <a href="https://doi.org/10.1371/journal.pcbi.1003531" class="external-link">doi:10.1371/journal.pcbi.1003531</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Use <code><a href="specaccum.html">specaccum</a></code> for species accumulation curves
  where sites are sampled instead of individuals. <code><a href="specpool.html">specpool</a></code>
  extrapolates richness to an unknown sample size.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="diversity.html">specnumber</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span> <span class="co"># observed number of species</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">raremax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 340</span>
<span class="r-in"><span><span class="va">Srare</span> <span class="op">&lt;-</span> <span class="fu">rarefy</span><span class="op">(</span><span class="va">BCI</span>, <span class="va">raremax</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">Srare</span>, xlab <span class="op">=</span> <span class="st">"Observed No. of Species"</span>, ylab <span class="op">=</span> <span class="st">"Rarefied No. of Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rarefy-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu">rarecurve</span><span class="op">(</span><span class="va">BCI</span>, step <span class="op">=</span> <span class="fl">20</span>, sample <span class="op">=</span> <span class="va">raremax</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rarefy-2.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

