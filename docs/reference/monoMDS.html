<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Global and Local Non-metric Multidimensional Scaling and Linear and Hybrid Scaling — monoMDS • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Global and Local Non-metric Multidimensional Scaling and Linear and Hybrid Scaling — monoMDS"><meta name="description" content="Function implements Kruskal's (1964a,b) non-metric
  multidimensional scaling (NMDS) using monotone regression and
  primary (&amp;#8220;weak&amp;#8221;) treatment of ties. In addition to
  traditional global NMDS, the function implements local NMDS, linear
  and hybrid multidimensional scaling."><meta property="og:description" content="Function implements Kruskal's (1964a,b) non-metric
  multidimensional scaling (NMDS) using monotone regression and
  primary (&amp;#8220;weak&amp;#8221;) treatment of ties. In addition to
  traditional global NMDS, the function implements local NMDS, linear
  and hybrid multidimensional scaling."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Global and Local Non-metric Multidimensional Scaling and Linear and Hybrid Scaling</h1>

      <div class="d-none name"><code>monoMDS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function implements Kruskal's (1964a,b) non-metric
  multidimensional scaling (NMDS) using monotone regression and
  primary (“weak”) treatment of ties. In addition to
  traditional global NMDS, the function implements local NMDS, linear
  and hybrid multidimensional scaling.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">monoMDS</span><span class="op">(</span><span class="va">dist</span>, <span class="va">y</span>, k <span class="op">=</span> <span class="fl">2</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"global"</span>, <span class="st">"local"</span>, <span class="st">"linear"</span>, <span class="st">"hybrid"</span><span class="op">)</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.8</span>, maxit <span class="op">=</span> <span class="fl">200</span>, weakties <span class="op">=</span> <span class="cn">TRUE</span>, stress <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    scaling <span class="op">=</span> <span class="cn">TRUE</span>, pc <span class="op">=</span> <span class="cn">TRUE</span>, smin <span class="op">=</span> <span class="fl">1e-4</span>, sfgrmin <span class="op">=</span> <span class="fl">1e-7</span>,</span>
<span>    sratmax<span class="op">=</span><span class="fl">0.999999</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'monoMDS'</span></span>
<span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">x</span>, choices <span class="op">=</span> <span class="cn">NA</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'monoMDS'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"t"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'monoMDS'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">select</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'monoMDS'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">labels</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">select</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>Input dissimilarities.</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Starting configuration. A random configuration will be
    generated if this is missing.</p></dd>


  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Number of dimensions. NB., the number of points \(n\)
    should be \(n &gt; 2k + 1\), and preferably higher in
    non-metric MDS.</p></dd>


  <dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>MDS model: <code>"global"</code> is normal non-metric MDS
    with a monotone regression, <code>"local"</code> is non-metric MDS with
    separate regressions for each point, <code>"linear"</code> uses linear
    regression, and <code>"hybrid"</code> uses linear regression for
    dissimilarities below a threshold in addition to monotone
    regression. See Details.</p></dd>


  <dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Dissimilarity below which linear regression is
    used alternately with monotone regression.</p></dd>


  <dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>Maximum number of iterations.</p></dd>


  <dt id="arg-weakties">weakties<a class="anchor" aria-label="anchor" href="#arg-weakties"></a></dt>
<dd><p>Use primary or weak tie treatment, where equal
    observed dissimilarities are allowed to have different fitted
    values. if <code>FALSE</code>, then secondary (strong) tie treatment is
    used, and tied values are not broken.</p></dd>


  <dt id="arg-stress">stress<a class="anchor" aria-label="anchor" href="#arg-stress"></a></dt>
<dd><p>Use stress type 1 or 2 (see Details).</p></dd>


  <dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>Scale final scores to unit root mean squares.</p></dd>


  <dt id="arg-pc">pc<a class="anchor" aria-label="anchor" href="#arg-pc"></a></dt>
<dd><p>Rotate final scores to principal components.</p></dd>


  <dt id="arg-smin-sfgrmin-sratmax">smin, sfgrmin, sratmax<a class="anchor" aria-label="anchor" href="#arg-smin-sfgrmin-sratmax"></a></dt>
<dd><p>Convergence criteria: iterations stop
    when stress drops below <code>smin</code>, scale factor of the gradient
    drops below <code>sfgrmin</code>, or stress ratio between two iterations
    goes over <code>sratmax</code> (but is still \(&lt; 1\)).</p></dd>


  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>monoMDS</code> result.</p></dd>


  <dt id="arg-choices">choices<a class="anchor" aria-label="anchor" href="#arg-choices"></a></dt>
<dd><p>Dimensions returned or plotted. The default <code>NA</code>
    returns all dimensions.</p></dd>


  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of the plot: <code>"t"</code> for text, <code>"p"</code>
    for points, and <code>"n"</code> for none.</p></dd>


  <dt id="arg-select">select<a class="anchor" aria-label="anchor" href="#arg-select"></a></dt>
<dd><p>Items to be displayed.  This can either be a logical
          vector which is <code>TRUE</code> for displayed items or a vector of
          indices of displayed items.</p></dd>


  <dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>Labels to be use used instead of row names.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters to the functions (ignored in
    <code>monoMDS</code>, passed to graphical functions in <code>plot</code>.).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are several versions of non-metric multidimensional
  scaling in <span style="R">R</span>, but <code>monoMDS</code> offers the following unique
  combination of features:</p><ul><li><p>“Weak” treatment of ties (Kruskal 1964a,b), where tied
    dissimilarities can be broken in monotone regression. This is
    especially important for cases where compared sites share no species
    and dissimilarities are tied to their maximum value of one. Breaking
    ties allows these points to be at different distances and can help
    in recovering very long coenoclines (gradients).  Functions in the
    <a href="https://CRAN.R-project.org/package=smacof" class="external-link"><span class="pkg">smacof</span></a> package also hav adequate tie treatment.</p></li>
<li><p>Handles missing values in a meaningful way.</p></li>
<li><p>Offers “local” and “hybrid” scaling in
    addition to usual “global” NMDS (see below).</p></li>
<li><p>Uses fast compiled code (<code><a href="https://rdrr.io/pkg/MASS/man/isoMDS.html" class="external-link">isoMDS</a></code> of the
    <span class="pkg">MASS</span> package also uses compiled code).</p></li>
</ul><p>Function <code>monoMDS</code> uses Kruskal's (1964b) original monotone
  regression to minimize the stress. There are two alternatives of
  stress: Kruskal's (1964a,b) original or “stress 1” and an
  alternative version or “stress 2” (Sibson 1972). Both of
  these stresses can be expressed with a general formula</p>
<p>$$s^2 = \frac{\sum (d - \hat d)^2}{\sum(d - d_0)^2}$$</p>
<p>where \(d\) are distances among points in ordination configuration,
  \(\hat d\) are the fitted ordination distances, and
  \(d_0\) are the ordination distances under null model.  For
  “stress 1” \(d_0 = 0\), and for “stress 2”
  \(d_0 = \bar{d}\) or mean distances. “Stress 2”
  can be expressed as \(s^2 = 1 - R^2\),
  where\(R^2\) is squared correlation between fitted values and
  ordination distances, and so related to the “linear fit” of
  <code><a href="goodness.metaMDS.html">stressplot</a></code>.</p>
<p>Function <code>monoMDS</code> can fit several alternative NMDS variants that
  can be selected with argument <code>model</code>.  The default <code>model =
  "global"</code> fits global NMDS, or Kruskal's (1964a,b) original NMDS
  similar to <code><a href="https://rdrr.io/pkg/MASS/man/isoMDS.html" class="external-link">isoMDS</a></code> (<span class="pkg">MASS</span>).  Alternative
  <code>model = "local"</code> fits local NMDS where independent monotone
  regression is used for each point (Sibson 1972).  Alternative
  <code>model = "linear"</code> fits a linear MDS. This fits a linear
  regression instead of monotone, and is not identical to metric scaling
  or principal coordinates analysis (<code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>) that
  performs an eigenvector decomposition of dissimilarities (Gower
  1966). Alternative <code>model = "hybrid"</code> implements hybrid MDS that
  uses monotone regression for all points and linear regression for
  dissimilarities below or at a <code>threshold</code> dissimilarity in
  alternating steps (Faith et al. 1987). Function
  <code><a href="goodness.metaMDS.html">stressplot</a></code> can be used to display the kind of regression
  in each <code>model</code>.</p>
<p>Scaling, orientation and direction of the axes is arbitrary.
  However, the function always centres the axes, and the default
  <code>scaling</code> is to scale the configuration of unit root mean
  square and to rotate the axes (argument <code>pc</code>) to principal
  components so that the first dimension shows the major variation.
  It is possible to rotate the solution so that the first axis is
  parallel to a given environmental variable using function
  <code><a href="MDSrotate.html">MDSrotate</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="convergence-criteria">Convergence Criteria<a class="anchor" aria-label="anchor" href="#convergence-criteria"></a></h2>


<p>NMDS is iterative, and the function stops when any of its
  convergence criteria is met. There is actually no criterion of
  assured convergence, and any solution can be a local optimum. You
  should compare several random starts (or use <code>monoMDS</code> via
  <code><a href="metaMDS.html">metaMDS</a></code>) to assess if the solutions is likely a global
  optimum.</p>
<p>The stopping criteria are:</p><dl><dt><code>maxit</code>:</dt>
<dd><p>Maximum number of iterations. Reaching this
     criterion means that solutions was almost certainly not found,
     and <code>maxit</code> should be increased.</p></dd>


     <dt><code>smin</code>:</dt>
<dd><p>Minimum stress. If stress is nearly zero,
     the fit is almost perfect. Usually this means that data set is
     too small for the requested analysis, and there may be several
     different solutions that are almost as perfect. You should reduce
     the number of dimensions (<code>k</code>), get more data (more
     observations) or use some other method, such as metric scaling
     (<code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>, <code><a href="wcmdscale.html">wcmdscale</a></code>).</p></dd>


     <dt><code>sratmax</code>:</dt>
<dd><p>Change in stress. Values close to one
     mean almost unchanged stress. This may mean a solution, but it
     can also signal stranding on suboptimal solution with flat stress
     surface.</p></dd>


     <dt><code>sfgrmin</code>:</dt>
<dd><p>Minimum scale factor. Values close to
     zero mean almost unchanged configuration. This may mean a
     solution, but will also happen in local optima.</p></dd>



</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>"monoMDS"</code>. The final scores
  are returned in item <code>points</code> (function <code>scores</code> extracts
  these results), and the stress in item <code>stress</code>. In addition,
  there is a large number of other items (but these may change without
  notice in the future releases).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Faith, D.P., Minchin, P.R and Belbin, L. 1987. Compositional
      dissimilarity as a robust measure of ecological
      distance. <em>Vegetatio</em> 69, 57–68.</p>
<p>Gower, J.C. (1966). Some distance properties of latent root and
      vector methods used in multivariate analysis. <em>Biometrika</em>
      53, 325–328.</p>
<p>Kruskal, J.B. 1964a. Multidimensional scaling by optimizing
      goodness-of-fit to a nonmetric hypothesis. <em>Psychometrika</em>
      29, 1–28.</p>
<p>Kruskal, J.B. 1964b. Nonmetric multidimensional scaling: a numerical
      method. <em>Psychometrika</em> 29, 115–129.</p>
<p>Minchin, P.R. 1987. An evaluation of relative robustness of
      techniques for ecological ordinations. <em>Vegetatio</em> 69,
      89–107.</p>
<p>Sibson, R. 1972. Order invariant methods for data
      analysis. <em>Journal of the Royal Statistical Society B</em> 34,
      311–349.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Peter R. Michin (Fortran core) and Jari Oksanen (R interface).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This is the default NMDS function used in
   <code><a href="metaMDS.html">metaMDS</a></code>. Function <code><a href="metaMDS.html">metaMDS</a></code> adds support
   functions so that NMDS can be run like recommended by Minchin
   (1987).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="metaMDS.html">metaMDS</a></code> for the <span class="pkg">vegan</span> way of running NMDS,
  and <code><a href="https://rdrr.io/pkg/MASS/man/isoMDS.html" class="external-link">isoMDS</a></code> and <a href="https://CRAN.R-project.org/package=smacof" class="external-link"><span class="pkg">smacof</span></a> for some
  alternative implementations of NMDS.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">monoMDS</span><span class="op">(</span><span class="va">dis</span>, model <span class="op">=</span> <span class="st">"loc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> monoMDS(dist = dis, model = "loc") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Local non-metric Multidimensional Scaling</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 points, dissimilarity ‘bray’, call ‘vegdist(x = dune)’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stress:     0.07596745 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stress type 1, weak ties</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scores scaled to unit root mean square, rotated to principal components</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stopped after 62 iterations: Stress nearly unchanged (ratio &gt; sratmax)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="monoMDS-1.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

