<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Global and Local Non-metric Multidimensional Scaling and
  Linear and Hybrid Scaling — monoMDS • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Global and Local Non-metric Multidimensional Scaling and
  Linear and Hybrid Scaling — monoMDS" />
<meta property="og:description" content="Function implements Kruskal's (1964a,b) non-metric
  multidimensional scaling (NMDS) using monotone regression and
  primary (&amp;#8220;weak&amp;#8221;) treatment of ties. In addition to
  traditional global NMDS, the function implements local NMDS, linear
  and hybrid multidimensional scaling." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Global and Local Non-metric Multidimensional Scaling and
  Linear and Hybrid Scaling</h1>
    
    <div class="hidden name"><code>monoMDS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function implements Kruskal's (1964a,b) non-metric
  multidimensional scaling (NMDS) using monotone regression and
  primary (&#8220;weak&#8221;) treatment of ties. In addition to
  traditional global NMDS, the function implements local NMDS, linear
  and hybrid multidimensional scaling.</p>
    </div>

    <pre class="usage"><span class='fu'>monoMDS</span>(<span class='no'>dist</span>, <span class='no'>y</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"global"</span>, <span class='st'>"local"</span>, <span class='st'>"linear"</span>, <span class='st'>"hybrid"</span>),
    <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>weakties</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>stress</span> <span class='kw'>=</span> <span class='fl'>1</span>,
    <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>pc</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>smin</span> <span class='kw'>=</span> <span class='fl'>1e-4</span>, <span class='kw'>sfgrmin</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>,
    <span class='kw'>sratmax</span><span class='kw'>=</span><span class='fl'>0.99999</span>, <span class='no'>...</span>)
<span class='co'># S3 method for monoMDS</span>
<span class='fu'><a href='scores.html'>scores</a></span>(<span class='no'>x</span>, <span class='kw'>choices</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>...</span>)
<span class='co'># S3 method for monoMDS</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>choices</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"t"</span>, <span class='no'>...</span>)
<span class='co'># S3 method for monoMDS</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>x</span>, <span class='kw'>choices</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='no'>select</span>, <span class='no'>...</span>)
<span class='co'># S3 method for monoMDS</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>x</span>, <span class='no'>labels</span>, <span class='kw'>choices</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='no'>select</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dist</th>
      <td><p>Input dissimilarities.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Starting configuration. A random configuration will be
    generated if this is missing.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Number of dimensions. NB., the number of points \(n\)
    should be \(n &gt; 2k + 1\), and preferably higher in
    non-metric MDS.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>MDS model: <code>"global"</code> is normal non-metric MDS
    with a monotone regression, <code>"local"</code> is non-metric MDS with
    separate regressions for each point, <code>"linear"</code> uses linear
    regression, and <code>"hybrid"</code> uses linear regression for
    dissimilarities below a threshold in addition to monotone
    regression. See Details.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Dissimilarity below which linear regression is
    used alternately with monotone regression.</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>Maximum number of iterations.</p></td>
    </tr>
    <tr>
      <th>weakties</th>
      <td><p>Use primary or weak tie treatment, where equal
    observed dissimilarities are allowed to have different fitted
    values. if <code>FALSE</code>, then secondary (strong) tie treatment is
    used, and tied values are not broken.</p></td>
    </tr>
    <tr>
      <th>stress</th>
      <td><p>Use stress type 1 or 2 (see Details).</p></td>
    </tr>
    <tr>
      <th>scaling</th>
      <td><p>Scale final scores to unit root mean squares.</p></td>
    </tr>
    <tr>
      <th>pc</th>
      <td><p>Rotate final scores to principal components.</p></td>
    </tr>
    <tr>
      <th>smin, sfgrmin, sratmax</th>
      <td><p>Convergence criteria: iterations stop
    when stress drops below <code>smin</code>, scale factor of the gradient
    drops below <code>sfgrmin</code>, or stress ratio between two iterations
    goes over <code>sratmax</code> (but is still \(&lt; 1\)).</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A <code>monoMDS</code> result.</p></td>
    </tr>
    <tr>
      <th>choices</th>
      <td><p>Dimensions returned or plotted. The default <code>NA</code>
    returns all dimensions.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The type of the plot: <code>"t"</code> for text, <code>"p"</code>
    for points, and <code>"n"</code> for none.</p></td>
    </tr>
    <tr>
      <th>select</th>
      <td><p>Items to be displayed.  This can either be a logical
          vector which is <code>TRUE</code> for displayed items or a vector of
          indices of displayed items.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>Labels to be use used instead of row names.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters to the functions (ignored in
    <code>monoMDS</code>, passed to graphical functions in <code>plot</code>.).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are several versions of non-metric multidimensional
  scaling in <span style="R">R</span>, but <code>monoMDS</code> offers the following unique
  combination of features:</p><ul>
<li><p>&#8220;Weak&#8221; treatment of ties (Kruskal 1964a,b), where tied
    dissimilarities can be broken in monotone regression. This is
    especially important for cases where compared sites share no species
    and dissimilarities are tied to their maximum value of one. Breaking
    ties allows these points to be at different distances and can help
    in recovering very long coenoclines (gradients).  Functions in the
    <a href='https://CRAN.R-project.org/package=smacof'><span class="pkg">smacof</span></a> package also hav adequate tie treatment.</p></li>
<li><p>Handles missing values in a meaningful way.</p></li>
<li><p>Offers &#8220;local&#8221; and &#8220;hybrid&#8221; scaling in
    addition to usual &#8220;global&#8221; NMDS (see below).</p></li>
<li><p>Uses fast compiled code (<code><a href='https://rdrr.io/pkg/MASS/man/isoMDS.html'>isoMDS</a></code> of the
    <span class="pkg">MASS</span> package also uses compiled code).</p></li>
</ul>

<p>Function <code>monoMDS</code> uses Kruskal's (1964b) original monotone
  regression to minimize the stress. There are two alternatives of
  stress: Kruskal's (1964a,b) original or &#8220;stress 1&#8221; and an
  alternative version or &#8220;stress 2&#8221; (Sibson 1972). Both of
  these stresses can be expressed with a general formula</p>
<p>$$s^2 = \frac{\sum (d - \hat d)^2}{\sum(d - d_0)^2}$$</p>
<p>where \(d\) are distances among points in ordination configuration,
  \(\hat d\) are the fitted ordination distances, and
  \(d_0\) are the ordination distances under null model.  For
  &#8220;stress 1&#8221; \(d_0 = 0\), and for &#8220;stress 2&#8221;
  \(d_0 = \bar{d}\) or mean distances. &#8220;Stress 2&#8221;
  can be expressed as \(s^2 = 1 - R^2\),
  where\(R^2\) is squared correlation between fitted values and
  ordination distances, and so related to the &#8220;linear fit&#8221; of
  <code><a href='goodness.metaMDS.html'>stressplot</a></code>.</p>
<p>Function <code>monoMDS</code> can fit several alternative NMDS variants that
  can be selected with argument <code>model</code>.  The default <code>model =
  "global"</code> fits global NMDS, or Kruskal's (1964a,b) original NMDS
  similar to <code><a href='https://rdrr.io/pkg/MASS/man/isoMDS.html'>isoMDS</a></code> (<span class="pkg">MASS</span>).  Alternative
  <code>model = "local"</code> fits local NMDS where independent monotone
  regression is used for each point (Sibson 1972).  Alternative
  <code>model = "linear"</code> fits a linear MDS. This fits a linear
  regression instead of monotone, and is not identical to metric scaling
  or principal coordinates analysis (<code><a href='https://rdrr.io/r/stats/cmdscale.html'>cmdscale</a></code>) that
  performs an eigenvector decomposition of dissimilarities (Gower
  1966). Alternative <code>model = "hybrid"</code> implements hybrid MDS that
  uses monotone regression for all points and linear regression for
  dissimilarities below or at a <code>threshold</code> dissimilarity in
  alternating steps (Faith et al. 1987). Function
  <code><a href='goodness.metaMDS.html'>stressplot</a></code> can be used to display the kind of regression
  in each <code>model</code>.</p>
<p>Scaling, orientation and direction of the axes is arbitrary.
  However, the function always centres the axes, and the default
  <code>scaling</code> is to scale the configuration of unit root mean
  square and to rotate the axes (argument <code>pc</code>) to principal
  components so that the first dimension shows the major variation.
  It is possible to rotate the solution so that the first axis is
  parallel to a given environmental variable using function
  <code><a href='MDSrotate.html'>MDSrotate</a></code>.</p>
    <h2 class="hasAnchor" id="convergence-criteria"><a class="anchor" href="#convergence-criteria"></a>Convergence Criteria</h2>

    

<p>NMDS is iterative, and the function stops when any of its
  convergence criteria is met. There is actually no criterion of
  assured convergence, and any solution can be a local optimum. You
  should compare several random starts (or use <code>monoMDS</code> via
  <code><a href='metaMDS.html'>metaMDS</a></code>) to assess if the solutions is likely a global
  optimum.</p>
<p>The stopping criteria are:</p><dl class='dl-horizontal'>

     <dt><code>maxit</code>:</dt><dd><p>Maximum number of iterations. Reaching this
     criterion means that solutions was almost certainly not found,
     and <code>maxit</code> should be increased.</p></dd>

     <dt><code>smin</code>:</dt><dd><p>Minimum stress. If stress is nearly zero,
     the fit is almost perfect. Usually this means that data set is
     too small for the requested analysis, and there may be several
     different solutions that are almost as perfect. You should reduce
     the number of dimensions (<code>k</code>), get more data (more
     observations) or use some other method, such as metric scaling
     (<code><a href='https://rdrr.io/r/stats/cmdscale.html'>cmdscale</a></code>, <code><a href='wcmdscale.html'>wcmdscale</a></code>).</p></dd>

     <dt><code>sratmax</code>:</dt><dd><p>Change in stress. Values close to one
     mean almost unchanged stress. This may mean a solution, but it
     can also signal stranding on suboptimal solution with flat stress
     surface.</p></dd>

     <dt><code>sfgrmin</code>:</dt><dd><p>Minimum scale factor. Values close to
     zero mean almost unchanged configuration. This may mean a
     solution, but will also happen in local optima.</p></dd>

  
</dl>


    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an object of class <code>"monoMDS"</code>. The final scores
  are returned in item <code>points</code> (function <code>scores</code> extracts
  these results), and the stress in item <code>stress</code>. In addition,
  there is a large number of other items (but these may change without
  notice in the future releases).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p>Faith, D.P., Minchin, P.R and Belbin, L. 1987. Compositional
      dissimilarity as a robust measure of ecological
      distance. <em>Vegetatio</em> 69, 57--68.</p>
<p>Gower, J.C. (1966). Some distance properties of latent root and
      vector methods used in multivariate analysis. <em>Biometrika</em>
      53, 325--328.</p>
<p>Kruskal, J.B. 1964a. Multidimensional scaling by optimizing
      goodness-of-fit to a nonmetric hypothesis. <em>Psychometrika</em>
      29, 1--28.</p>
<p>Kruskal, J.B. 1964b. Nonmetric multidimensional scaling: a numerical
      method. <em>Psychometrika</em> 29, 115--129.</p>
<p>Minchin, P.R. 1987. An evaluation of relative robustness of
      techniques for ecological ordinations. <em>Vegetatio</em> 69,
      89--107.</p>
<p>Sibson, R. 1972. Order invariant methods for data
      analysis. <em>Journal of the Royal Statistical Society B</em> 34,
      311--349.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This is the default NMDS function used in
   <code><a href='metaMDS.html'>metaMDS</a></code>. Function <code><a href='metaMDS.html'>metaMDS</a></code> adds support
   functions so that NMDS can be run like recommended by Minchin
   (1987).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='metaMDS.html'>metaMDS</a></code> for the <span class="pkg">vegan</span> way of running NMDS,
  and <code><a href='https://rdrr.io/pkg/MASS/man/isoMDS.html'>isoMDS</a></code> and <a href='https://CRAN.R-project.org/package=smacof'><span class="pkg">smacof</span></a> for some
  alternative implementations of NMDS.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dune</span>)
<span class='no'>dis</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='vegdist.html'>vegdist</a></span>(<span class='no'>dune</span>)
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'>monoMDS</span>(<span class='no'>dis</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"loc"</span>)
<span class='no'>m</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; monoMDS(dist = dis, model = "loc") 
#&gt; 
#&gt; Local non-metric Multidimensional Scaling
#&gt; 
#&gt; 20 points, dissimilarity ‘bray’, call ‘vegdist(x = dune)’
#&gt; 
#&gt; Dimensions: 2 
#&gt; Stress:     0.1233732 
#&gt; Stress type 1, weak ties
#&gt; Scores scaled to unit root mean square, rotated to principal components
#&gt; Stopped after 69 iterations: Stress nearly unchanged (ratio &gt; sratmax)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>m</span>)</div><div class='img'><img src='monoMDS-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#convergence-criteria">Convergence Criteria</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Peter R. Michin (Fortran core) and Jari Oksanen (R interface).</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


