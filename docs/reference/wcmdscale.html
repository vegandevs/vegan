<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Weighted Classical (Metric) Multidimensional Scaling — wcmdscale • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weighted Classical (Metric) Multidimensional Scaling — wcmdscale"><meta name="description" content="Weighted classical multidimensional scaling,
  also known as weighted principal coordinates analysis."><meta property="og:description" content="Weighted classical multidimensional scaling,
  also known as weighted principal coordinates analysis."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Weighted Classical (Metric) Multidimensional Scaling</h1>

      <div class="d-none name"><code>wcmdscale.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Weighted classical multidimensional scaling,
  also known as weighted <em>principal coordinates analysis</em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wcmdscale</span><span class="op">(</span><span class="va">d</span>, <span class="va">k</span>, eig <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, x.ret <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">w</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'wcmdscale'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, display <span class="op">=</span> <span class="st">"sites"</span>, type <span class="op">=</span> <span class="st">"t"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'wcmdscale'</span></span>
<span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">x</span>, choices <span class="op">=</span> <span class="cn">NA</span>, display <span class="op">=</span> <span class="st">"sites"</span>, tidy <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>a distance structure such as that returned by <code>dist</code>
    or a full symmetric matrix containing the dissimilarities.</p></dd>

  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the dimension of the space which the data are to be
    represented in; must be in \(\{1,2,\ldots,n-1\}\).
    If missing, all dimensions with above zero eigenvalue.</p></dd>

  <dt id="arg-eig">eig<a class="anchor" aria-label="anchor" href="#arg-eig"></a></dt>
<dd><p>indicates whether eigenvalues should be returned.</p></dd>

  <dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>an additive constant \(c\) is added to the non-diagonal
    dissimilarities such that all \(n-1\) eigenvalues are
    non-negative. Alternatives are <code>"lingoes"</code> (default, also
    used with <code>TRUE</code>) and <code>"cailliez"</code> (which is the only
    alternative in <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>). See Legendre &amp; Anderson
    (1999).</p></dd>

  <dt id="arg-x-ret">x.ret<a class="anchor" aria-label="anchor" href="#arg-x-ret"></a></dt>
<dd><p>indicates whether the doubly centred symmetric distance
    matrix should be returned.</p></dd>

  <dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>Weights of points.</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The <code>wcmdscale</code> result object when the function was
    called with options <code>eig = TRUE</code> or <code>x.ret = TRUE</code> (See
    Details).</p></dd>

  <dt id="arg-choices">choices<a class="anchor" aria-label="anchor" href="#arg-choices"></a></dt>
<dd><p>Axes to be returned; <code>NA</code> returns all real axes.</p></dd>

  <dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>Kind of scores. Normally only <code>"sites"</code> are
    available, but <code>"species"</code> can be supplemented with
    <code><a href="sppscores.html">sppscores</a></code>.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Type of graph which may be <code>"t"</code>ext, <code>"p"</code>oints
    or <code>"n"</code>one.</p></dd>

  <dt id="arg-tidy">tidy<a class="anchor" aria-label="anchor" href="#arg-tidy"></a></dt>
<dd><p>Return scores that are compatible with <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><span class="pkg">ggplot2</span></a>:
    scores are in a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>, score type is in the
    variable <code>score</code> labelled as <code>"sites"</code>, weights in
    variable <code>weigth</code>, and names in variable <code>label</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to graphical functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function <code>wcmdscale</code> is based on function
  <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code> (package <span class="pkg">stats</span> of base <span style="R">R</span>), but it uses
  point weights. Points with high weights will have a stronger
  influence on the result than those with low weights. Setting equal
  weights <code>w = 1</code> will give ordinary multidimensional scaling.</p>
<p>With default options, the function returns only a matrix of scores
  scaled by eigenvalues for all real axes. If the function is called
  with <code>eig = TRUE</code> or <code>x.ret = TRUE</code>, the function returns
  an object of class <code>"wcmdscale"</code> with <code>print</code>,
  <code>plot</code>, <code>scores</code>, <code><a href="eigenvals.html">eigenvals</a></code> and
  <code><a href="goodness.metaMDS.html">stressplot</a></code> methods, and described in section Value.</p>
<p>The method is Euclidean, and with non-Euclidean dissimilarities some
  eigenvalues can be negative. If this disturbs you, this can be
  avoided by adding a constant to non-diagonal dissimilarities making
  all eigenvalues non-negative. The function implements methods
  discussed by Legendre &amp; Anderson (1999): The method of Lingoes
  (<code>add="lingoes"</code>) adds the constant \(c\) to squared
  dissimilarities \(d\) using \(\sqrt{d^2 + 2 c}\)
  and the method of Cailliez (<code>add="cailliez"</code>) to
  dissimilarities using \(d + c\). Legendre &amp; Anderson (1999)
  recommend the method of Lingoes, and base <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code> implements the method of Cailliez.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>eig = FALSE</code> and <code>x.ret = FALSE</code> (default), a
  matrix with <code>k</code> columns whose rows give the coordinates of
  points corresponding to positive eigenvalues.  Otherwise, an object
  of class <code>wcmdscale</code> containing the components that are mostly
  similar as in <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>:</p>
<p></p>
<dl><dt>points</dt>
<dd><p>a matrix with <code>k</code> columns whose rows give the
    coordinates of the points chosen to represent the
    dissimilarities.</p></dd>

  <dt>eig</dt>
<dd><p>the \(n-1\) eigenvalues computed during the scaling
    process if <code>eig</code> is true.</p></dd>

  <dt>x</dt>
<dd><p>the doubly centred and weighted distance matrix if
    <code>x.ret</code> is true.</p></dd>

  <dt>ac, add</dt>
<dd><p>additive constant and adjustment method used to avoid
    negative eigenvalues. These are <code>NA</code> and <code>FALSE</code> if no
    adjustment was done.</p></dd>

  <dt>GOF</dt>
<dd><p>Goodness of fit statistics for <code>k</code> axes. The first
    value is based on the sum of absolute values of all eigenvalues,
    and the second value is based on the sum of positive eigenvalues</p></dd>

  <dt>weights</dt>
<dd><p>Weights.</p></dd>

  <dt>negaxes</dt>
<dd><p>A matrix of scores for axes with negative eigenvalues
     scaled by the absolute eigenvalues similarly as
     <code>points</code>. This is <code>NULL</code> if there are no negative
     eigenvalues or <code>k</code> was specified, and would not include
     negative eigenvalues.</p></dd>

  <dt>call</dt>
<dd><p>Function call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gower, J. C. (1966)
  Some distance properties of latent root and vector
  methods used in multivariate analysis.
  <em>Biometrika</em> <b>53</b>, 325–328.</p>
<p>Legendre, P. &amp; Anderson, M. J. (1999). Distance-based redundancy
    analysis: testing multispecies responses in multifactorial
    ecological experiments. <em>Ecology</em> <b>69</b>, 1–24.</p>
<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979).  Chapter 14 of
  <em>Multivariate Analysis</em>, London: Academic Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The function is modelled after <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>, but adds
  weights (hence name) and handles negative eigenvalues differently.
  <code><a href="eigenvals.html">eigenvals.wcmdscale</a></code> and
  <code><a href="stressplot.wcmdscale.html">stressplot.wcmdscale</a></code> are some specific methods. Species
  scores can be added to the result with <code><a href="sppscores.html">sppscores</a></code>. Other
  multidimensional scaling methods are <code><a href="monoMDS.html">monoMDS</a></code>, and
  <code><a href="https://rdrr.io/pkg/MASS/man/isoMDS.html" class="external-link">isoMDS</a></code> and <code><a href="https://rdrr.io/pkg/MASS/man/sammon.html" class="external-link">sammon</a></code> in package
  <span class="pkg">MASS</span>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Correspondence analysis as a weighted principal coordinates</span></span></span>
<span class="r-in"><span><span class="co">## analysis of Euclidean distances of Chi-square transformed data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="decostand.html">decostand</a></span><span class="op">(</span><span class="va">dune</span>, <span class="st">"chi"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu">wcmdscale</span><span class="op">(</span><span class="va">d</span>, w <span class="op">=</span> <span class="va">rs</span>, eig <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Ordinary CA</span></span></span>
<span class="r-in"><span><span class="va">ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_BEGIN</span></span></span>
<span class="r-in"><span><span class="co">## Eigevalues are numerically similar</span></span></span>
<span class="r-in"><span><span class="va">ca</span><span class="op">$</span><span class="va">CA</span><span class="op">$</span><span class="va">eig</span> <span class="op">-</span> <span class="va">ord</span><span class="op">$</span><span class="va">eig</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           CA1           CA2           CA3           CA4           CA5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.551115e-16 -1.609823e-15 -7.216450e-16  8.326673e-17 -5.551115e-17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           CA6           CA7           CA8           CA9          CA10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.163336e-17 -1.387779e-16 -1.942890e-16  1.249001e-16  1.387779e-17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          CA11          CA12          CA13          CA14          CA15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.110223e-16  6.245005e-17  4.857226e-17 -1.734723e-17  1.734723e-18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          CA16          CA17          CA18          CA19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.469447e-18 -6.938894e-18  0.000000e+00  4.553649e-17 </span>
<span class="r-in"><span><span class="co">## Configurations are similar when site scores are scaled by</span></span></span>
<span class="r-in"><span><span class="co">## eigenvalues in CA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="procrustes.html">procrustes</a></span><span class="op">(</span><span class="va">ord</span>, <span class="va">ca</span>, choices<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span>, scaling <span class="op">=</span> <span class="st">"sites"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> procrustes(X = ord, Y = ca, choices = 1:19, scaling = "sites") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procrustes sum of squares:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.263e-14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_END</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="procrustes.html">procrustes</a></span><span class="op">(</span><span class="va">ord</span>, <span class="va">ca</span>, choices<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, scaling<span class="op">=</span><span class="st">"sites"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="wcmdscale-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Reconstruction of non-Euclidean distances with negative eigenvalues</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu">wcmdscale</span><span class="op">(</span><span class="va">d</span>, eig <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Only positive eigenvalues:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">ord</span><span class="op">$</span><span class="va">points</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9975185</span>
<span class="r-in"><span><span class="co">## Correction with negative eigenvalues:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">ord</span><span class="op">$</span><span class="va">points</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">ord</span><span class="op">$</span><span class="va">negaxes</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

