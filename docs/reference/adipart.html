<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Additive Diversity Partitioning and Hierarchical Null Model Testing — adipart • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Additive Diversity Partitioning and Hierarchical Null Model Testing — adipart"><meta name="description" content="In additive diversity partitioning, mean values of alpha diversity at lower levels of a sampling
hierarchy are compared to the total diversity in the entire data set (gamma diversity).
In hierarchical null model testing, a statistic returned by a function is evaluated
according to a nested hierarchical sampling design (hiersimu)."><meta property="og:description" content="In additive diversity partitioning, mean values of alpha diversity at lower levels of a sampling
hierarchy are compared to the total diversity in the entire data set (gamma diversity).
In hierarchical null model testing, a statistic returned by a function is evaluated
according to a nested hierarchical sampling design (hiersimu)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Additive Diversity Partitioning and Hierarchical Null Model Testing</h1>

      <div class="d-none name"><code>adipart.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In additive diversity partitioning, mean values of alpha diversity at lower levels of a sampling
hierarchy are compared to the total diversity in the entire data set (gamma diversity).
In hierarchical null model testing, a statistic returned by a function is evaluated
according to a nested hierarchical sampling design (<code>hiersimu</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">adipart</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">adipart</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"shannon"</span>, <span class="st">"simpson"</span><span class="op">)</span>,</span>
<span>    weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unif"</span>, <span class="st">"prop"</span><span class="op">)</span>, relative <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">adipart</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"shannon"</span>, <span class="st">"simpson"</span><span class="op">)</span>,</span>
<span>    weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unif"</span>, <span class="st">"prop"</span><span class="op">)</span>, relative <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hiersimu</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">hiersimu</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, <span class="va">FUN</span>, location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span><span class="op">)</span>,</span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span>, drop.highest <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">hiersimu</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">FUN</span>, location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span><span class="op">)</span>,</span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span>, drop.highest <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A community matrix.</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A matrix with same number of rows as in <code>y</code>, columns
    coding the levels of sampling hierarchy. The number of groups within
    the hierarchy must decrease from left to right. If <code>x</code> is missing,
    function performs an overall decomposition into alpha, beta and
    gamma diversities.</p></dd>


  <dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A two sided model formula in the form <code>y ~ x</code>,
    where <code>y</code> is the community data matrix with samples as rows and
    species as column. Right hand side (<code>x</code>) must be grouping variables
    referring to levels of sampling hierarchy, terms from right to left
    will be treated as nested (first column is the lowest, last is the
    highest level). The formula will add a unique indentifier to rows and
    constant for the rows to always produce estimates of row-level alpha
    and overall gamma diversities. You must use non-formula
    interface to avoid this behaviour. Interaction terms are
    not allowed.</p></dd>


  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame where to look for variables defined in the
    right hand side of <code>formula</code>. If missing, variables are looked
    in the global environment.</p></dd>


  <dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>Character, the diversity index to be calculated (see Details).</p></dd>


  <dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Character, <code>"unif"</code> for uniform weights,
    <code>"prop"</code> for weighting proportional to sample abundances to use
    in weighted averaging of individual alpha values within strata of a
    given level of the sampling hierarchy.</p></dd>


  <dt id="arg-relative">relative<a class="anchor" aria-label="anchor" href="#arg-relative"></a></dt>
<dd><p>Logical, if <code>TRUE</code> then alpha and beta diversity
    values are given relative to the value of gamma for function
    <code>adipart</code>.</p></dd>


  <dt id="arg-nsimul">nsimul<a class="anchor" aria-label="anchor" href="#arg-nsimul"></a></dt>
<dd><p>Number of permutations to use.  If <code>nsimul = 0</code>,
    only the <code>FUN</code> argument is evaluated.
    It is thus possible to reuse the statistic values
    without a null model.</p></dd>


  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Null model method: either a name (character string) of
    a method defined in <code><a href="commsim.html">make.commsim</a></code> or a
    <code><a href="commsim.html">commsim</a></code> function.
    The default <code>"r2dtable"</code> keeps row sums and column sums fixed.
    See <code><a href="oecosimu.html">oecosimu</a></code> for Details and Examples.</p></dd>


  <dt id="arg-fun">FUN<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>A function to be used by <code>hiersimu</code>. This must be
    fully specified, because currently other arguments cannot be passed
    to this function via <code>...</code>.</p></dd>


  <dt id="arg-location">location<a class="anchor" aria-label="anchor" href="#arg-location"></a></dt>
<dd><p>Character, identifies which function (mean or median)
    is to be used to calculate location of the samples.</p></dd>


  <dt id="arg-drop-highest">drop.highest<a class="anchor" aria-label="anchor" href="#arg-drop-highest"></a></dt>
<dd><p>Logical, to drop the highest level or not. When
    <code>FUN</code> evaluates only arrays with at least 2 dimensions, highest
    level should be dropped, or not selected at all.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to functions, e.g. base of
    logarithm for Shannon diversity, or <code>method</code>, <code>thin</code> or
    <code>burnin</code> arguments for <code><a href="oecosimu.html">oecosimu</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Additive diversity partitioning means that mean alpha and beta
  diversities add up to gamma diversity, thus beta diversity is measured
  in the same dimensions as alpha and gamma (Lande 1996). This additive
  procedure is then extended across multiple scales in a hierarchical
  sampling design with \(i = 1, 2, 3, \ldots, m\) levels of sampling
  (Crist et al. 2003). Samples in lower hierarchical levels are nested
  within higher level units, thus from \(i=1\) to \(i=m\) grain size
  is increasing under constant survey extent. At each level \(i\),
  \(\alpha_i\) denotes average diversity found within samples.</p>
<p>At the highest sampling level, the diversity components are calculated
  as $$\beta_m  = \gamma -  \alpha_m$$ For
  each  lower   sampling  level   as  $$\beta_i  =   \alpha_{i+1}  -
  \alpha_i$$ Then,  the additive partition
  of diversity is $$\gamma  = \alpha_1 + \sum_{i=1}^m \beta_i$$</p>
<p>Average alpha components can be weighted uniformly
  (<code>weight="unif"</code>) to calculate it as simple average, or
  proportionally to sample abundances (<code>weight="prop"</code>) to
  calculate it as weighted average as follows $$\alpha_i =
  \sum_{j=1}^{n_i} D_{ij} w_{ij}$$ where
  \(D_{ij}\) is the diversity index and \(w_{ij}\) is the weight
  calculated for the \(j\)th sample at the \(i\)th sampling level.</p>
<p>The implementation of additive diversity partitioning in
  <code>adipart</code> follows Crist et al. 2003. It is based on species
  richness (\(S\), not \(S-1\)), Shannon's and Simpson's diversity
  indices stated as the <code>index</code> argument.</p>
<p>The expected diversity components are calculated <code>nsimul</code> times
  by individual based randomisation of the community data matrix. This
  is done by the <code>"r2dtable"</code> method in <code><a href="oecosimu.html">oecosimu</a></code> by
  default.</p>
<p><code>hiersimu</code> works almost in the same way as <code>adipart</code>, but
  without comparing the actual statistic values returned by <code>FUN</code>
  to the highest possible value (cf. gamma diversity).  This is so,
  because in most of the cases, it is difficult to ensure additive
  properties of the mean statistic values along the hierarchy.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<p>An object of class <code>"adipart"</code> or <code>"hiersimu"</code> with same
  structure as <code><a href="oecosimu.html">oecosimu</a></code> objects.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Crist,   T.O.,   Veech,    J.A.,   Gering,   J.C.   and   Summerville,
  K.S.  (2003).  Partitioning species  diversity  across landscapes  and
  regions:  a hierarchical  analysis of  \(\alpha\),  \(\beta\), and
  \(\gamma\)-diversity.  <em>Am. Nat.</em>, <b>162</b>, 734–743.</p>
<p>Lande, R.  (1996). Statistics and partitioning of species diversity,
  and similarity among multiple communities.  <em>Oikos</em>, <b>76</b>,
  5–13.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>


<p>Péter Sólymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="oecosimu.html">oecosimu</a></code> for permutation settings and
  calculating \(p\)-values. <code><a href="multipart.html">multipart</a></code> for multiplicative
  diversity partitioning.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## NOTE: 'nsimul' argument usually needs to be &gt;= 99</span></span></span>
<span class="r-in"><span><span class="co">## here much lower value is used for demonstration</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Function to get equal area partitions of the mite data</span></span></span>
<span class="r-in"><span><span class="va">cutter</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">cut</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cut</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">out</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">cut</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">cut</span><span class="op">[</span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">## The hierarchy of sample aggregation</span></span></span>
<span class="r-in"><span><span class="va">levsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mite.xy</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    l1<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    l2<span class="op">=</span><span class="fu">cutter</span><span class="op">(</span><span class="va">y</span>, cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    l3<span class="op">=</span><span class="fu">cutter</span><span class="op">(</span><span class="va">y</span>, cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    l4<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Let's see in a map</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mite.xy</span>, main<span class="op">=</span><span class="st">"l1"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">levsm</span><span class="op">$</span><span class="va">l1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mite.xy</span>, main<span class="op">=</span><span class="st">"l2"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">levsm</span><span class="op">$</span><span class="va">l2</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mite.xy</span>, main<span class="op">=</span><span class="st">"l3"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">levsm</span><span class="op">$</span><span class="va">l3</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="adipart-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Additive diversity partitioning</span></span></span>
<span class="r-in"><span><span class="fu">adipart</span><span class="op">(</span><span class="va">mite</span>, index<span class="op">=</span><span class="st">"richness"</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adipart object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: adipart(y = mite, index = "richness", nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> options:  index richness, weights unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES   mean   2.5%    50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.1    15.114 -28.979 22.393 21.978 22.429 22.765     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma      35.000   0.000 35.000 35.000 35.000 35.000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.1     19.886  28.979 12.607 12.235 12.571 13.022     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## the next two define identical models</span></span></span>
<span class="r-in"><span><span class="fu">adipart</span><span class="op">(</span><span class="va">mite</span>, <span class="va">levsm</span>, index<span class="op">=</span><span class="st">"richness"</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adipart object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: adipart(y = mite, x = levsm, index = "richness", nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> options:  index richness, weights unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic      SES     mean     2.5%      50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.1    15.114 -54.1889 22.35038 22.10429 22.37143 22.584     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.2    29.750 -25.1503 34.81579 34.50000 34.75000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.3    33.000   0.0000 35.00000 35.00000 35.00000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma      35.000   0.0000 35.00000 35.00000 35.00000 35.000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.1     14.636   9.9124 12.46541 12.10000 12.45000 12.779     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.2      3.250  15.2208  0.18421  0.00000  0.25000  0.500     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.3      2.000   0.0000  0.00000  0.00000  0.00000  0.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="fu">adipart</span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span> <span class="va">l2</span> <span class="op">+</span> <span class="va">l3</span>, <span class="va">levsm</span>, index<span class="op">=</span><span class="st">"richness"</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adipart object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: adipart(formula = mite ~ l2 + l3, data = levsm, index =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "richness", nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> options:  index richness, weights unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES      mean      2.5%       50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.1    15.114 -51.771 22.378947 22.100714 22.400000 22.587     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.2    29.750 -25.578 34.736842 34.500000 34.750000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.3    33.000 -17.206 34.973684 34.725000 35.000000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma      35.000   0.000 35.000000 35.000000 35.000000 35.000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.1     14.636  11.165 12.357895 12.025714 12.428571 12.686     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.2      3.250  15.455  0.236842  0.000000  0.250000  0.500     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.3      2.000  17.206  0.026316  0.000000  0.000000  0.275     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## Hierarchical null model testing</span></span></span>
<span class="r-in"><span><span class="co">## diversity analysis (similar to adipart)</span></span></span>
<span class="r-in"><span><span class="fu">hiersimu</span><span class="op">(</span><span class="va">mite</span>, FUN<span class="op">=</span><span class="va">diversity</span>, relative<span class="op">=</span><span class="cn">TRUE</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hiersimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: hiersimu(y = mite, FUN = diversity, relative = TRUE, nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES    mean    2.5%     50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> level_1   0.76064 -52.201 0.93892 0.93378 0.93866 0.9444     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leve_2    1.00000   0.000 1.00000 1.00000 1.00000 1.0000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="fu">hiersimu</span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span> <span class="va">l2</span> <span class="op">+</span> <span class="va">l3</span>, <span class="va">levsm</span>, FUN<span class="op">=</span><span class="va">diversity</span>, relative<span class="op">=</span><span class="cn">TRUE</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hiersimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: hiersimu(formula = mite ~ l2 + l3, data = levsm, FUN = diversity,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> relative = TRUE, nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      statistic      SES    mean    2.5%     50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unit   0.76064  -60.783 0.93927 0.93425 0.93883 0.9435     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l2     0.89736 -116.072 0.99795 0.99617 0.99808 0.9991     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l3     0.92791 -421.205 0.99932 0.99902 0.99935 0.9995     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> all    1.00000    0.000 1.00000 1.00000 1.00000 1.0000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## Hierarchical testing with the Morisita index</span></span></span>
<span class="r-in"><span><span class="va">morfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="dispindmorisita.html">dispindmorisita</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">imst</span></span></span>
<span class="r-in"><span><span class="fu">hiersimu</span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span><span class="va">.</span>, <span class="va">levsm</span>, <span class="va">morfun</span>, drop.highest<span class="op">=</span><span class="cn">TRUE</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hiersimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: hiersimu(formula = mite ~ ., data = levsm, FUN = morfun,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drop.highest = TRUE, nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    statistic     SES     mean     2.5%      50%   97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l1   0.52070  6.4968  0.35648  0.31140  0.35449  0.3978     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l2   0.60234 12.5142  0.15359  0.08900  0.14525  0.2039     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l3   0.67509 17.6125 -0.19189 -0.26300 -0.20619 -0.1149     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

