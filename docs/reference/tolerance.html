<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Species tolerances and sample heterogeneities — tolerance • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Species tolerances and sample heterogeneities — tolerance"><meta name="description" content="Species tolerances and sample heterogeneities."><meta property="og:description" content="Species tolerances and sample heterogeneities."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Species tolerances and sample heterogeneities</h1>

      <div class="d-none name"><code>tolerance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Species tolerances and sample heterogeneities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tolerance</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu">tolerance</span><span class="op">(</span><span class="va">x</span>, choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>,<span class="st">"sites"</span><span class="op">)</span>,</span>
<span>          scaling <span class="op">=</span> <span class="st">"species"</span>, useN2 <span class="op">=</span> <span class="cn">TRUE</span>, hill <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'decorana'</span></span>
<span><span class="fu">tolerance</span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span>, choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>          which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sites"</span>, <span class="st">"species"</span><span class="op">)</span>, useN2 <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function to compute species tolerances and site heterogeneity measures
  from unimodal ordinations (CCA &amp; CA). Implements Eq 6.47 and 6.48 from
  the Canoco 4.5 Reference Manual (pages 178–179).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Matrix of tolerances/heterogeneities with some additional
  attributes: <code>which</code>, <code>scaling</code>, and <code>N2</code>, the latter of
  which will be <code>NA</code> if <code>useN2 = FALSE</code> or <code>N2</code> could not
  be estimated.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gavin L. Simpson and Jari Oksanen (<code>decorana</code> method).</p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>object of class <code>"cca"</code>.</p></dd>

  <dt id="arg-choices">choices<a class="anchor" aria-label="anchor" href="#arg-choices"></a></dt>
<dd><p>numeric; which ordination axes to compute
    tolerances and heterogeneities for. Defaults to axes 1 and 2.</p></dd>

  <dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>character; one of <code>"species"</code> or <code>"sites"</code>,
    indicating whether species tolerances or sample heterogeneities
    respectively are computed.</p></dd>

  <dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>character or numeric; the ordination scaling to
    use. See <code><a href="plot.cca.html">scores.cca</a></code> for details.</p></dd>

  <dt id="arg-hill">hill<a class="anchor" aria-label="anchor" href="#arg-hill"></a></dt>
<dd><p>logical; if <code>scaling</code> is a character,
    these control whether Hill's scaling is used for (C)CA
    respectively. See <code><a href="plot.cca.html">scores.cca</a></code> for details.</p></dd>

  <dt id="arg-usen-">useN2<a class="anchor" aria-label="anchor" href="#arg-usen-"></a></dt>
<dd><p>logical; should the bias in the tolerances /
    heterogeneities be reduced via scaling by Hill's N2?</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Original input data used in <code><a href="decorana.html">decorana</a></code>.  If
    missing, the function tries to get the same data as used in
    <code>decorana</code> call.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed to other methods.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## defaults to species tolerances</span></span></span>
<span class="r-in"><span><span class="fu">tolerance</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species Tolerance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scaling: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                CCA1      CCA2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Achimill 0.32968099 0.9241988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Agrostol 0.93670069 0.9238455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Airaprae 1.04694096 0.5889849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alopgeni 0.72227472 0.3760138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Anthodor 1.00596787 0.8338212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bellpere 0.32891011 0.9962790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bromhord 0.27740999 0.6236199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chenalbu 0.00000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cirsarve 0.00000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comapalu 0.47185632 0.8029414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eleopalu 0.50344134 0.9384960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elymrepe 0.35119963 0.5642491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empenigr 0.00000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hyporadi 1.05840696 0.7523003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Juncarti 0.78397702 1.0686743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Juncbufo 0.69275956 0.6180830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lolipere 0.51006235 0.8278177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Planlanc 0.36040676 0.6962294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poaprat  0.58184277 0.9547104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poatriv  0.78695928 0.7433503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ranuflam 0.56576326 1.1725628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rumeacet 0.58715663 0.8751491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sagiproc 0.70922180 1.1153129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Salirepe 0.98530179 0.1077917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scorautu 1.04355761 1.0724439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trifprat 0.03045846 0.3651949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trifrepe 1.21543364 0.9115613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vicilath 0.24853962 0.6194084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bracruta 1.03787313 1.0958331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Callcusp 0.57882025 1.0418623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sample heterogeneities for CCA axes 1:6</span></span></span>
<span class="r-in"><span><span class="fu">tolerance</span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="st">"sites"</span>, choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Heterogeneity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scaling: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CCA1      CCA2      CCA3      CCA4      CCA5      CCA6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.2350112 0.8611530 1.7964571 0.4445499 2.4235732 0.5496289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.7100754 0.4136311 0.8151643 0.6311751 1.0467901 0.2514646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.5076492 0.7279717 0.8306874 0.5590739 0.3904998 0.9162012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.5955037 0.6901907 0.7931255 0.4873638 0.3966068 0.8700581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.6001048 0.5614830 1.1481560 0.3569604 0.4423909 1.9420043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.7272637 0.6867342 1.6068628 0.7778498 0.9187843 0.4938865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.6478967 0.4993262 0.7207318 0.3817131 0.4130713 0.7228173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.8563491 0.5498552 0.4217718 0.3370226 0.3013276 0.9535190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.5599722 0.7399384 0.4170304 1.0535541 1.4612437 0.7626183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.5210280 0.5806978 0.5856634 0.4174860 1.8559344 0.8890262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.4489323 0.6016877 0.3317371 1.8780211 1.2965939 2.1953737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.4948094 1.1084494 0.5226746 1.5064446 0.5703077 1.1561020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.6998985 0.8859365 0.4215474 0.8582272 0.5673698 0.5186678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1.5925779 0.6747926 0.8927360 1.6798300 0.3480218 0.1575892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 1.0107648 0.5294221 1.0975629 1.7632888 0.2240900 0.3727240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0.8031479 0.6058313 0.4871527 0.4227451 0.5341256 0.6990815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.5936276 1.5142792 0.5137979 1.0224938 1.7931775 0.6261853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0.5689409 1.4067575 0.6398557 0.4983399 0.4364791 0.6590394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 1.1330387 0.9816332 1.1242398 0.7238920 0.5577662 0.7036044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0.6737757 1.4458326 1.4380928 1.0959027 0.4142423 0.5332460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## average should be 1 with scaling = "sites", hill = TRUE</span></span></span>
<span class="r-in"><span><span class="va">tol</span> <span class="op">&lt;-</span> <span class="fu">tolerance</span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="st">"sites"</span>, scaling <span class="op">=</span> <span class="st">"sites"</span>, hill <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">tol</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CCA1     CCA2     CCA3     CCA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.059199 1.048823 1.000551 1.077612 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tol</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      CCA1      CCA2      CCA3      CCA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3174462 0.2793521 0.3714540 0.2681931 </span>
<span class="r-in"><span><span class="co">## Rescaling tries to set all tolerances to 1</span></span></span>
<span class="r-in"><span><span class="va">tol</span> <span class="op">&lt;-</span> <span class="fu">tolerance</span><span class="op">(</span><span class="fu"><a href="decorana.html">decorana</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">tol</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      DCA1      DCA2      DCA3      DCA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9817657 0.9249544 0.9444811 0.9821666 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tol</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      DCA1      DCA2      DCA3      DCA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1977777 0.3204058 0.2646872 0.1210543 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

