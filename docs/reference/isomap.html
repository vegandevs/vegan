<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Isometric Feature Mapping Ordination — isomap • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Isometric Feature Mapping Ordination — isomap"><meta name="description" content="The function performs isometric feature mapping which consists of
  three simple steps: (1) retain only some of the shortest
  dissimilarities among objects, (2) estimate all dissimilarities as
  shortest path distances, and (3) perform metric scaling (Tenenbaum et
  al. 2000)."><meta property="og:description" content="The function performs isometric feature mapping which consists of
  three simple steps: (1) retain only some of the shortest
  dissimilarities among objects, (2) estimate all dissimilarities as
  shortest path distances, and (3) perform metric scaling (Tenenbaum et
  al. 2000)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Isometric Feature Mapping Ordination</h1>

      <div class="d-none name"><code>isomap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function performs isometric feature mapping which consists of
  three simple steps: (1) retain only some of the shortest
  dissimilarities among objects, (2) estimate all dissimilarities as
  shortest path distances, and (3) perform metric scaling (Tenenbaum et
  al. 2000).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">isomap</span><span class="op">(</span><span class="va">dist</span>, ndim<span class="op">=</span><span class="fl">10</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">isomapdist</span><span class="op">(</span><span class="va">dist</span>, <span class="va">epsilon</span>, <span class="va">k</span>, path <span class="op">=</span> <span class="st">"shortest"</span>, fragmentedOK <span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'isomap'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'isomap'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, net <span class="op">=</span> <span class="cn">TRUE</span>, n.col <span class="op">=</span> <span class="st">"gray"</span>, type <span class="op">=</span> <span class="st">"points"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>Dissimilarities.</p></dd>

  <dt id="arg-ndim">ndim<a class="anchor" aria-label="anchor" href="#arg-ndim"></a></dt>
<dd><p>Number of axes in metric scaling (argument <code>k</code> in
   <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>).</p></dd>

  <dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>Shortest dissimilarity retained.</p></dd>

  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Number of shortest dissimilarities retained for a point. If
   both <code>epsilon</code> and <code>k</code> are given, <code>epsilon</code> will be used.</p></dd>

  <dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Method used in <code><a href="stepacross.html">stepacross</a></code> to estimate the
    shortest path, with alternatives <code>"shortest"</code> and <code>"extended"</code>.</p></dd>

  <dt id="arg-fragmentedok">fragmentedOK<a class="anchor" aria-label="anchor" href="#arg-fragmentedok"></a></dt>
<dd><p>What to do if dissimilarity matrix is
    fragmented. If <code>TRUE</code>, analyse the largest connected group,
    otherwise stop with error.</p></dd>

  <dt id="arg-x-object">x, object<a class="anchor" aria-label="anchor" href="#arg-x-object"></a></dt>
<dd><p>An <code>isomap</code> result object.</p></dd>

  <dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p>Draw the net of retained dissimilarities.</p></dd>

  <dt id="arg-n-col">n.col<a class="anchor" aria-label="anchor" href="#arg-n-col"></a></dt>
<dd><p>Colour of drawn net segments. This can also be a vector
    that is recycled for points, and the colour of the net segment is
    a mixture of joined points.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Plot observations either as <code>"points"</code>,
    <code>"text"</code> or use <code>"none"</code> to plot no observations. The
    <code>"text"</code> will use <code><a href="ordilabel.html">ordilabel</a></code> if <code>net = TRUE</code>
    and <code><a href="ordiplot.html">ordiplot</a></code> if <code>net = FALSE</code>, and pass
    extra arguments to these functions.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters passed to functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function <code>isomap</code> first calls function <code>isomapdist</code> for
  dissimilarity transformation, and then performs metric scaling for the
  result. All arguments to <code>isomap</code> are passed to
  <code>isomapdist</code>. The functions are separate so that the
  <code>isompadist</code> transformation could be easily used with other
  functions than simple linear mapping of <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>.</p>
<p>Function <code>isomapdist</code> retains either dissimilarities equal or shorter to
  <code>epsilon</code>, or if <code>epsilon</code> is not given, at least <code>k</code>
  shortest dissimilarities for a point.  Then a complete dissimilarity
  matrix is reconstructed using <code><a href="stepacross.html">stepacross</a></code> using either
  flexible shortest paths or extended dissimilarities (for details, see
  <code><a href="stepacross.html">stepacross</a></code>).</p>
<p>De'ath (1999) actually published essentially the same method before
  Tenenbaum et al. (2000), and De'ath's function is available in function
  <code>xdiss</code> in non-CRAN package <span class="pkg">mvpart</span>. The differences are that
  <code>isomap</code> introduced the <code>k</code> criterion, whereas De'ath only
  used <code>epsilon</code> criterion.  In practice, De'ath also retains
  higher proportion of dissimilarities than typical <code>isomap</code>.</p>
<p>The <code>plot</code> function uses internally <code><a href="ordiplot.html">ordiplot</a></code>,
  except that it adds text over net using <code><a href="ordilabel.html">ordilabel</a></code>. The
  <code>plot</code> function passes extra arguments to these functions.  In
  addition, <span class="pkg">vegan3d</span> package has function
  <code>rgl.isomap</code> to make dynamic 3D plots that can
  be rotated on the screen.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>isomapdist</code> returns a dissimilarity object similar to
  <code>dist</code>. Function <code>isomap</code> returns an object of class
  <code>isomap</code> with <code>plot</code> and <code>summary</code> methods. The
  <code>plot</code> function returns invisibly an object of class
  <code><a href="ordiplot.html">ordiplot</a></code>. Function <code><a href="scores.html">scores</a></code> can extract
  the ordination scores.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>De'ath, G. (1999)  Extended dissimilarity: a method of robust
     estimation of ecological distances from high beta diversity data.
     <em>Plant Ecology</em> 144, 191–199</p>
<p>Tenenbaum, J.B., de Silva, V. &amp; Langford, J.C. (2000) A global
     network framework for nonlinear dimensionality
     reduction. <em>Science</em> 290, 2319–2323.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Tenenbaum et al. (2000) justify <code>isomap</code> as a tool of unfolding a
  manifold (e.g. a 'Swiss Roll'). Even with a manifold structure, the
  sampling must be even and dense so
  that dissimilarities along a manifold are shorter than across the
  folds. If data do not have such a manifold structure, the results are
  very sensitive to parameter values.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The underlying functions that do the proper work are
  <code><a href="stepacross.html">stepacross</a></code>, <code><a href="distconnected.html">distconnected</a></code> and
  <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>.  Function <code><a href="metaMDS.html">metaMDS</a></code> may trigger
  <code><a href="stepacross.html">stepacross</a></code> transformation, but usually only for
  longest dissimilarities.  The <code>plot</code> method of <span class="pkg">vegan</span>
  minimum spanning tree function (<code><a href="spantree.html">spantree</a></code>) has even
  more extreme way of isomapping things.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## The following examples also overlay minimum spanning tree to</span></span></span>
<span class="r-in"><span><span class="co">## the graphics in red.</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">0.2</span>, mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="spantree.html">spantree</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="ordiplot.html">ordiplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"cmdscale"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> species scores not available</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tr</span>, <span class="va">pl</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu">isomap</span><span class="op">(</span><span class="va">dis</span>, k<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Isometric Feature Mapping (isomap)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> isomap(dist = dis, k = 3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distance method: bray shortest isomap </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Criterion: k = 3 </span>
<span class="r-in"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord</span>, main<span class="op">=</span><span class="st">"isomap k=3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tr</span>, <span class="va">pl</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">isomap</span><span class="op">(</span><span class="va">dis</span>, k<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"isomap k=5"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tr</span>, <span class="va">pl</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">isomap</span><span class="op">(</span><span class="va">dis</span>, epsilon<span class="op">=</span><span class="fl">0.45</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"isomap epsilon=0.45"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tr</span>, <span class="va">pl</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="isomap-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## colour points and web by the dominant species</span></span></span>
<span class="r-in"><span><span class="va">dom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">BCI</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## need nine colours, but default palette  has only eight</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="st">"default"</span><span class="op">)</span>, <span class="st">"sienna"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="va">dom</span>, n.col <span class="op">=</span> <span class="va">dom</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="isomap-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

