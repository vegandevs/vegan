<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add New Points to NMDS ordination — MDSaddpoints • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add New Points to NMDS ordination — MDSaddpoints"><meta name="description" content="Add new points to an existing metaMDS or
  monoMDS ordination."><meta property="og:description" content="Add new points to an existing metaMDS or
  monoMDS ordination."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add New Points to NMDS ordination</h1>

      <div class="d-none name"><code>MDSaddpoints.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add new points to an existing <code><a href="metaMDS.html">metaMDS</a></code> or
  <code><a href="monoMDS.html">monoMDS</a></code> ordination.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MDSaddpoints</span><span class="op">(</span><span class="va">nmds</span>, <span class="va">dis</span>, neighbours <span class="op">=</span> <span class="fl">5</span>, maxit <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dist2xy</span><span class="op">(</span><span class="va">dist</span>, <span class="va">pick</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xy"</span>, <span class="st">"xx"</span><span class="op">)</span>, invert <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>



<dl><dt id="arg-nmds">nmds<a class="anchor" aria-label="anchor" href="#arg-nmds"></a></dt>
<dd><p>Result object from <code><a href="metaMDS.html">metaMDS</a></code> or
  <code><a href="monoMDS.html">monoMDS</a></code>. The configuration of points is fixed,
  but new points are added.</p></dd>


<dt id="arg-dis">dis<a class="anchor" aria-label="anchor" href="#arg-dis"></a></dt>
<dd><p>Rectangular non-symmetric dissimilarity matrix among new
  points (rows) and old fixed points (columns). Such matrix can be
  extracted from complete dissimilarities of both old and new points
  with <code>dist2xy</code>, or calculated with <code><a href="designdist.html">designdist2</a></code>.</p></dd>


<dt id="arg-neighbours">neighbours<a class="anchor" aria-label="anchor" href="#arg-neighbours"></a></dt>
<dd><p>Number of nearest points used to get the starting
  locations for new points.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>Maximum number of iterations.</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>Input dissimilarities.</p></dd>


<dt id="arg-pick">pick<a class="anchor" aria-label="anchor" href="#arg-pick"></a></dt>
<dd><p>Indices (integers) of selected observations or a logical
  vector that is <code>TRUE</code> for picked items. The output will be
  in the original order and will not be reordered by this argument.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>"xy"</code> returns rectangular data of picked against
  not picked observations, and <code>"xx"</code> a subset of symmetric
  dissimilarities.</p></dd>


<dt id="arg-invert">invert<a class="anchor" aria-label="anchor" href="#arg-invert"></a></dt>
<dd><p>Invert <code>pick</code>: drop elements listed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function return a list of class <code>"nmds"</code> (there are no other
objects of that type in <span class="pkg">vegan</span>) with following elements</p>
<p></p>
<dl><dt>points</dt>
<dd><p>Coordinates of added new points</p></dd>

  <dt>seeds</dt>
<dd><p>Starting coordinates for new points.</p></dd>

  <dt>deltastress</dt>
<dd><p>Change of stress with added points.</p></dd>

  <dt>iters</dt>
<dd><p>Number of iterations.</p></dd>

  <dt>cause</dt>
<dd><p>Cause of termination of iterations. Integer for
    convergence criteria in <code><a href="monoMDS.html">monoMDS</a></code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Function provides an interface to <code>monoMDS</code> Fortran code to add new
points to an existing ordination that will be regarded as fixed. The
function has a similar role as <code>predict</code> functions with
<code>newdata</code> in Euclidean ordination (e.g. <code><a href="predict.cca.html">predict.cca</a></code>).
Input data must be a rectangular matrix of distances among new added
points (rows) and all fixed old points (columns). Such matrices can be
extracted from complete dissimilarities with helper function
<code>dist2xy</code>. Function <code><a href="designdist.html">designdist2</a></code> can directly
calculate such rectangular dissimilarity matrices between sampling units
(rows) in two matries. In addition, <a href="https://CRAN.R-project.org/package=analogue" class="external-link"><span class="pkg">analogue</span></a> has distance
function that can calculate dissimilarities among two matrices,
including functions that cannot be specified in
<code><a href="designdist.html">designdist2</a></code>.</p>
<p>Great care is needed in preparing the dissimilarities for the
input. The dissimilarity index must be exactly the same as in the
fixed ordination, and columns must match old fixed points, and rows
added new points.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Cross-validation: remove a point when performing NMDS and add as</span></span></span>
<span class="r-in"><span><span class="co">## a new points</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## remove point 3 from ordination</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="fu">dist2xy</span><span class="op">(</span><span class="va">d</span>, <span class="fl">3</span>, <span class="st">"xx"</span>, invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## add point 3 to the result</span></span></span>
<span class="r-in"><span><span class="fu">MDSaddpoints</span><span class="op">(</span><span class="va">mod3</span>, <span class="fu">dist2xy</span><span class="op">(</span><span class="va">d</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $points</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          MDS1       MDS2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.09726881 -0.4560917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $seed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.01222493 -0.4353716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $deltastress</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001811377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cause</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "nmds"</span>
<span class="r-in"><span><span class="co">## Use designdist2</span></span></span>
<span class="r-in"><span><span class="va">d15</span> <span class="op">&lt;-</span> <span class="fu"><a href="designdist.html">designdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m15</span> <span class="op">&lt;-</span> <span class="fu"><a href="metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">d15</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">MDSaddpoints</span><span class="op">(</span><span class="va">m15</span>, <span class="fu"><a href="designdist.html">designdist2</a></span><span class="op">(</span><span class="va">dune</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span>, <span class="va">dune</span><span class="op">[</span><span class="fl">16</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $points</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          MDS1       MDS2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  0.4296366 -0.3068902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 -0.4122463  0.4118309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 -0.1135994  0.3120708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  0.1421922  0.4869128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  0.5892538  0.1751219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $seed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.2832566 0.019571976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.1920994 0.137270818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.1529998 0.094374124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.0244597 0.137988191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.3212258 0.009941098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $deltastress</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03394768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cause</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "nmds"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

