<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>K-means partitioning using a range of values of K — cascadeKM • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="K-means partitioning using a range of values of K — cascadeKM"><meta name="description" content="This function is a wrapper for the kmeans function. It creates
 several partitions forming a cascade from a small to a large number of
 groups."><meta property="og:description" content="This function is a wrapper for the kmeans function. It creates
 several partitions forming a cascade from a small to a large number of
 groups."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>K-means partitioning using a range of values of K</h1>

      <div class="d-none name"><code>cascadeKM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a wrapper for the <code>kmeans</code> function. It creates
 several partitions forming a cascade from a small to a large number of
 groups.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cascadeKM</span><span class="op">(</span><span class="va">data</span>, <span class="va">inf.gr</span>, <span class="va">sup.gr</span>, iter <span class="op">=</span> <span class="fl">100</span>, criterion <span class="op">=</span> <span class="st">"calinski"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cIndexKM</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, index <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cascadeKM'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">min.g</span>, <span class="va">max.g</span>, grpmts.plot <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>     sortg <span class="op">=</span> <span class="cn">FALSE</span>, gridcol <span class="op">=</span> <span class="cn">NA</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg--data-"> data <a class="anchor" aria-label="anchor" href="#arg--data-"></a></dt>
<dd><p>The data matrix. The objects (samples) are the rows.</p></dd>

  <dt id="arg--inf-gr-"> inf.gr <a class="anchor" aria-label="anchor" href="#arg--inf-gr-"></a></dt>
<dd><p>The number of groups for the partition with the
    smallest number of groups of the cascade (min).</p></dd>

  <dt id="arg--sup-gr-"> sup.gr <a class="anchor" aria-label="anchor" href="#arg--sup-gr-"></a></dt>
<dd><p>The number of groups for the partition with the largest 	
    number of groups of the cascade (max).</p></dd>

  <dt id="arg--iter-"> iter <a class="anchor" aria-label="anchor" href="#arg--iter-"></a></dt>
<dd><p>The number of random starting configurations for each value
    of \(K\).</p></dd>

  <dt id="arg--criterion-"> criterion <a class="anchor" aria-label="anchor" href="#arg--criterion-"></a></dt>
<dd><p>The criterion that will be used to select the best
    partition. The default value is <code>"calinski"</code>, which refers to
    the Calinski-Harabasz (1974) criterion. The simple structure index
    (<code>"ssi"</code>) is also available. Other indices are available in
    package <span class="pkg">cclust</span>. In
    our experience, the two indices that work best and are most likely
    to return their maximum value at or near the optimal number of
    clusters are <code>"calinski"</code> and <code>"ssi"</code>.</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Object of class <code>"kmeans"</code> returned by a clustering algorithm
    such as <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code></p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Data matrix where columns correspond to variables and rows to
    observations, or the plotting object in <code>plot</code></p></dd>

  <dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>The available indices are: <code>"calinski"</code> and <code>"ssi"</code>.
    Type <code>"all"</code> to obtain both indices.
    Abbreviations of these names are also accepted.</p></dd>

  <dt id="arg-min-g-max-g">min.g, max.g<a class="anchor" aria-label="anchor" href="#arg-min-g-max-g"></a></dt>
<dd><p>The minimum and maximum numbers of groups to be
    displayed.</p></dd>

  <dt id="arg-grpmts-plot">grpmts.plot<a class="anchor" aria-label="anchor" href="#arg-grpmts-plot"></a></dt>
<dd><p>Show the plot (<code>TRUE</code> or <code>FALSE</code>).</p></dd>

  <dt id="arg-sortg">sortg<a class="anchor" aria-label="anchor" href="#arg-sortg"></a></dt>
<dd><p>Sort the objects as a function of their group membership
    to produce a more easily interpretable graph. See Details. The
    original object names are kept; they are used as labels in the
    output table <code>x</code>, although not in the graph.  If there were no
    row names, sequential row numbers are used to keep track of the
    original order of the objects.</p></dd>

  <dt id="arg-gridcol">gridcol<a class="anchor" aria-label="anchor" href="#arg-gridcol"></a></dt>
<dd><p>The colour of the grid lines in the plots. <code>NA</code>,
    which is the default value, removes the grid lines.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters to the functions (ignored).</p></dd>

  <dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function creates several partitions forming a cascade from a small
  to a large number of groups formed by <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code>.  Most
  of the work is performed by function <code>cIndex</code> which is based on the
  <code>clustIndex</code> in package <span class="pkg">cclust</span>).
  Some of the criteria were removed from this version because computation
  errors were generated when only one object was found in a group.</p>
<p>The default value is <code>"calinski"</code>, which refers to the well-known
  Calinski-Harabasz (1974) criterion. The other available index is the
  simple structure index <code>"ssi"</code> (Dolnicar et al. 1999).
  In the case of groups of equal
  sizes, <code>"calinski"</code> is generally a good criterion to indicate the
  correct number of groups. Users should not take its indications
  literally when the groups are not equal in size. Type <code>"all"</code> to
  obtain  both indices. The indices are defined as:</p><dl><dt>calinski:</dt>
<dd><p>\((SSB/(K-1))/(SSW/(n-K))\), where \(n\) is the
    number of data points and \(K\) is the number of clusters.
    \(SSW\) is the sum of squares within the clusters while
    \(SSB\) is the sum of squares among the clusters. This index
    is simply an \(F\) (ANOVA) statistic.</p></dd>


    <dt>ssi:</dt>
<dd><p>the “Simple Structure Index” multiplicatively combines
    several elements which influence the interpretability of a
    partitioning solution. The best partition is indicated by the
    highest SSI value.</p></dd>


</dl><p>In a simulation study, Milligan and Cooper (1985) found
  that the Calinski-Harabasz criterion recovered the correct number of
  groups the most often. We recommend this criterion because, if the
  groups are of equal sizes, the maximum value of <code>"calinski"</code>
  usually indicates the correct number of groups. Another available
  index is the simple structure index <code>"ssi"</code>. Users should not
  take the indications of these indices literally when the groups are
  not equal in size and explore the groups corresponding to other values
  of \(K\).</p>
<p>Function <code>cascadeKM</code> has a <code>plot</code> method.  Two plots are
  produced. The graph on the left has the objects in
  abscissa and the number of groups in ordinate. The groups are
  represented by colours. The graph on the right shows the values of the
  criterion (<code>"calinski"</code> or <code>"ssi"</code>) for determining the best
  partition. The highest value of the criterion is marked in red. Points
  marked in orange, if any, indicate partitions producing an increase in
  the criterion value as the number of groups increases; they may
  represent other interesting partitions.</p>
<p>If <code>sortg=TRUE</code>, the objects are reordered by the following
  procedure: (1) a simple matching distance matrix is computed among the
  objects, based on the table of K-means assignments to groups, from
  \(K\) = <code>min.g</code> to \(K\) = <code>max.g</code>. (2) A principal
  coordinate analysis (PCoA, Gower 1966) is computed on the centred
  distance matrix. (3) The first principal coordinate is used as the new
  order of the objects in the graph. A simplified algorithm is used to
  compute the first principal coordinate only, using the iterative
  algorithm described in Legendre &amp; Legendre (2012). The
  full distance matrix among objects is never computed; this avoids
  the problem of storing it when the number of objects is
  large. Distance values are computed as they are needed by the
  algorithm.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>cascadeKM</code> returns an object of class
  <code>cascadeKM</code> with items:</p>
<dl><dt> partition </dt>
<dd><p>Table with the partitions found for different numbers
    of groups \(K\), from \(K\) = <code>inf.gr</code> to \(K\) =
    <code>sup.gr</code>.</p></dd>

  <dt> results </dt>
<dd><p>Values of the criterion to select the best
    partition.</p></dd>

  <dt> criterion </dt>
<dd><p>The name of the criterion used.</p></dd>

  <dt> size </dt>
<dd><p>The number of objects found in each group, for all
    partitions (columns).</p></dd>


</dl><p>Function <code>cIndex</code> returns a vector with the index values. The
  maximum value of these indices is supposed to indicate the best
  partition. These indices work best with groups of equal sizes. When
  the groups are not of equal sizes, one should not put too much faith
  in the maximum of these indices, and also explore the groups
  corresponding to other values of \(K\).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Calinski, T. and J. Harabasz. 1974. A dendrite method for cluster
  analysis. <em>Commun. Stat.</em> <strong>3</strong>: 1–27.</p>
<p>Dolnicar, S., K. Grabler and J. A. Mazanec. 1999.  A tale of three
  cities: perceptual charting for analyzing destination images. Pp.
  39-62 in: Woodside, A. et al. [eds.] <em>Consumer psychology of
  tourism, hospitality and leisure</em>. CAB International, New York.</p>

<p>Gower, J. C. 1966. Some distance properties of latent root and vector
  methods used in multivariate analysis. <em>Biometrika</em> <strong>53</strong>:
  325–338.</p>
<p>Legendre, P. &amp; L. Legendre. 2012. <em>Numerical ecology</em>, 3rd
  English edition. Elsevier Science BV, Amsterdam.</p>
<p>Milligan, G. W. &amp; M. C. Cooper. 1985. An examination of procedures for
  determining the number of clusters in a data set. <em>Psychometrika</em>
  <strong>50</strong>: 159–179.</p>
<p>Weingessel, A., Dimitriadou, A. and Dolnicar, S. 2002. An examination
  of indexes for determining the number of clusters in binary data
  sets. <em>Psychometrika</em> <strong>67</strong>: 137–160.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Helene Ouellette
  <a href="mailto:Marie-Helene.Ouellette@UMontreal.ca">Marie-Helene.Ouellette@UMontreal.ca</a>, Sebastien Durand
  <a href="mailto:Sebastien.Durand@UMontreal.ca">Sebastien.Durand@UMontreal.ca</a> and Pierre Legendre
  <a href="mailto:Pierre.Legendre@UMontreal.ca">Pierre.Legendre@UMontreal.ca</a>. Parallel processing by Virgilio
  Gómez-Rubio.  Edited for <span class="pkg">vegan</span> by Jari Oksanen.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="co"># Partitioning a (10 x 10) data matrix of random numbers</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">cascadeKM</span><span class="op">(</span><span class="va">mat</span>, <span class="fl">2</span>, <span class="fl">5</span>, iter <span class="op">=</span> <span class="fl">25</span>, criterion <span class="op">=</span> <span class="st">'calinski'</span><span class="op">)</span> </span></span>
<span class="r-in"><span> <span class="va">toto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cascadeKM-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># Partitioning an autocorrelated time series</span></span></span>
<span class="r-in"><span> <span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>,<span class="fl">30</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">cascadeKM</span><span class="op">(</span><span class="va">vec</span>, <span class="fl">2</span>, <span class="fl">5</span>, iter <span class="op">=</span> <span class="fl">25</span>, criterion <span class="op">=</span> <span class="st">'calinski'</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">toto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cascadeKM-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># Partitioning a large autocorrelated time series</span></span></span>
<span class="r-in"><span> <span class="co"># Note that we remove the grid lines</span></span></span>
<span class="r-in"><span> <span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,<span class="fl">1000</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">cascadeKM</span><span class="op">(</span><span class="va">vec</span>, <span class="fl">2</span>, <span class="fl">7</span>, iter <span class="op">=</span> <span class="fl">10</span>, criterion <span class="op">=</span> <span class="st">'calinski'</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">toto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, gridcol<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cascadeKM-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

