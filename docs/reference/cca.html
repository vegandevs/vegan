<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function cca performs correspondence analysis, or optionally
  constrained correspondence analysis (a.k.a. canonical correspondence
  analysis), or optionally partial constrained correspondence
  analysis. Function rda performs redundancy analysis, or
  optionally principal components analysis.
  These are all very popular ordination techniques in community ecology."><title>[Partial] [Constrained] Correspondence Analysis and Redundancy Analysis — cca • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="[Partial] [Constrained] Correspondence Analysis and Redundancy Analysis — cca"><meta property="og:description" content="Function cca performs correspondence analysis, or optionally
  constrained correspondence analysis (a.k.a. canonical correspondence
  analysis), or optionally partial constrained correspondence
  analysis. Function rda performs redundancy analysis, or
  optionally principal components analysis.
  These are all very popular ordination techniques in community ecology."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>[Partial] [Constrained] Correspondence Analysis and Redundancy Analysis</h1>
      
      <div class="d-none name"><code>cca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function <code>cca</code> performs correspondence analysis, or optionally
  constrained correspondence analysis (a.k.a. canonical correspondence
  analysis), or optionally partial constrained correspondence
  analysis. Function <code>rda</code> performs redundancy analysis, or
  optionally principal components analysis.
  These are all very popular ordination techniques in community ecology.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">cca</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, na.action <span class="op">=</span> <span class="va">na.fail</span>, subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">rda</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, scale<span class="op">=</span><span class="cn">FALSE</span>, na.action <span class="op">=</span> <span class="va">na.fail</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">cca</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">Z</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">rda</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">Z</span>, scale<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">ca</span><span class="op">(</span><span class="va">X</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">pca</span><span class="op">(</span><span class="va">X</span>, scale<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Model formula, where the left hand side gives the
    community data matrix, right hand side gives the constraining variables,
    and conditioning variables can be given within a special function
    <code>Condition</code>.</p></dd>

  <dt>data</dt>
<dd><p>Data frame containing the variables on the right hand side
    of the model formula.</p></dd>

  <dt>X</dt>
<dd><p>Community data matrix.</p></dd>

  <dt>Y</dt>
<dd><p>Constraining matrix, typically of environmental variables.
    Can be missing. If this is a <code>data.frame</code>, it will be
    expanded to a <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></code> where factors are
    expanded to contrasts (“dummy variables”). It is better to
    use <code>formula</code> instead of this argument, and some further
    analyses only work when <code>formula</code> was used.</p></dd>

  <dt>Z</dt>
<dd><p>Conditioning matrix, the effect of which is removed
    (“partialled out”) before next step. Can be missing. If this is a
    <code>data.frame</code>, it is expanded similarly as constraining
    matrix.</p></dd>

<dt>scale</dt>
<dd><p>Scale species to unit variance (like correlations).</p></dd>

  <dt>na.action</dt>
<dd><p>Handling of missing values in constraints or
    conditions. The default (<code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code>) is to stop with
    missing value. Choice <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code> removes all rows with
    missing values. Choice <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code> keeps all
    observations but gives <code>NA</code> for results that cannot be
    calculated. The WA scores of rows may be found also for missing
    values in constraints. Missing values are never allowed in
    dependent community data.</p></dd>

  <dt>subset</dt>
<dd><p>Subset of data rows. This can be a logical vector which
    is <code>TRUE</code> for kept observations, or a logical expression which
    can contain variables in the working environment, <code>data</code> or
    species names of the community data.</p></dd>

  <dt>...</dt>
<dd><p>Other arguments for <code>print</code> or <code>plot</code> functions
    (ignored in other functions). For <code>pca()</code> and <code>ca()</code>,
    arguments are passed to <code>rda()</code> and <code>cca()</code>, respectively.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Since their introduction (ter Braak 1986), constrained, or canonical,
  correspondence analysis and its spin-off, redundancy analysis, have
  been the most popular ordination methods in community ecology.
  Functions <code>cca</code> and <code>rda</code> are  similar to popular
  proprietary software <code>Canoco</code>, although the implementation is
  completely different.  The functions are based on Legendre &amp;
  Legendre's (2012) algorithm: in <code>cca</code>
  Chi-square transformed data matrix is subjected to weighted linear
  regression on constraining variables, and the fitted values are
  submitted to correspondence analysis performed via singular value
  decomposition (<code><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></code>). Function <code>rda</code> is similar, but uses
  ordinary, unweighted linear regression and unweighted SVD. Legendre &amp;
  Legendre (2012), Table 11.5 (p. 650) give a skeleton of the RDA
  algorithm of <span class="pkg">vegan</span>. The algorithm of CCA is similar, but
  involves standardization by row and column weights.</p>
<p>The functions <code>cca()</code> and <code>rda()</code> can be called either with
  matrix-like entries for community data and constraints, or with formula
  interface.  In general, the formula interface is preferred, because it
  allows a better control of the model and allows factor constraints. Some
  analyses of ordination results are only possible if model was fitted
  with formula (e.g., most cases of <code><a href="anova.cca.html">anova.cca</a></code>, automatic
  model building).</p>
<p>In the following sections, <code>X</code>, <code>Y</code> and <code>Z</code>, although
  referred to as matrices, are more commonly data frames.</p>
<p>In the matrix interface, the
  community data matrix <code>X</code> must be given, but the other data
  matrices may be omitted, and the corresponding stage of analysis is
  skipped.  If matrix <code>Z</code> is supplied, its effects are removed from
  the community matrix, and the residual matrix is submitted to the next
  stage.  This is called partial correspondence or redundancy
  analysis.  If matrix
  <code>Y</code> is supplied, it is used to constrain the ordination,
  resulting in constrained or canonical correspondence analysis, or
  redundancy analysis.
  Finally, the residual is submitted to ordinary correspondence
  analysis (or principal components analysis).  If both matrices
  <code>Z</code> and <code>Y</code> are missing, the
  data matrix is analysed by ordinary correspondence analysis (or
  principal components analysis).</p>
<p>Instead of separate matrices, the model can be defined using a model
  <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>.  The left hand side must be the
  community data matrix (<code>X</code>).  The right hand side defines the
  constraining model.
  The constraints can contain ordered or unordered factors,
  interactions among variables and functions of variables.  The defined
  <code><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></code> are honoured in <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></code>
  variables.  The constraints can also be matrices (but not data
  frames).
  The formula can include a special term <code>Condition</code>
  for conditioning variables (“covariables”) partialled out before
  analysis.  So the following commands are equivalent:
  <code>cca(X, Y, Z)</code>,  <code>cca(X ~ Y + Condition(Z))</code>, where <code>Y</code>
  and <code>Z</code> refer to constraints and conditions matrices respectively.</p>
<p>Constrained correspondence analysis is indeed a constrained method:
  CCA does not try to display all variation in the
  data, but only the part that can be explained by the used constraints.
  Consequently, the results are strongly dependent on the set of
  constraints and their transformations or interactions among the
  constraints.  The shotgun method is to use all environmental variables
  as constraints.  However, such exploratory problems are better
  analysed with
  unconstrained methods such as correspondence analysis
  (<code><a href="decorana.html">decorana</a></code>, <code><a href="https://rdrr.io/pkg/MASS/man/corresp.html" class="external-link">corresp</a></code>) or non-metric
  multidimensional scaling (<code><a href="metaMDS.html">metaMDS</a></code>) and
  environmental interpretation after analysis
  (<code><a href="envfit.html">envfit</a></code>, <code><a href="ordisurf.html">ordisurf</a></code>).
  CCA is a good choice if the user has
  clear and strong <em>a priori</em> hypotheses on constraints and is not
  interested in the major structure in the data set.</p>
<p>CCA is able to correct the curve artefact commonly found in
  correspondence analysis by forcing the configuration into linear
  constraints.  However, the curve artefact can be avoided only with a
  low number of constraints that do not have a curvilinear relation with
  each other.  The curve can reappear even with two badly chosen
  constraints or a single factor.  Although the formula interface makes it
  easy to include polynomial or interaction terms, such terms often
  produce curved artefacts (that are difficult to interpret), these
  should probably be avoided.</p>
<p>According to folklore, <code>rda</code> should be used with ``short
  gradients'' rather than <code>cca</code>. However, this is not based
  on research which finds methods based on Euclidean metric as uniformly
  weaker than those based on Chi-squared metric.  However, standardized
  Euclidean distance may be an appropriate measures (see Hellinger
  standardization in <code><a href="decostand.html">decostand</a></code> in particular).</p>  
<p>Partial CCA (pCCA; or alternatively partial RDA) can be used to remove
  the effect of some
  conditioning or background or random variables or
  covariables before CCA proper.  In fact, pCCA compares models
  <code>cca(X ~ Z)</code> and <code>cca(X ~ Y + Z)</code> and attributes their
  difference to the effect of <code>Y</code> cleansed of the effect of
  <code>Z</code>.  Some people have used the method for extracting
  “components of variance” in CCA.  However, if the effect of
  variables together is stronger than sum of both separately, this can
  increase total Chi-square after partialling out some
  variation, and give negative “components of variance”.  In general,
  such components of “variance” are not to be trusted due to
  interactions between two sets of variables.</p>
<p>The unconstrained ordination methods, Principal Components Analysis (PCA) and
  Correspondence Analysis (CA), may be performed using <code>pca()</code> and
  <code>ca()</code>, which are simple wrappers around <code>rda()</code> and <code>cca()</code>,
  respectively. Functions <code>pca()</code> and <code>ca</code> can only be called with
  matrix-like objects.</p>  
<p>The functions have <code>summary</code> and <code>plot</code> methods which are
  documented separately (see <code><a href="plot.cca.html">plot.cca</a></code>, <code><a href="plot.cca.html">summary.cca</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Function <code>cca</code> returns a huge object of class <code>cca</code>, which
  is described separately in <code><a href="cca.object.html">cca.object</a></code>.</p>


<p>Function <code>rda</code> returns an object of class <code>rda</code> which
  inherits from class <code>cca</code> and is described in <code><a href="cca.object.html">cca.object</a></code>.
  The scaling used in <code>rda</code> scores is described in a separate
  vignette with this package.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>The original method was by ter Braak, but the current
  implementation follows Legendre and Legendre.</p>
<p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd English
  ed. Elsevier.</p>
<p>McCune, B. (1997) Influence of noisy environmental data on canonical
  correspondence analysis. <em>Ecology</em> <strong>78</strong>, 2617-2623.</p>  
<p>Palmer, M. W. (1993) Putting things in even better order: The
  advantages of canonical correspondence analysis.  <em>Ecology</em>
  <strong>74</strong>,2215-2230.</p>  
<p>Ter Braak, C. J. F. (1986) Canonical Correspondence Analysis: a new
  eigenvector technique for multivariate direct gradient
  analysis. <em>Ecology</em> <strong>67</strong>, 1167-1179.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>The responsible author was Jari Oksanen, but the code borrows heavily
  from Dave Roberts (Montana State University, USA).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
  
<p>This help page describes two constrained ordination functions,
  <code>cca</code> and <code>rda</code> and their corresponding unconstrained
  ordination functions, <code>ca</code> and <code>pca</code>. A related method,
  distance-based redundancy analysis (dbRDA) is described separately
  (<code><a href="dbrda.html">capscale</a></code>), as is dbRDA's unconstrained variant,
  principal coordinates analysis (PCO). All these functions return
  similar objects (described in <code><a href="cca.object.html">cca.object</a></code>). There are
  numerous support functions that can be used to access the result object.
  In the list below, functions of type <code>cca</code> will handle all three
  constrained ordination objects, and functions of <code>rda</code> only handle
  <code>rda</code> and <code><a href="dbrda.html">capscale</a></code> results.</p>
<p>The main plotting functions are <code><a href="plot.cca.html">plot.cca</a></code> for all
  methods, and <code><a href="biplot.rda.html">biplot.rda</a></code> for RDA and dbRDA.  However,
  generic <span class="pkg">vegan</span> plotting functions can also handle the results.
  The scores can be accessed and scaled with <code><a href="plot.cca.html">scores.cca</a></code>,
  and summarized with <code><a href="plot.cca.html">summary.cca</a></code>. The eigenvalues can
  be accessed with <code><a href="eigenvals.html">eigenvals.cca</a></code> and the regression
  coefficients for constraints with <code><a href="predict.cca.html">coef.cca</a></code>.  The
  eigenvalues can be plotted with <code><a href="screeplot.cca.html">screeplot.cca</a></code>, and the
  (adjusted) \(R^2\) can be found with
  <code><a href="RsquareAdj.html">RsquareAdj.rda</a></code>. The scores can be also calculated for
  new data sets with <code><a href="predict.cca.html">predict.cca</a></code> which allows adding
  points to ordinations.  The values of constraints can be inferred
  from ordination and community composition with
  <code><a href="predict.cca.html">calibrate.cca</a></code>.</p>
<p>Diagnostic statistics can be found with <code><a href="goodness.cca.html">goodness.cca</a></code>,
  <code><a href="goodness.cca.html">inertcomp</a></code>, <code><a href="goodness.cca.html">spenvcor</a></code>,
  <code><a href="goodness.cca.html">intersetcor</a></code>, <code><a href="tolerance.html">tolerance.cca</a></code>, and
  <code><a href="goodness.cca.html">vif.cca</a></code>.  Function <code><a href="vegan-defunct.html">as.mlm.cca</a></code> refits the
  result object as a multiple <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> object, and this allows
  finding influence statistics (<code><a href="https://rdrr.io/r/stats/lm.influence.html" class="external-link">lm.influence</a></code>,
  <code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">cooks.distance</a></code> etc.).</p>  
<p>Permutation based significance for the overall model, single
  constraining variables or axes can be found with
  <code><a href="anova.cca.html">anova.cca</a></code>.  Automatic model building with <span style="R">R</span>
  <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> function is possible with
  <code><a href="deviance.cca.html">deviance.cca</a></code>, <code><a href="add1.cca.html">add1.cca</a></code> and
  <code><a href="add1.cca.html">drop1.cca</a></code>.  Functions <code><a href="ordistep.html">ordistep</a></code> and
  <code><a href="ordistep.html">ordiR2step</a></code> (for RDA) are special functions for
  constrained ordination. Randomized data sets can be generated with
  <code><a href="simulate.rda.html">simulate.cca</a></code>.</p>
<p>Separate methods based on constrained ordination model are principal
  response curves (<code><a href="prc.html">prc</a></code>) and variance partitioning between
  several components (<code><a href="varpart.html">varpart</a></code>).</p>
<p>Design decisions are explained in <code><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></code>
  on “Design decisions” which can be accessed with
  <code>browseVignettes("vegan")</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Common but bad way: use all variables you happen to have in your</span></span></span>
<span class="r-in"><span><span class="co">## environmental data matrix</span></span></span>
<span class="r-in"><span><span class="va">vare.cca</span> <span class="op">&lt;-</span> <span class="fu">cca</span><span class="op">(</span><span class="va">varespec</span>, <span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.cca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(X = varespec, Y = varechem)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.0832     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    1.4415     0.6920   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  0.6417     0.3080    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6   CCA7   CCA8   CCA9  CCA10  CCA11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4389 0.2918 0.1628 0.1421 0.1180 0.0890 0.0703 0.0584 0.0311 0.0133 0.0084 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CCA12  CCA13  CCA14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0065 0.0062 0.0047 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8     CA9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.19776 0.14193 0.10117 0.07079 0.05330 0.03330 0.01887 0.01510 0.00949 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vare.cca</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cca-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Formula interface and a better model</span></span></span>
<span class="r-in"><span><span class="va">vare.cca</span> <span class="op">&lt;-</span> <span class="fu">cca</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">Al</span> <span class="op">+</span> <span class="va">P</span><span class="op">*</span><span class="op">(</span><span class="va">K</span> <span class="op">+</span> <span class="va">Baresoil</span><span class="op">)</span>, data<span class="op">=</span><span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.cca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = varespec ~ Al + P * (K + Baresoil), data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varechem)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total           2.083      1.000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained     1.046      0.502    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained   1.038      0.498   17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3756 0.2342 0.1407 0.1323 0.1068 0.0561 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.27577 0.15411 0.13536 0.11803 0.08887 0.05511 0.04919 0.03781 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 17 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vare.cca</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cca-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Partialling out and negative components of variance</span></span></span>
<span class="r-in"><span><span class="fu">cca</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">Ca</span>, <span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = varespec ~ Ca, data = varechem)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         2.08320    1.00000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   0.15722    0.07547    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 1.92598    0.92453   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CCA1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.15722 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4745 0.2939 0.2140 0.1954 0.1748 0.1171 0.1121 0.0880 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 22 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">cca</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">Ca</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">pH</span><span class="op">)</span>, <span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = varespec ~ Ca + Condition(pH), data = varechem)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.0832     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    0.1458     0.0700    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.1827     0.0877    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  1.7547     0.8423   21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CCA1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.18269 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3834 0.2749 0.2123 0.1760 0.1701 0.1161 0.1089 0.0880 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 21 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## RDA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dune.Manure</span> <span class="op">&lt;-</span> <span class="fu">rda</span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">Manure</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dune.Manure</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="cca-3.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

