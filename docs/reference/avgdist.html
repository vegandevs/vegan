<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function computes the dissimilarity matrix of a dataset multiple
  times using vegdist while randomly subsampling the
  dataset each time. All of the subsampled iterations are then averaged
  (mean) to provide a distance matrix that represents the average of
  multiple subsampling iterations. This emulates the behavior of the
  distance matrix calculator within the Mothur microbial ecology toolkit."><title>Averaged Subsampled Dissimilarity Matrices — avgdist • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Averaged Subsampled Dissimilarity Matrices — avgdist"><meta property="og:description" content="The function computes the dissimilarity matrix of a dataset multiple
  times using vegdist while randomly subsampling the
  dataset each time. All of the subsampled iterations are then averaged
  (mean) to provide a distance matrix that represents the average of
  multiple subsampling iterations. This emulates the behavior of the
  distance matrix calculator within the Mothur microbial ecology toolkit."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Averaged Subsampled Dissimilarity Matrices</h1>
      
      <div class="d-none name"><code>avgdist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function computes the dissimilarity matrix of a dataset multiple
  times using <code><a href="vegdist.html">vegdist</a></code> while randomly subsampling the
  dataset each time. All of the subsampled iterations are then averaged
  (mean) to provide a distance matrix that represents the average of
  multiple subsampling iterations. This emulates the behavior of the
  distance matrix calculator within the Mothur microbial ecology toolkit.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">avgdist</span><span class="op">(</span><span class="va">x</span>, <span class="va">sample</span>, distfun <span class="op">=</span> <span class="va">vegdist</span>, meanfun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>    transf <span class="op">=</span> <span class="cn">NULL</span>, iterations <span class="op">=</span> <span class="fl">100</span>, dmethod <span class="op">=</span> <span class="st">"bray"</span>,</span>
<span>    diag <span class="op">=</span> <span class="cn">TRUE</span>, upper <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Community data matrix.</p></dd>

  <dt>sample</dt>
<dd><p>The subsampling depth to be used in each iteration. Samples that
  do not meet this threshold will be removed from the analysis, and their
  identity returned to the user in stdout.</p></dd>

  <dt>distfun</dt>
<dd><p>The dissimilarity matrix function to be used. Default is the
  vegan <code><a href="vegdist.html">vegdist</a></code></p></dd>

  <dt>meanfun</dt>
<dd><p>The calculation to use for the average (mean or median).</p></dd>

  <dt>transf</dt>
<dd><p>Option for transforming the count data before calculating the
  distance matrix. Any base transformation option can be used (e.g.
  <code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></code>)</p></dd>

  <dt>iterations</dt>
<dd><p>The number of random iterations to perform before averaging.
  Default is 100 iterations.</p></dd>

  <dt>dmethod</dt>
<dd><p>Dissimilarity index to be used with the specified dissimilarity
    matrix function. Default is Bray-Curtis</p></dd>

  <dt>diag, upper</dt>
<dd><p>Return dissimilarities with diagonal and upper
    triangle. NB. the default differs from <code><a href="vegdist.html">vegdist</a></code>
    and returns symmetric <code>"dist"</code> structure instead of lower
    diagonal. However, the object cannot be accessed with matrix
    indices unless cast to matrix with <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></code>.</p></dd>

  <dt>...</dt>
<dd><p>Any additional arguments to add to the distance function or
  mean/median function specified.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Geoffrey Hannigan, with some minor tweaks by Gavin L. Simpson.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    

<p>The function builds on the function <code><a href="rarefy.html">rrarefy</a></code> and and
  additional distance matrix function (e.g. <code><a href="vegdist.html">vegdist</a></code>) to
  add more meaningful representations of distances among randomly
  subsampled datasets by presenting the average of multiple random
  iterations. This function runs using the <code><a href="vegdist.html">vegdist</a></code>. This
  functionality has been utilized in the Mothur standalone microbial
  ecology toolkit <a href="https://mothur.org/wiki/Dist.shared" class="external-link">here</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>This function utilizes the <code><a href="vegdist.html">vegdist</a></code> and <code><a href="rarefy.html">rrarefy</a></code>
 functions.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Import an example count dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Test the base functionality</span></span></span>
<span class="r-in"><span><span class="va">mean.avg.dist</span> <span class="op">&lt;-</span> <span class="fu">avgdist</span><span class="op">(</span><span class="va">BCI</span>, sample <span class="op">=</span> <span class="fl">50</span>, iterations <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Test the transformation function</span></span></span>
<span class="r-in"><span><span class="va">mean.avg.dist.t</span> <span class="op">&lt;-</span> <span class="fu">avgdist</span><span class="op">(</span><span class="va">BCI</span>, sample <span class="op">=</span> <span class="fl">50</span>, iterations <span class="op">=</span> <span class="fl">10</span>, transf <span class="op">=</span> <span class="va">sqrt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Test the median functionality</span></span></span>
<span class="r-in"><span><span class="va">median.avg.dist</span> <span class="op">&lt;-</span> <span class="fu">avgdist</span><span class="op">(</span><span class="va">BCI</span>, sample <span class="op">=</span> <span class="fl">50</span>, iterations <span class="op">=</span> <span class="fl">10</span>, meanfun <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Print the resulting tables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mean.avg.dist</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1     2     3     4     5     6     7     8     9    10    11    12    13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.000 0.616 0.598 0.608 0.604 0.620 0.592 0.602 0.656 0.620 0.640 0.634 0.738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.616 0.000 0.568 0.568 0.612 0.582 0.546 0.580 0.582 0.580 0.600 0.598 0.666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.598 0.568 0.000 0.584 0.624 0.580 0.600 0.548 0.576 0.558 0.598 0.622 0.710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.608 0.568 0.584 0.000 0.624 0.632 0.616 0.606 0.622 0.568 0.632 0.620 0.726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.604 0.612 0.624 0.624 0.000 0.564 0.640 0.600 0.640 0.638 0.660 0.668 0.738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.620 0.582 0.580 0.632 0.564 0.000 0.574 0.566 0.580 0.640 0.610 0.594 0.720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      14    15    16    17    18    19    20    21    22    23    24    25    26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.612 0.614 0.618 0.616 0.732 0.654 0.632 0.630 0.660 0.722 0.614 0.652 0.638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.578 0.562 0.574 0.578 0.648 0.602 0.582 0.622 0.576 0.656 0.570 0.600 0.608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.596 0.556 0.584 0.594 0.722 0.632 0.600 0.628 0.638 0.724 0.628 0.624 0.662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.594 0.564 0.612 0.610 0.702 0.632 0.614 0.676 0.616 0.692 0.630 0.618 0.666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.634 0.610 0.640 0.694 0.746 0.700 0.644 0.658 0.694 0.716 0.634 0.658 0.680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.630 0.662 0.610 0.622 0.684 0.616 0.658 0.668 0.606 0.700 0.620 0.662 0.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      27    28    29    30    31    32    33    34    35    36    37    38    39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.666 0.652 0.678 0.676 0.688 0.664 0.666 0.716 0.770 0.664 0.682 0.696 0.690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.638 0.636 0.580 0.622 0.634 0.636 0.608 0.670 0.746 0.662 0.624 0.636 0.674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.662 0.658 0.644 0.644 0.644 0.672 0.666 0.694 0.788 0.648 0.626 0.686 0.712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.648 0.660 0.616 0.652 0.642 0.646 0.646 0.654 0.772 0.680 0.586 0.624 0.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.692 0.704 0.680 0.686 0.686 0.684 0.712 0.728 0.784 0.694 0.678 0.728 0.738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.682 0.644 0.632 0.690 0.674 0.672 0.672 0.708 0.802 0.692 0.670 0.678 0.712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      40    41    42    43    44    45    46    47    48    49    50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.728 0.668 0.644 0.682 0.680 0.720 0.666 0.646 0.672 0.662 0.668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.654 0.652 0.578 0.652 0.662 0.678 0.672 0.652 0.674 0.654 0.680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.726 0.684 0.624 0.628 0.666 0.662 0.712 0.706 0.722 0.674 0.676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.704 0.660 0.630 0.668 0.658 0.722 0.682 0.646 0.674 0.664 0.652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.754 0.702 0.648 0.692 0.672 0.664 0.756 0.706 0.732 0.688 0.694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.744 0.710 0.664 0.676 0.700 0.686 0.698 0.676 0.730 0.744 0.730</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mean.avg.dist.t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1         2         3         4         5         6         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.0000000 0.5300530 0.5584320 0.5666737 0.6073831 0.5584314 0.5502448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.5300530 0.0000000 0.5381078 0.5354913 0.5540186 0.5425557 0.5054810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.5584320 0.5381078 0.0000000 0.5484543 0.5533192 0.5487985 0.5729422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.5666737 0.5354913 0.5484543 0.0000000 0.5508077 0.5851000 0.6032487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6073831 0.5540186 0.5533192 0.5508077 0.0000000 0.5443404 0.6264156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.5584314 0.5425557 0.5487985 0.5851000 0.5443404 0.0000000 0.5118040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           8         9        10        11        12        13        14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.5624909 0.6157857 0.5822282 0.5860463 0.5868094 0.6973513 0.5828577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.5566536 0.5916807 0.5573945 0.5619809 0.5943633 0.6668768 0.5611759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.5152853 0.5710081 0.5183626 0.5793549 0.5982800 0.7186674 0.5897293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.5500741 0.6168823 0.5636751 0.5455477 0.5937027 0.6819189 0.5652502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.5848815 0.6286252 0.5697476 0.5979531 0.6331458 0.7214378 0.6223028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.5542616 0.6187788 0.6249347 0.5514451 0.5428569 0.6792039 0.5730759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          15        16        17        18        19        20        21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.5897454 0.5796920 0.6265348 0.7103707 0.5925648 0.5811204 0.5827718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.5646523 0.5682205 0.6027409 0.6637520 0.5707711 0.5752143 0.5701115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.5532421 0.6022293 0.6441255 0.7278229 0.6126432 0.5763380 0.5992610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6070801 0.5603400 0.6193648 0.6372678 0.6074943 0.5780863 0.6075794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.5835755 0.6069206 0.6779164 0.7070307 0.6426053 0.6129100 0.5918190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.6431727 0.5665280 0.5732339 0.6546974 0.6022923 0.6311714 0.6096782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          22        23        24        25        26        27        28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6255534 0.6645843 0.6178769 0.6035700 0.6124849 0.6053739 0.6316627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.5811133 0.6245120 0.5674873 0.5793377 0.5791172 0.6004880 0.5928815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.6502735 0.6930204 0.6316654 0.6099232 0.6365295 0.6149770 0.6262014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6083951 0.6357766 0.6096112 0.6027988 0.6345613 0.6106892 0.6027611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6620438 0.6780877 0.6321003 0.6171736 0.6061574 0.6411887 0.6507277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.5682571 0.6434720 0.6012413 0.6309653 0.6491993 0.5980805 0.6231630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          29        30        31        32        33        34        35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.5826512 0.6142129 0.6070439 0.6584040 0.6199809 0.6485226 0.7289200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.5676194 0.6103781 0.5905388 0.6067866 0.5900747 0.6573685 0.7009756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.5906626 0.6291382 0.6143700 0.6764264 0.6401458 0.6525194 0.7290139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.5683030 0.5955528 0.6094278 0.6193291 0.6179660 0.6642112 0.7076208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6478556 0.6446580 0.6306360 0.6382310 0.6447180 0.6965229 0.7447790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.5895692 0.6415220 0.6150639 0.6163457 0.6029147 0.6457973 0.7347169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          36        37        38        39        40        41        42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6410555 0.6093223 0.6627720 0.6652121 0.6547120 0.5998692 0.6150815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6132107 0.5895203 0.6159611 0.6703807 0.6576552 0.5798778 0.5688741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.6531601 0.6082285 0.6562149 0.6711570 0.6880909 0.6512405 0.6075625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6206586 0.6054571 0.6285220 0.6306951 0.6697524 0.5974400 0.5950629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6187556 0.6151722 0.6948125 0.7037854 0.7418464 0.6495825 0.5983360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.6667656 0.6229051 0.6349849 0.6632175 0.7049608 0.6435822 0.6379910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          43        44        45        46        47        48        49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6326441 0.5987190 0.6088616 0.6731516 0.6078267 0.6667146 0.6357711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.5839771 0.5980388 0.6255192 0.6572129 0.6161182 0.6380538 0.6305319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.6476774 0.6414912 0.6419036 0.6887952 0.6598609 0.7137977 0.7014771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6483498 0.6135142 0.6233985 0.6745854 0.6235621 0.6404104 0.6513642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6435636 0.6291256 0.6143847 0.7469464 0.6949349 0.6927103 0.6598872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.6514140 0.6208434 0.6613506 0.6950409 0.6586011 0.6625264 0.6926491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6125004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.5726523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.6543256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6222618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6241449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.6424624</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">median.avg.dist</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1    2    3    4    5    6    7    8    9   10   11   12   13   14   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.00 0.55 0.59 0.64 0.61 0.58 0.57 0.64 0.63 0.59 0.64 0.63 0.72 0.62 0.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.55 0.00 0.56 0.54 0.64 0.57 0.58 0.52 0.63 0.57 0.56 0.60 0.70 0.58 0.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.59 0.56 0.00 0.58 0.60 0.56 0.59 0.57 0.62 0.53 0.62 0.62 0.75 0.62 0.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.64 0.54 0.58 0.00 0.64 0.65 0.60 0.56 0.60 0.58 0.63 0.60 0.72 0.59 0.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.61 0.64 0.60 0.64 0.00 0.55 0.66 0.62 0.64 0.58 0.68 0.71 0.78 0.66 0.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.58 0.57 0.56 0.65 0.55 0.00 0.53 0.58 0.62 0.62 0.61 0.55 0.70 0.65 0.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     16   17   18   19   20   21   22   23   24   25   26   27   28   29   30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.61 0.67 0.72 0.62 0.62 0.61 0.67 0.71 0.64 0.68 0.62 0.69 0.66 0.65 0.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.56 0.58 0.64 0.55 0.57 0.60 0.63 0.65 0.56 0.63 0.61 0.62 0.59 0.60 0.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.60 0.68 0.76 0.62 0.60 0.62 0.66 0.71 0.60 0.66 0.63 0.68 0.66 0.62 0.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.66 0.66 0.70 0.58 0.63 0.65 0.62 0.65 0.60 0.62 0.63 0.63 0.61 0.62 0.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.66 0.74 0.79 0.70 0.64 0.65 0.74 0.75 0.69 0.75 0.68 0.71 0.74 0.74 0.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.60 0.65 0.71 0.64 0.60 0.61 0.64 0.68 0.61 0.72 0.62 0.65 0.61 0.66 0.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     31   32   33   34   35   36   37   38   39   40   41   42   43   44   45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.67 0.68 0.68 0.71 0.78 0.67 0.68 0.66 0.72 0.72 0.65 0.61 0.63 0.65 0.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.61 0.62 0.64 0.62 0.74 0.61 0.60 0.61 0.65 0.68 0.61 0.58 0.63 0.66 0.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.66 0.65 0.64 0.69 0.80 0.62 0.62 0.65 0.67 0.73 0.68 0.61 0.60 0.66 0.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.63 0.65 0.65 0.66 0.77 0.68 0.62 0.65 0.65 0.70 0.64 0.64 0.66 0.70 0.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.66 0.70 0.72 0.74 0.82 0.68 0.64 0.76 0.77 0.80 0.71 0.64 0.69 0.73 0.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.64 0.67 0.70 0.68 0.81 0.69 0.67 0.69 0.73 0.74 0.74 0.63 0.62 0.65 0.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     46   47   48   49   50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.69 0.65 0.66 0.64 0.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.65 0.62 0.63 0.69 0.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.72 0.71 0.72 0.72 0.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.71 0.68 0.71 0.70 0.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.80 0.73 0.71 0.72 0.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.71 0.65 0.73 0.70 0.67</span>
<span class="r-in"><span><span class="co"># Run example to illustrate low variance of mean, median, and stdev results</span></span></span>
<span class="r-in"><span><span class="co"># Mean and median std dev are around 0.05</span></span></span>
<span class="r-in"><span><span class="va">sdd</span> <span class="op">&lt;-</span> <span class="fu">avgdist</span><span class="op">(</span><span class="va">BCI</span>, sample <span class="op">=</span> <span class="fl">50</span>, iterations <span class="op">=</span> <span class="fl">100</span>, meanfun <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mean.avg.dist</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.4940  0.6160  0.6500  0.6522  0.6860  0.8680 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">median.avg.dist</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.460   0.610   0.650   0.654   0.690   0.870 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sdd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.04427 0.05637 0.05935 0.05947 0.06258 0.07640 </span>
<span class="r-in"><span><span class="co"># Test for when subsampling depth excludes some samples</span></span></span>
<span class="r-in"><span><span class="co"># Return samples that are removed for not meeting depth filter</span></span></span>
<span class="r-in"><span><span class="va">depth.avg.dist</span> <span class="op">&lt;-</span> <span class="fu">avgdist</span><span class="op">(</span><span class="va">BCI</span>, sample <span class="op">=</span> <span class="fl">450</span>, iterations <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following sampling units were removed because they were below sampling depth: 1, 2, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 33, 34, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50</span>
<span class="r-in"><span><span class="co"># Print the result</span></span></span>
<span class="r-in"><span><span class="va">depth.avg.dist</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            3         4         5        10        15        30        32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.0000000 0.3291111 0.3617778 0.2991111 0.3568889 0.4551111 0.4742222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.3291111 0.0000000 0.3724444 0.3200000 0.3466667 0.3920000 0.4348889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.3617778 0.3724444 0.0000000 0.3840000 0.3962222 0.4971111 0.5235556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.2991111 0.3200000 0.3840000 0.0000000 0.3164444 0.4255556 0.4177778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.3568889 0.3466667 0.3962222 0.3164444 0.0000000 0.4577778 0.4644444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 0.4551111 0.3920000 0.4971111 0.4255556 0.4577778 0.0000000 0.3791111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 0.4742222 0.4348889 0.5235556 0.4177778 0.4644444 0.3791111 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 0.6553333 0.6242222 0.6935556 0.6768889 0.6560000 0.5104444 0.5853333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 0.5617778 0.5333333 0.6357778 0.5208889 0.5593333 0.4542222 0.4057778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           35        40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.6553333 0.5617778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.6242222 0.5333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.6935556 0.6357778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.6768889 0.5208889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.6560000 0.5593333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 0.5104444 0.4542222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 0.5853333 0.4057778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 0.0000000 0.4211111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 0.4211111 0.0000000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

