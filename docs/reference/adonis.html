<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Analysis of variance using distance matrices --- for
  partitioning distance matrices among sources of variation and fitting
  linear models (e.g., factors, polynomial regression) to distance 
  matrices; uses a permutation test with pseudo-\(F\) ratios."><title>Permutational Multivariate Analysis of Variance Using Distance Matrices — adonis • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Permutational Multivariate Analysis of Variance Using Distance Matrices — adonis"><meta property="og:description" content="Analysis of variance using distance matrices --- for
  partitioning distance matrices among sources of variation and fitting
  linear models (e.g., factors, polynomial regression) to distance 
  matrices; uses a permutation test with pseudo-\(F\) ratios."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Permutational Multivariate Analysis of Variance Using Distance Matrices</h1>
      
      <div class="d-none name"><code>adonis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Analysis of variance using distance matrices --- for
  partitioning distance matrices among sources of variation and fitting
  linear models (e.g., factors, polynomial regression) to distance 
  matrices; uses a permutation test with pseudo-\(F\) ratios.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">adonis2</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, permutations <span class="op">=</span> <span class="fl">999</span>, method <span class="op">=</span> <span class="st">"bray"</span>,</span>
<span>    sqrt.dist <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, by <span class="op">=</span> <span class="st">"terms"</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span><span class="op">)</span>, na.action <span class="op">=</span> <span class="va">na.fail</span>,</span>
<span>    strata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Model formula. The left-hand side (LHS) of the formula
    must be either a community data matrix or a dissimilarity matrix,
    e.g., from <code><a href="vegdist.html">vegdist</a></code> or <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>.  If the LHS
    is a data matrix, function <code><a href="vegdist.html">vegdist</a></code> will be used to
    find the dissimilarities. The right-hand side (RHS) of the formula
    defines the independent variables. These can be continuous variables
    or factors, they can be transformed within the formula, and they can
    have interactions as in a typical <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>.</p></dd>

  <dt>data</dt>
<dd><p>the data frame for the independent variables, with rows
    in the same order as the community data matrix or dissimilarity
    matrix named on the LHS of <code>formula</code>.</p></dd>

  <dt>permutations</dt>
<dd><p>a list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the
    number of permutations required, or a permutation matrix where each
    row gives the permuted indices.</p></dd>

  <dt>method</dt>
<dd><p>the name of any method used in <code><a href="vegdist.html">vegdist</a></code> to
    calculate pairwise distances if the left hand side of the
    <code>formula</code> was a data frame or a matrix.</p></dd>

  <dt>sqrt.dist</dt>
<dd><p>Take square root of dissimilarities. This often
    euclidifies dissimilarities.</p></dd>

  <dt>add</dt>
<dd><p>Add a constant to the non-diagonal dissimilarities such
    that all eigenvalues are non-negative in the underlying Principal
    Co-ordinates Analysis (see <code><a href="wcmdscale.html">wcmdscale</a></code> for
    details). Choice <code>"lingoes"</code> (or <code>TRUE</code>) use the
    recommended method of Legendre &amp; Anderson (1999: “method
    1”) and <code>"cailliez"</code> uses their “method 2”.</p></dd>

  <dt>by</dt>
<dd><p><code>by = "terms"</code> will assess significance for each term
    (sequentially from first to last), setting <code>by = "margin"</code>
    will assess the marginal effects of the terms (each marginal term
    analysed in a model with all other variables), <code>by = "onedf"</code>
    will analyse one-degree-of-freedom contrasts sequentially, <code>by =
    NULL</code> will assess the overall significance of all terms
    together. The arguments is passed on to <code><a href="anova.cca.html">anova.cca</a></code>.</p></dd>

  <dt>parallel</dt>
<dd><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.</p></dd>

  <dt>na.action</dt>
<dd><p>Handling of missing values on the right-hand-side
    of the formula (see <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code> for explanation and
    alternatives). Missing values are not allowed on the
    left-hand-side. NB, argument <code>subset</code> is not implemented.</p></dd>


  <dt>strata</dt>
<dd><p>Groups within which to constrain permutations. The
    traditional non-movable strata are set as Blocks in the
    <a href="https://CRAN.R-project.org/package=permute" class="external-link"><span class="pkg">permute</span></a> package, but some more flexible alternatives may
    be more appropriate.</p></dd>


  <dt>...</dt>
<dd><p>Other arguments passed to <code><a href="vegdist.html">vegdist</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p><code>adonis2</code> is a function for the analysis and partitioning sums of
squares using dissimilarities. The function is based on the principles
of McArdle &amp; Anderson (2001) and can perform sequential, marginal and
overall tests. The function also allows using additive constants or
squareroot of dissimilarities to avoid negative eigenvalues, but can
also handle semimetric indices (such as Bray-Curtis) that produce
negative eigenvalues. The <code>adonis2</code> tests are identical to
<code><a href="anova.cca.html">anova.cca</a></code> of <code><a href="dbrda.html">dbrda</a></code>. With Euclidean
distances, the tests are also identical to <code><a href="anova.cca.html">anova.cca</a></code> of
<code><a href="cca.html">rda</a></code>.</p>
<p>The function partitions sums of squares of a multivariate data set,
and they are directly analogous to MANOVA (multivariate analysis of
variance). McArdle and Anderson (2001) and Anderson (2001) refer to
the method as “permutational MANOVA” (formerly
“nonparametric MANOVA”). Further, as the inputs are linear
predictors, and a response matrix of an arbitrary number of columns,
they are a robust alternative to both parametric MANOVA and to
ordination methods for describing how variation is attributed to
different experimental treatments or uncontrolled covariates. The
method is also analogous to distance-based redundancy analysis and
algorithmically similar to <code><a href="dbrda.html">dbrda</a></code> (Legendre and Anderson
1999), and provides an alternative to AMOVA (nested analysis of
molecular variance, Excoffier, Smouse, and Quattro, 1992; <code>amova</code>
in the <span class="pkg">ade4</span> package) for both crossed and nested factors.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    


<p>The function returns an <code><a href="anova.cca.html">anova.cca</a></code> result object with a
  new column for partial \(R^2\): This is the proportion
  of sum of squares from the total, and in marginal models
  (<code>by = "margin"</code>) the \(R^2\) terms do not add up to
  1.</p>


    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Anderson (2001, Fig. 4) warns that the method may confound
  location and dispersion effects: significant differences may be caused
  by different within-group variation (dispersion) instead of different
  mean values of the groups (see Warton et al. 2012 for a general
  analysis). However, it seems that <code>adonis2</code> is less sensitive to
  dispersion effects than some of its alternatives (<code><a href="anosim.html">anosim</a></code>,
  <code><a href="mrpp.html">mrpp</a></code>). Function <code><a href="betadisper.html">betadisper</a></code> is a sister
  function to <code>adonis2</code> to study the differences in dispersion
  within the same geometric framework.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anderson, M.J. 2001. A new method for non-parametric multivariate
analysis of variance. <em>Austral Ecology</em>, <strong>26</strong>: 32--46.</p>
<p>Excoffier, L., P.E. Smouse, and J.M. Quattro. 1992. Analysis of
molecular variance inferred from metric distances among DNA haplotypes:
Application to human mitochondrial DNA restriction data. <em>Genetics</em>,
<strong>131</strong>:479--491.</p>
<p>Legendre, P. and M.J. Anderson. 1999. Distance-based redundancy
analysis: Testing multispecies responses in multifactorial ecological
experiments. <em>Ecological Monographs</em>, <strong>69</strong>:1--24.</p>
<p>McArdle, B.H.  and M.J. Anderson. 2001. Fitting multivariate models to
community data: A comment on distance-based redundancy
analysis. <em>Ecology</em>, <strong>82</strong>: 290--297.</p>
<p>Warton, D.I., Wright, T.W., Wang, Y. 2012. Distance-based multivariate
analyses confound location and dispersion effects. <em>Methods in
Ecology and Evolution</em>, 3, 89--101.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Martin Henry H. Stevens and Jari Oksanen.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mrpp.html">mrpp</a></code>, <code><a href="anosim.html">anosim</a></code>,
  <code><a href="mantel.html">mantel</a></code>, <code><a href="varpart.html">varpart</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## default test by terms</span></span></span>
<span class="r-in"><span><span class="fu">adonis2</span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">Management</span><span class="op">*</span><span class="va">A1</span>, data <span class="op">=</span> <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Terms added sequentially (first to last)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adonis2(formula = dune ~ Management * A1, data = dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Df SumOfSqs      R2      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Management     3   1.4686 0.34161 3.2629  0.002 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1             1   0.4409 0.10256 2.9387  0.012 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Management:A1  3   0.5892 0.13705 1.3090  0.217   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual      12   1.8004 0.41878                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         19   4.2990 1.00000                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## overall tests</span></span></span>
<span class="r-in"><span><span class="fu">adonis2</span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">Management</span><span class="op">*</span><span class="va">A1</span>, data <span class="op">=</span> <span class="va">dune.env</span>, by <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adonis2(formula = dune ~ Management * A1, data = dune.env, by = NULL)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df SumOfSqs      R2      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model     7   2.4987 0.58122 2.3792  0.004 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 12   1.8004 0.41878                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total    19   4.2990 1.00000                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example of use with strata, for nested (e.g., block) designs.</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>rep<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, NO3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span>,field<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    rep NO3 field</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1   0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2   0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1  10     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    2  10     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    1   0     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    2   0     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    1  10     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    2  10     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    1   0     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   2   0     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   1  10     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   2  10     3</span>
<span class="r-in"><span><span class="va">Agropyron</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">field</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">NO3</span><span class="op">)</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">Schizachyrium</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">field</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">NO3</span><span class="op">)</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">total</span> <span class="op">&lt;-</span> <span class="va">Agropyron</span> <span class="op">+</span> <span class="va">Schizachyrium</span></span></span>
<span class="r-in"><span><span class="fu">dotplot</span><span class="op">(</span><span class="va">total</span> <span class="op">~</span> <span class="va">NO3</span>, <span class="va">dat</span>, jitter.x<span class="op">=</span><span class="cn">TRUE</span>, groups<span class="op">=</span><span class="va">field</span>,</span></span>
<span class="r-in"><span>        type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'p'</span>,<span class="st">'a'</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"NO3"</span>, auto.key<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>columns<span class="op">=</span><span class="fl">3</span>, lines<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="adonis-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Agropyron</span>, <span class="va">Schizachyrium</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">Y</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Ellipsoid hulls show treatment</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="ordihull.html">ordiellipse</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">NO3</span>, kind <span class="op">=</span> <span class="st">"ehull"</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Spider shows fields</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="ordihull.html">ordispider</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">field</span>, lty<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"red"</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="adonis-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Incorrect (no strata)</span></span></span>
<span class="r-in"><span><span class="fu">adonis2</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">NO3</span>, data <span class="op">=</span> <span class="va">dat</span>, permutations <span class="op">=</span> <span class="fl">199</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Terms added sequentially (first to last)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adonis2(formula = Y ~ NO3, data = dat, permutations = 199)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df SumOfSqs      R2      F Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NO3       1 0.036688 0.24632 3.2682   0.06 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 10 0.112256 0.75368                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total    11 0.148944 1.00000                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## Correct with strata</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu">adonis2</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">NO3</span>, data <span class="op">=</span> <span class="va">dat</span>, permutations <span class="op">=</span> <span class="fl">199</span>, strata <span class="op">=</span> <span class="va">field</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Terms added sequentially (first to last)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Blocks:  strata </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adonis2(formula = Y ~ NO3, data = dat, permutations = 199, strata = field)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df SumOfSqs      R2      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NO3       1 0.036688 0.24632 3.2682  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 10 0.112256 0.75368                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total    11 0.148944 1.00000                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

