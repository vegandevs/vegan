<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Principal Coordinates of Neighbourhood Matrix — pcnm • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Principal Coordinates of Neighbourhood Matrix — pcnm"><meta name="description" content="This function computed classical PCNM by the principal coordinate
  analysis of a truncated distance matrix. These are commonly used to
  transform (spatial) distances to rectangular data that suitable for
  constrained ordination or regression."><meta property="og:description" content="This function computed classical PCNM by the principal coordinate
  analysis of a truncated distance matrix. These are commonly used to
  transform (spatial) distances to rectangular data that suitable for
  constrained ordination or regression."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Principal Coordinates of Neighbourhood Matrix</h1>

      <div class="d-none name"><code>pcnm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computed classical PCNM by the principal coordinate
  analysis of a truncated distance matrix. These are commonly used to
  transform (spatial) distances to rectangular data that suitable for
  constrained ordination or regression.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pcnm</span><span class="op">(</span><span class="va">dis</span>, <span class="va">threshold</span>, <span class="va">w</span>, dist.ret <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-dis">dis<a class="anchor" aria-label="anchor" href="#arg-dis"></a></dt>
<dd><p>A distance matrix.</p></dd>

  <dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>A threshold value or truncation distance. If
    missing, minimum distance giving connected network will be
    used. This is found as the longest distance in the minimum spanning
    tree of <code>dis</code>.</p></dd>

  <dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>Prior weights for rows.</p></dd>

  <dt id="arg-dist-ret">dist.ret<a class="anchor" aria-label="anchor" href="#arg-dist-ret"></a></dt>
<dd><p>Return the distances used to calculate the PCNMs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Principal Coordinates of Neighbourhood Matrix (PCNM) map distances
  between rows onto rectangular matrix on rows using a truncation
  threshold for long distances (Borcard &amp; Legendre 2002). If original
  distances were Euclidean distances in two dimensions (like normal
  spatial distances), they could be mapped onto two dimensions if there
  is no truncation of distances. Because of truncation, there will be a
  higher number of principal coordinates. The selection of truncation
  distance has a huge influence on the PCNM vectors. The default is to
  use the longest distance to keep data connected. The distances above
  truncation threshold are given an arbitrary value of 4 times
  threshold.  For regular data, the first PCNM vectors show a wide scale
  variation and later PCNM vectors show smaller scale variation (Borcard
  &amp; Legendre 2002), but for irregular data the interpretation is not as
  clear.</p>
<p>The PCNM functions are used to express distances in rectangular form
  that is similar to normal explanatory variables used in, e.g.,
  constrained ordination (<code><a href="cca.html">rda</a></code>, <code><a href="cca.html">cca</a></code> and
  <code><a href="dbrda.html">dbrda</a></code>) or univariate regression (<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>)
  together with environmental variables (row weights should be supplied
  with <code><a href="cca.html">cca</a></code>; see Examples). This is regarded as a more
  powerful method than forcing rectangular environmental data into
  distances and using them in partial mantel analysis
  (<code><a href="mantel.html">mantel.partial</a></code>) together with geographic distances
  (Legendre et al. 2008, but see Tuomisto &amp; Ruokolainen 2008).</p>
<p>The function is based on <code>pcnm</code> function in Dray's unreleased
  <span class="pkg">spacemakeR</span> package. The differences are that the current
  function uses <code><a href="spantree.html">spantree</a></code> as an internal support
  function. The current function also can use prior weights for rows by
  using weighted metric scaling of <code><a href="wcmdscale.html">wcmdscale</a></code>. The use of
  row weights allows finding orthonormal PCNMs also for correspondence
  analysis (e.g., <code><a href="cca.html">cca</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of the following elements:</p>
<dl><dt>values </dt>
<dd><p>Eigenvalues obtained by the principal coordinates
    analysis.</p></dd>

  <dt>vectors </dt>
<dd><p>Eigenvectors obtained by the principal coordinates
    analysis. They are scaled to unit norm. The vectors can be extracted
    with <code>scores</code> function. The default is to return all PCNM vectors,
    but argument <code>choices</code> selects the given vectors.</p></dd>

 <dt>threshold</dt>
<dd><p>Truncation distance.</p></dd>

 <dt>dist</dt>
<dd><p>The distance matrix where values above <code>threshold</code>
    are replaced with arbitrary value of four times the
    threshold. String <code>"pcnm"</code> is added to the <code>method</code>
    attribute, and new attribute <code>threshold</code> is added to the
    distances. This is returned only when <code>dist.ret = TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Borcard D. and Legendre P. (2002) All-scale spatial analysis of
  ecological data by means of principal coordinates of neighbour
  matrices. <em>Ecological Modelling</em> <b>153</b>, 51–68.</p>
<p>Legendre, P., Borcard, D and Peres-Neto, P. (2008) Analyzing or
  explaining beta diversity? Comment. <em>Ecology</em> <b>89</b>,
  3238–3244.</p>
<p>Tuomisto, H. &amp; Ruokolainen, K. (2008) Analyzing or explaining beta
  diversity? A reply. <em>Ecology</em> <b>89</b>, 3244–3256.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen, based on the code of Stephane Dray.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="spantree.html">spantree</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Example from Borcard &amp; Legendre (2002)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcnm1</span> <span class="op">&lt;-</span> <span class="fu">pcnm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Map of PCNMs in the sample plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ordisurf.html">ordisurf</a></span><span class="op">(</span><span class="va">mite.xy</span>, <span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">pcnm1</span>, choi<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, bubble <span class="op">=</span> <span class="fl">4</span>, main <span class="op">=</span> <span class="st">"PCNM 1"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.71  total = 9.71 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: -120.7705     </span>
<span class="r-in"><span><span class="fu"><a href="ordisurf.html">ordisurf</a></span><span class="op">(</span><span class="va">mite.xy</span>, <span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">pcnm1</span>, choi<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, bubble <span class="op">=</span> <span class="fl">4</span>, main <span class="op">=</span> <span class="st">"PCNM 2"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.18  total = 8.18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: -103.4662     </span>
<span class="r-in"><span><span class="fu"><a href="ordisurf.html">ordisurf</a></span><span class="op">(</span><span class="va">mite.xy</span>, <span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">pcnm1</span>, choi<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, bubble <span class="op">=</span> <span class="fl">4</span>, main <span class="op">=</span> <span class="st">"PCNM 3"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pcnm-1.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.32  total = 9.32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: -94.19053     </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Plot first PCNMs against each other</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ordixyplot.html">ordisplom</a></span><span class="op">(</span><span class="va">pcnm1</span>, choices<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pcnm-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Weighted PCNM for CCA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pcnmw</span> <span class="op">&lt;-</span> <span class="fu">pcnm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span>, w <span class="op">=</span> <span class="va">rs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span> <span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">pcnmw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Multiscale ordination: residual variance should have no distance</span></span></span>
<span class="r-in"><span><span class="co">## trend</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mso.html">msoplot</a></span><span class="op">(</span><span class="fu"><a href="mso.html">mso</a></span><span class="op">(</span><span class="va">ord</span>, <span class="va">mite.xy</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pcnm-3.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

