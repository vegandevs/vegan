<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ecological Diversity Indices — diversity • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ecological Diversity Indices — diversity"><meta name="description" content="Shannon, Simpson, and Fisher diversity indices and species
  richness."><meta property="og:description" content="Shannon, Simpson, and Fisher diversity indices and species
  richness."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ecological Diversity Indices</h1>

      <div class="d-none name"><code>diversity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Shannon, Simpson, and Fisher diversity indices and species
  richness.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">diversity</span><span class="op">(</span><span class="va">x</span>, index <span class="op">=</span> <span class="st">"shannon"</span>, <span class="va">groups</span>, equalize.groups <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>   MARGIN <span class="op">=</span> <span class="fl">1</span>, base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">simpson.unb</span><span class="op">(</span><span class="va">x</span>, inverse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">fisher.alpha</span><span class="op">(</span><span class="va">x</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">specnumber</span><span class="op">(</span><span class="va">x</span>, <span class="va">groups</span>, MARGIN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Community data, a matrix-like object or a vector.</p></dd>

  <dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>Diversity index, one of <code>"shannon"</code>,
    <code>"simpson"</code> or <code>"invsimpson"</code>.</p></dd>

  <dt id="arg-margin">MARGIN<a class="anchor" aria-label="anchor" href="#arg-margin"></a></dt>
<dd><p>Margin for which the index is computed.</p></dd>

  <dt id="arg-base">base<a class="anchor" aria-label="anchor" href="#arg-base"></a></dt>
<dd><p>The logarithm <code>base</code> used in <code>shannon</code>.</p></dd>

  <dt id="arg-inverse">inverse<a class="anchor" aria-label="anchor" href="#arg-inverse"></a></dt>
<dd><p>Use inverse Simpson similarly as in
     <code>diversity(x, "invsimpson")</code>.</p></dd>

  <dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>A grouping factor: if given, finds the diversity of
    communities pooled by the groups.</p></dd>

  <dt id="arg-equalize-groups">equalize.groups<a class="anchor" aria-label="anchor" href="#arg-equalize-groups"></a></dt>
<dd><p>Instead of observed abundances, standardize all
    communities to unit total.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Parameters passed to the function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Shannon or Shannon–Weaver (or Shannon–Wiener) index is defined as
  \(H' = -\sum_i p_i \log_{b} p_i\), where
  \(p_i\) is the proportional abundance of species \(i\) and \(b\)
  is the base of the logarithm.  It is most popular to use natural
  logarithms, but some argue for base \(b = 2\) (which makes sense,
  but no real difference).</p>
<p>Both variants of Simpson's index are based on \(D = \sum p_i^2\). Choice <code>simpson</code> returns \(1-D\) and
  <code>invsimpson</code> returns \(1/D\).</p>
<p><code>simpson.unb</code> finds unbiased Simpson indices for discrete
  samples (Hurlbert 1971, eq. 5). These are less sensitive to sample
  size than the basic Simpson indices. The unbiased indices can be only
  calculated for data of integer counts.</p>
<p>The <code>diversity</code> function can find the total (or gamma) diversity
  of pooled communities with argument <code>groups</code>. The average alpha
  diversity can be found as the mean of diversities by the same groups,
  and their difference or ratio is an estimate of beta diversity (see
  Examples). The pooling can be based either on the observed
  abundancies, or all communities can be equalized to unit total before
  pooling; see Jost (2007) for discussion. Functions
  <code><a href="adipart.html">adipart</a></code> and <code><a href="multipart.html">multipart</a></code> provide canned
  alternatives for estimating alpha, beta and gamma diversities in
  hierarchical settings.</p>
<p><code>fisher.alpha</code> estimates the \(\alpha\) parameter of
  Fisher's logarithmic series (see <code><a href="fisherfit.html">fisherfit</a></code>).
  The estimation is possible only for genuine
  counts of individuals.</p>
<p>None of these diversity indices is usable for empty sampling units
  without any species, but some of the indices can give a numeric
  value. Filtering out these cases is left for the user.</p>
<p>Function <code>specnumber</code> finds the number of species. With
  <code>MARGIN = 2</code>, it finds frequencies of species. If <code>groups</code>
  is given, finds the total number of species in each group (see
  example on finding one kind of beta diversity with this option).</p>
<p>Better stories can be told about Simpson's index than about
  Shannon's index, and still grander narratives about
  rarefaction (Hurlbert 1971).  However, these indices are all very
  closely related (Hill 1973), and there is no reason to despise one
  more than others (but if you are a graduate student, don't drag me in,
  but obey your Professor's orders). In particular, the exponent of the
  Shannon index is linearly related to inverse Simpson (Hill 1973)
  although the former may be more sensitive to rare species. Moreover,
  inverse Simpson is asymptotically equal to rarefied species richness
  in sample of two individuals, and Fisher's \(\alpha\) is very
  similar to inverse Simpson.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of diversity indices or numbers of species.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fisher, R.A., Corbet, A.S. &amp; Williams, C.B. (1943). The relation
  between the number of species and the number of individuals in a
  random sample of animal population. <em>Journal of Animal Ecology</em>
  <strong>12</strong>, 42–58.</p>
<p>Hurlbert, S.H. (1971). The nonconcept of species diversity: a critique
  and alternative parameters. <em>Ecology</em> <strong>52</strong>, 577–586.</p>
<p>Jost, L. (2007) Partitioning diversity into independent alpha and beta
  components. <em>Ecology</em> <strong>88</strong>, 2427–2439.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>These functions calculate only some basic indices, but many
  others can be derived with them (see Examples). Facilities related to
  diversity are discussed in a <span class="pkg">vegan</span> vignette that can be read
  with <code>browseVignettes("vegan")</code>.  Functions <code><a href="renyi.html">renyi</a></code>
  and <code><a href="tsallis.html">tsallis</a></code> estimate a series of generalized diversity
  indices. Function <code><a href="rarefy.html">rarefy</a></code> finds estimated number of
  species for given sample size. Beta diversity can be estimated with
  <code><a href="betadiver.html">betadiver</a></code>. Diversities can be partitioned with
  <code><a href="adipart.html">adipart</a></code> and <code><a href="multipart.html">multipart</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen  and  Bob O'Hara (<code>fisher.alpha</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BCI</span>, <span class="va">BCI.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu">diversity</span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">simp</span> <span class="op">&lt;-</span> <span class="fu">diversity</span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">invsimp</span> <span class="op">&lt;-</span> <span class="fu">diversity</span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"inv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Unbiased Simpson</span></span></span>
<span class="r-in"><span><span class="va">unbias.simp</span> <span class="op">&lt;-</span> <span class="fu">simpson.unb</span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Fisher alpha</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu">fisher.alpha</span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Plot all</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">H</span>, <span class="va">simp</span>, <span class="va">invsimp</span>, <span class="va">unbias.simp</span>, <span class="va">alpha</span><span class="op">)</span>, pch<span class="op">=</span><span class="st">"+"</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="diversity-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Species richness (S) and Pielou's evenness (J):</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu">specnumber</span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span> <span class="co">## rowSums(BCI &gt; 0) does the same...</span></span></span>
<span class="r-in"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="va">H</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## beta diversity defined as gamma/alpha - 1:</span></span></span>
<span class="r-in"><span><span class="co">## alpha is the average no. of species in a group, and gamma is the</span></span></span>
<span class="r-in"><span><span class="co">## total number of species in the group</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">BCI.env</span>, <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="fu">specnumber</span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span>, <span class="va">Habitat</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  OldHigh   OldLow OldSlope    Swamp    Young </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85.75000 91.76923 91.58333 94.00000 90.00000 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">BCI.env</span>, <span class="fu">specnumber</span><span class="op">(</span><span class="va">BCI</span>, <span class="va">Habitat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  OldHigh   OldLow OldSlope    Swamp    Young </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      158      210      183      128      117 </span>
<span class="r-in"><span><span class="va">gamma</span><span class="op">/</span><span class="va">alpha</span> <span class="op">-</span> <span class="fl">1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   OldHigh    OldLow  OldSlope     Swamp     Young </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8425656 1.2883487 0.9981802 0.3617021 0.3000000 </span>
<span class="r-in"><span><span class="co">## similar calculations with Shannon diversity</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">BCI.env</span>, <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="fu">diversity</span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span>, <span class="va">Habitat</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># average</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  OldHigh   OldLow OldSlope    Swamp    Young </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.638598 3.876413 3.887122 4.003780 3.246729 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">BCI.env</span>, <span class="fu">diversity</span><span class="op">(</span><span class="va">BCI</span>, groups<span class="op">=</span><span class="va">Habitat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># pooled</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  OldHigh   OldLow OldSlope    Swamp    Young </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.873186 4.284972 4.212098 4.164335 3.387536 </span>
<span class="r-in"><span><span class="co">## additive beta diversity based on Shannon index</span></span></span>
<span class="r-in"><span><span class="va">gamma</span><span class="op">-</span><span class="va">alpha</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   OldHigh    OldLow  OldSlope     Swamp     Young </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2345878 0.4085595 0.3249760 0.1605548 0.1408068 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

