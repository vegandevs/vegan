<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function spantree finds a minimum spanning tree
  connecting all points, but disregarding dissimilarities that are at or
  above the threshold or NA."><title>Minimum Spanning Tree — spantree • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Minimum Spanning Tree — spantree"><meta property="og:description" content="Function spantree finds a minimum spanning tree
  connecting all points, but disregarding dissimilarities that are at or
  above the threshold or NA."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Minimum Spanning Tree</h1>
      
      <div class="d-none name"><code>spantree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function <code>spantree</code> finds a minimum spanning tree
  connecting all points, but disregarding dissimilarities that are at or
  above the threshold or <code>NA</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spantree</span><span class="op">(</span><span class="va">d</span>, toolong <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># S3 method for spantree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/as.hclust.html" class="external-link">as.hclust</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for spantree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html" class="external-link">cophenetic</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">spandepth</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co"># S3 method for spantree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">ord</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, type <span class="op">=</span> <span class="st">"p"</span>, <span class="va">labels</span>, <span class="va">dlim</span>,</span>
<span>     FUN <span class="op">=</span> <span class="va">sammon</span>,  <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for spantree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">ord</span>, display<span class="op">=</span><span class="st">"sites"</span>, col <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>d</dt>
<dd><p>Dissimilarity data inheriting from class <code>dist</code> or
    a an object, such as a matrix, that can be converted to a
    dissimilarity matrix. Functions <code><a href="vegdist.html">vegdist</a></code> and
    <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> are some functions producing suitable
    dissimilarity data.</p></dd>

  <dt>toolong</dt>
<dd><p>Shortest dissimilarity regarded as <code>NA</code>.
    The function uses a fuzz factor, so
    that dissimilarities close to the limit will be made <code>NA</code>, too.
    If <code>toolong = 0</code> (or negative), no dissimilarity is regarded
    as too long.</p></dd>

  <dt>x</dt>
<dd><p>A <code>spantree</code> result object.</p></dd>

  <dt>ord</dt>
<dd><p>An ordination configuration, or an ordination result known
    by <code><a href="scores.html">scores</a></code>.</p></dd>

  <dt>cex</dt>
<dd><p>Character expansion factor.</p></dd>

  <dt>type</dt>
<dd><p>Observations are plotted as points with
    <code>type="p"</code> or <code>type="b"</code>, or as text label with
    <code>type="t"</code>. The tree (lines) will always be plotted.</p></dd>

  <dt>labels</dt>
<dd><p>Text used with <code>type="t"</code> or node names if this is
    missing.</p></dd>

  <dt>dlim</dt>
<dd><p>A ceiling value used to highest <code>cophenetic</code> dissimilarity.</p></dd>

  <dt>FUN</dt>
<dd><p>Ordination function to find the configuration from
    cophenetic dissimilarities. If the supplied <code>FUN</code> does not work,
    supply ordination result as argument <code>ord</code>.</p></dd>

  <dt>display</dt>
<dd><p>Type of <code><a href="scores.html">scores</a></code> used for <code>ord</code>.</p></dd>

  <dt>col</dt>
<dd><p>Colour of line segments. This can be a vector which is
    recycled for points, and the line colour will be a mixture of two
    joined points.</p></dd>

<dt>...</dt>
<dd><p>Other parameters passed to functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>Function <code>spantree</code> finds a minimum spanning tree for
  dissimilarities (there may be several minimum spanning trees, but the
  function finds only one). Dissimilarities at or above the threshold
  <code>toolong</code> and <code>NA</code>s are disregarded, and the spanning tree
  is found through other dissimilarities. If the data are disconnected,
  the function will return a disconnected tree (or a forest), and the
  corresponding link is <code>NA</code>. Connected subtrees can be identified
  using <code><a href="distconnected.html">distconnected</a></code>.</p>
<p>Minimum spanning tree is closely related to single linkage
  clustering, a.k.a. nearest neighbour clustering, and in genetics as
  neighbour joining tree available in <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> and
  <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code> functions. The most important practical
  difference is that minimum spanning tree has no concept of cluster
  membership, but always joins individual points to each other. Function
  <code>as.hclust</code> can change the <code>spantree</code> result into a
  corresponding <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> object.</p>
<p>Function <code>cophenetic</code> finds distances between all points along
  the tree segments. Function <code>spandepth</code> returns the depth of
  each node. The nodes of a tree are either leaves (with one link) or
  internal nodes (more than one link). The leaves are recursively
  removed from the tree, and the depth is the layer at with the leaf
  was removed. In disconnected <code>spantree</code> object (in a forest)
  each tree is analysed separately and disconnected nodes not in any
  tree have depth zero.</p>
<p>Function <code>plot</code> displays the tree over a
  supplied ordination configuration, and <code>lines</code> adds a spanning
  tree to an ordination graph. If configuration is not supplied for <code>plot</code>,
  the function ordinates the cophenetic dissimilarities of the
  spanning tree and overlays the tree on this result. The default
  ordination function is <code><a href="https://rdrr.io/pkg/MASS/man/sammon.html" class="external-link">sammon</a></code> (package <span class="pkg">MASS</span>),
  because Sammon scaling emphasizes structure in the neighbourhood of
  nodes and may be able to beautifully represent the tree (you may need
  to set <code>dlim</code>, and sometimes the results will remain
  twisted). These ordination methods do not work with disconnected
  trees, but you must supply the ordination configuration. Function
  <code>lines</code> will overlay the tree in an existing plot.</p>
<p>Function <code>spantree</code> uses Prim's method
  implemented as priority-first search for dense graphs (Sedgewick
  1990). Function <code>cophenetic</code> uses function
  <code><a href="stepacross.html">stepacross</a></code> with option <code>path = "extended"</code>. The
  <code>spantree</code> is very fast, but <code>cophenetic</code> is slow in very
  large data sets.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Function <code>spantree</code></p>


<p>returns an object of class <code>spantree</code> which is a
  list with two vectors, each of length \(n-1\). The
  number of links in a tree is one less the number of observations, and
  the first item is omitted. The items are</p>
<dl><dt>kid </dt>
<dd><p>The child node of the parent, starting from parent number
    two. If there is no link from the parent, value will be <code>NA</code>
    and tree is disconnected at the node.</p></dd>

  <dt>dist </dt>
<dd><p>Corresponding distance. If <code>kid = NA</code>, then
    <code>dist = 0</code>.</p></dd>

  <dt>labels </dt>
<dd><p>Names of nodes as found from the input dissimilarities.</p></dd>

  <dt>call</dt>
<dd><p>The function call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sedgewick, R. (1990). <em>Algorithms in C</em>. Addison Wesley.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In principle, minimum spanning tree is equivalent to single linkage
  clustering that can be performed using <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> or
  <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code>. However, these functions combine
  clusters to each other and the information of the actually connected points
  (the “single link”) cannot be recovered from the result. The
  graphical output of a single linkage clustering plotted with
  <code><a href="ordihull.html">ordicluster</a></code> will look very different from an equivalent
  spanning tree plotted with <code>lines.spantree</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="vegdist.html">vegdist</a></code> or <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> for getting
  dissimilarities,  and <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code> or
    <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code> for single linkage clustering.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu">spantree</span><span class="op">(</span><span class="va">dis</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Add tree to a metric scaling</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tr</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spantree-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Find a configuration to display the tree neatly</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tr</span>, type <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial stress        : 0.03111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  10 iters: 0.01302, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  20 iters: 0.01139, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  30 iters: 0.01118, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  40 iters: 0.01114, magic = 0.500</span>
<span class="r-plt img"><img src="spantree-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Depths of nodes</span></span></span>
<span class="r-in"><span><span class="va">depths</span> <span class="op">&lt;-</span> <span class="fu">spandepth</span><span class="op">(</span><span class="va">tr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tr</span>, type <span class="op">=</span> <span class="st">"t"</span>, label <span class="op">=</span> <span class="va">depths</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial stress        : 0.03111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  10 iters: 0.01302, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  20 iters: 0.01139, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  30 iters: 0.01118, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  40 iters: 0.01114, magic = 0.500</span>
<span class="r-plt img"><img src="spantree-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Plot as a dendrogram</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/as.hclust.html" class="external-link">as.hclust</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spantree-4.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## cut hclust tree to classes and show in colours in spantree</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tr</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fl">5</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial stress        : 0.03111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  10 iters: 0.01302, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  20 iters: 0.01139, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  30 iters: 0.01118, magic = 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stress after  40 iters: 0.01114, magic = 0.500</span>
<span class="r-plt img"><img src="spantree-5.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

