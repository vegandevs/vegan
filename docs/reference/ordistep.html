<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Choose a Model by Permutation Tests in Constrained Ordination — ordistep • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Choose a Model by Permutation Tests in Constrained Ordination — ordistep"><meta name="description" content="

Automatic stepwise model building for constrained ordination methods
  (cca, rda, dbrda,
  capscale).  The function ordistep is modelled
  after step and can do forward, backward and stepwise
  model selection using permutation tests.  Function ordiR2step
  performs forward model choice solely on adjusted \(R^2\) and
  \(P\)-value."><meta property="og:description" content="

Automatic stepwise model building for constrained ordination methods
  (cca, rda, dbrda,
  capscale).  The function ordistep is modelled
  after step and can do forward, backward and stepwise
  model selection using permutation tests.  Function ordiR2step
  performs forward model choice solely on adjusted \(R^2\) and
  \(P\)-value."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Choose a Model by Permutation Tests in Constrained Ordination</h1>

      <div class="d-none name"><code>ordistep.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Automatic stepwise model building for constrained ordination methods
  (<code><a href="cca.html">cca</a></code>, <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code>,
  <code><a href="dbrda.html">capscale</a></code>).  The function <code>ordistep</code> is modelled
  after <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> and can do forward, backward and stepwise
  model selection using permutation tests.  Function <code>ordiR2step</code>
  performs forward model choice solely on adjusted \(R^2\) and
  \(P\)-value.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ordistep</span><span class="op">(</span><span class="va">object</span>, <span class="va">scope</span>, direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"backward"</span>, <span class="st">"forward"</span><span class="op">)</span>,</span>
<span>   Pin <span class="op">=</span> <span class="fl">0.05</span>, Pout <span class="op">=</span> <span class="fl">0.1</span>, permutations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></span><span class="op">(</span>nperm <span class="op">=</span> <span class="fl">199</span><span class="op">)</span>, steps <span class="op">=</span> <span class="fl">50</span>,</span>
<span>   trace <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">ordiR2step</span><span class="op">(</span><span class="va">object</span>, <span class="va">scope</span>, Pin <span class="op">=</span> <span class="fl">0.05</span>, R2scope <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>   permutations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></span><span class="op">(</span>nperm <span class="op">=</span> <span class="fl">499</span><span class="op">)</span>, trace <span class="op">=</span> <span class="cn">TRUE</span>, R2permutations <span class="op">=</span> <span class="fl">1000</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>In <code>ordistep</code>, an ordination object inheriting from
  <code><a href="cca.html">cca</a></code> or <code><a href="cca.html">rda</a></code>.</p></dd>


  <dt id="arg-scope">scope<a class="anchor" aria-label="anchor" href="#arg-scope"></a></dt>
<dd><p>Defines the range of models examined in the stepwise
  search.  This can be a list containing components <code>upper</code> and
  <code>lower</code>, both formulae. If it is a single item, it is interpreted
  the target scope, depending on the <code>direction</code>. If
  <code>direction</code> is <code>"forward"</code>, a single item is interpreted as
  the <code>upper</code> scope and the formula of the input <code>object</code> as
  the <code>lower</code> scope.  See <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> for details. In
  <code>ordiR2step</code>, this defines the upper scope; it can also be an
  ordination object from with the model is extracted.</p></dd>


  <dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>The mode of stepwise search, can be one of <code>"both"</code>,
  <code>"backward"</code>, or <code>"forward"</code>, with a default of
  <code>"both"</code>.  If the <code>scope</code> argument is missing, the default
  for <code>direction</code> is <code>"backward"</code> in <code>ordistep</code> (and
  <code>ordiR2step</code> does not have this argument, but only works
  forward).</p></dd>

  <dt id="arg-pin-pout">Pin, Pout<a class="anchor" aria-label="anchor" href="#arg-pin-pout"></a></dt>
<dd><p>Limits of permutation \(P\)-values for adding (<code>Pin</code>) a term to
  the model, or dropping (<code>Pout</code>) from the model. Term is added if
  \(P \le\) <code>Pin</code>, and removed if \(P &gt;\) <code>Pout</code>.</p></dd>


  <dt id="arg-r-scope">R2scope<a class="anchor" aria-label="anchor" href="#arg-r-scope"></a></dt>
<dd><p>Use adjusted \(R^2\) as the stopping criterion: only models with
  lower adjusted \(R^2\) than scope are accepted.</p></dd>


  <dt id="arg-permutations">permutations<a class="anchor" aria-label="anchor" href="#arg-permutations"></a></dt>
<dd><p>a list of control values for the permutations as
    returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the number
    of permutations required, or a permutation matrix where each row
    gives the permuted indices. This is passed to
    <code><a href="anova.cca.html">anova.cca</a></code>: see there for details.</p></dd>


  <dt id="arg-steps">steps<a class="anchor" aria-label="anchor" href="#arg-steps"></a></dt>
<dd><p>Maximum number of iteration steps of dropping and adding terms.</p></dd>

  <dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>If positive, information is printed during the model building. Larger
  values may give more information.</p></dd>


<dt id="arg-r-permutations">R2permutations<a class="anchor" aria-label="anchor" href="#arg-r-permutations"></a></dt>
<dd><p>Number of permutations used in the estimation of
  adjusted \(R^2\) for <code><a href="cca.html">cca</a></code> using
  <code><a href="RsquareAdj.html">RsquareAdj</a></code>.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Any additional arguments to <code><a href="add1.cca.html">add1.cca</a></code> and
  <code><a href="add1.cca.html">drop1.cca</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The basic functions for model choice in constrained ordination are
  <code><a href="add1.cca.html">add1.cca</a></code> and <code><a href="add1.cca.html">drop1.cca</a></code>. With these functions,
  ordination models can be chosen with standard <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> which bases the term choice on AIC. AIC-like
  statistics for ordination are provided by functions
  <code><a href="deviance.cca.html">deviance.cca</a></code> and <code><a href="deviance.cca.html">extractAIC.cca</a></code> (with
  similar functions for <code><a href="cca.html">rda</a></code>). Actually, constrained
  ordination methods do not have AIC, and therefore the <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code>
  may not be trusted. This function provides an alternative using
  permutation \(P\)-values.</p>
<p>Function <code>ordistep</code> defines the model, <code>scope</code> of models
  considered, and <code>direction</code> of the procedure similarly as
  <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code>. The function alternates with <code>drop</code> and
  <code>add</code> steps and stops when the model was not changed during one
  step. The <code>-</code> and <code>+</code> signs in the summary table indicate
  which stage is performed.  It is often sensible to have <code>Pout</code>
  \(&gt;\) <code>Pin</code> in stepwise models to avoid cyclic adds and drops
  of single terms.</p>
<p>Function <code>ordiR2step</code> builds model forward so that it maximizes
  adjusted \(R^2\) (function <code><a href="RsquareAdj.html">RsquareAdj</a></code>) at every
  step, and stopping when the adjusted \(R^2\) starts to decrease,
  or the adjusted \(R^2\) of the <code>scope</code> is exceeded, or the
  selected permutation \(P\)-value is exceeded (Blanchet et
  al. 2008). The second criterion is ignored with option <code>R2scope =
  FALSE</code>, and the third criterion can be ignored setting <code>Pin = 1</code>
  (or higher).  The function cannot be used if adjusted \(R^2\)
  cannot be calculated. If the number of predictors is higher than the
  number of observations, adjusted \(R^2\) is also unavailable.
  Such models can be analysed with <code>R2scope = FALSE</code>, but the
  variable selection will stop if models become overfitted and adjusted
  \(R^2\) cannot be calculated, and the adjusted \(R^2\)
  will be reported as zero. The \(R^2\) of <code><a href="cca.html">cca</a></code> is
  based on simulations (see <code><a href="RsquareAdj.html">RsquareAdj</a></code>) and different runs
  of <code>ordiR2step</code> can give different results.</p>
<p>Functions <code>ordistep</code> (based on \(P\) values) and <code>ordiR2step</code>
  (based on adjusted \(R^2\) and hence on eigenvalues) can select
  variables in different order.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Functions return the selected model with one additional
  component, <code>anova</code>, which contains brief information of steps
  taken. You can suppress voluminous output during model building by
  setting <code>trace = FALSE</code>, and find the summary of model history
  in the <code>anova</code> item.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Blanchet, F. G., Legendre, P. &amp; Borcard, D. (2008) Forward selection
  of explanatory variables. <em>Ecology</em> 89, 2623–2632.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">

<p>The function handles constrained ordination methods
  <code><a href="cca.html">cca</a></code>, <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code> and
  <code><a href="dbrda.html">capscale</a></code>. The underlying functions are
  <code><a href="add1.cca.html">add1.cca</a></code> and <code><a href="add1.cca.html">drop1.cca</a></code>, and the function
  is modelled after standard <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> (which also can be
  used directly but uses AIC for model choice, see
  <code><a href="deviance.cca.html">extractAIC.cca</a></code>). Function <code>ordiR2step</code> builds
  upon <code><a href="RsquareAdj.html">RsquareAdj</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## See add1.cca for another example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Dune data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">dune.env</span><span class="op">)</span>  <span class="co"># Model with intercept only</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">dune.env</span><span class="op">)</span>  <span class="co"># Model with all explanatory variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With scope present, the default direction is "both"</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">ordistep</span><span class="op">(</span><span class="va">mod0</span>, scope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start: dune ~ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df    AIC      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Management  3 87.082 2.8400  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture    3 87.707 2.5883  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure      4 89.232 1.9539  0.010 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1          1 89.591 1.9217  0.030 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use         2 91.032 1.1741  0.310   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step: dune ~ Management </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df   AIC    F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Management  3 89.62 2.84  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df    AIC      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture  3 85.567 1.9764  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure    3 87.517 1.3902  0.075 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1        1 87.424 1.2965  0.170   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use       2 88.284 1.0510  0.390   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step: dune ~ Management + Moisture </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df    AIC      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Moisture    3 87.082 1.9764  0.010 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Management  3 87.707 2.1769  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df    AIC      F Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure  3 85.762 1.1225  0.285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1      1 86.220 0.8359  0.535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use     2 86.842 0.8027  0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = dune ~ Management + Moisture, data = dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         84.1237     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   46.4249     0.5519    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 37.6988     0.4481   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RDA1   RDA2   RDA3   RDA4   RDA5   RDA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21.588 14.075  4.123  3.163  2.369  1.107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10  PC11  PC12  PC13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.241 7.138 5.355 4.409 3.143 2.770 1.878 1.741 0.952 0.909 0.627 0.311 0.227 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## summary table of steps</span></span></span>
<span class="r-in"><span><span class="va">mod</span><span class="op">$</span><span class="va">anova</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df    AIC      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Management  3 87.082 2.8400  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture    3 85.567 1.9764  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example of ordistep, forward</span></span></span>
<span class="r-in"><span><span class="fu">ordistep</span><span class="op">(</span><span class="va">mod0</span>, scope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>, direction<span class="op">=</span><span class="st">"forward"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start: dune ~ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df    AIC      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Management  3 87.082 2.8400  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture    3 87.707 2.5883  0.005 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure      4 89.232 1.9539  0.010 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1          1 89.591 1.9217  0.020 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use         2 91.032 1.1741  0.265   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step: dune ~ Management </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df    AIC      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture  3 85.567 1.9764  0.010 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure    3 87.517 1.3902  0.055 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1        1 87.424 1.2965  0.200   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use       2 88.284 1.0510  0.420   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step: dune ~ Management + Moisture </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df    AIC      F Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure  3 85.762 1.1225  0.265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1      1 86.220 0.8359  0.630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use     2 86.842 0.8027  0.715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = dune ~ Management + Moisture, data = dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         84.1237     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   46.4249     0.5519    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 37.6988     0.4481   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RDA1   RDA2   RDA3   RDA4   RDA5   RDA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21.588 14.075  4.123  3.163  2.369  1.107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10  PC11  PC12  PC13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.241 7.138 5.355 4.409 3.143 2.770 1.878 1.741 0.952 0.909 0.627 0.311 0.227 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example of ordiR2step (always forward)</span></span></span>
<span class="r-in"><span><span class="co">## stops because R2 of 'mod1' exceeded</span></span></span>
<span class="r-in"><span><span class="fu">ordiR2step</span><span class="op">(</span><span class="va">mod0</span>, <span class="va">mod1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step: R2.adj= 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: dune ~ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 R2.adjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;All variables&gt;  0.32508817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Management     0.22512409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture       0.20050225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure         0.16723149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1             0.04626579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use            0.01799755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;           0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df    AIC    F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Management  3 87.082 2.84  0.002 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step: R2.adj= 0.2251241 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: dune ~ Management </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 R2.adjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture        0.3450334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;All variables&gt;   0.3250882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure          0.2779515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1              0.2392216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use             0.2300349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;            0.2251241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = dune ~ Management, data = dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         84.1237     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   29.2307     0.3475    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 54.8930     0.6525   16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RDA1   RDA2   RDA3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.865 10.690  3.675 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8    PC9   PC10   PC11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15.270  8.428  6.899  5.675  3.988  3.121  2.588  2.380  1.818  1.376  0.995 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC12   PC13   PC14   PC15   PC16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.785  0.661  0.467  0.283  0.159 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

