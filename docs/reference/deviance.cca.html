<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The functions extract statistics that resemble deviance and AIC from the
  result of constrained correspondence analysis cca or
  redundancy analysis rda.  These functions are rarely
  needed directly, but they are called by step in
  automatic model building.  Actually, cca and
  rda do not have AIC and these functions
  are certainly wrong."><title>Statistics Resembling Deviance and AIC for Constrained Ordination — deviance.cca • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistics Resembling Deviance and AIC for Constrained Ordination — deviance.cca"><meta property="og:description" content="The functions extract statistics that resemble deviance and AIC from the
  result of constrained correspondence analysis cca or
  redundancy analysis rda.  These functions are rarely
  needed directly, but they are called by step in
  automatic model building.  Actually, cca and
  rda do not have AIC and these functions
  are certainly wrong."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Statistics Resembling Deviance and AIC for Constrained Ordination</h1>
      
      <div class="d-none name"><code>deviance.cca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The functions extract statistics that resemble deviance and AIC from the
  result of constrained correspondence analysis <code><a href="cca.html">cca</a></code> or
  redundancy analysis <code><a href="cca.html">rda</a></code>.  These functions are rarely
  needed directly, but they are called by <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> in
  automatic model building.  Actually, <code><a href="cca.html">cca</a></code> and
  <code><a href="cca.html">rda</a></code> do not have <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code> and these functions
  are certainly wrong.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for cca</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for cca</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">fit</span>, scale <span class="op">=</span> <span class="fl">0</span>, k <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>the result of a constrained ordination
    (<code><a href="cca.html">cca</a></code> or <code><a href="cca.html">rda</a></code>).</p></dd>

  <dt>fit</dt>
<dd><p>fitted model from constrained ordination.</p></dd>

  <dt>scale</dt>
<dd><p>optional numeric specifying the scale parameter of the model,
    see <code>scale</code> in <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code>.</p></dd>

  <dt>k</dt>
<dd><p>numeric specifying the "weight" of the <em>equivalent degrees of
    freedom</em> (=:<code>edf</code>) part in the AIC formula.</p></dd>

  <dt>...</dt>
<dd><p>further arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The functions find statistics that
  resemble <code><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></code> and <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code> in constrained
  ordination.  Actually, constrained ordination methods do not have a
  log-Likelihood, which means that they cannot have AIC and deviance.
  Therefore you should not use these functions, and if you use them, you
  should not trust them.  If you use these functions, it remains as your
  responsibility to check the adequacy of the result.</p>
<p>The deviance of <code><a href="cca.html">cca</a></code> is equal to the Chi-square of
  the residual data matrix after fitting the constraints.  The deviance
  of  <code><a href="cca.html">rda</a></code> is defined as the residual sum of squares. The
  deviance function of <code>rda</code> is also used for
  <code><a href="capscale.html">capscale</a></code>. Function <code>extractAIC</code> mimics
  <code>extractAIC.lm</code> in translating deviance to AIC.</p>  
<p>There is little need to call these functions directly.  However, they
  are called implicitly in <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> function used in automatic
  selection of constraining variables.  You should check the resulting
  model with some other criteria, because the statistics used here are
  unfounded. In particular, the penalty <code>k</code> is not properly
  defined, and the default <code>k = 2</code> is not justified
  theoretically. If you have only continuous covariates, the <code>step</code>
  function will base the model building on magnitude of eigenvalues, and
  the value of <code>k</code> only influences the stopping point (but the
  variables with the highest eigenvalues are not necessarily the most
  significant in permutation tests in <code><a href="anova.cca.html">anova.cca</a></code>). If you
  also have multi-class factors, the value of <code>k</code> will have a
  capricious effect in model building. The <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> function
  will pass arguments to <code><a href="add1.cca.html">add1.cca</a></code> and
  <code><a href="add1.cca.html">drop1.cca</a></code>, and setting <code>test = "permutation"</code>
  will provide permutation tests of each deletion and addition which
  can help in judging the validity of the model building.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The <code>deviance</code> functions return “deviance”, and</p>
<p></p>
<p><code>extractAIC</code> returns effective degrees of freedom and “AIC”.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Godínez-Domínguez, E. &amp; Freire, J. (2003)
  Information-theoretic approach for selection of spatial and temporal
  models of community organization. <em>Marine Ecology Progress
    Series</em> <strong>253</strong>, 17--24.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari  Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>These functions are unfounded and untested and they should not be used
  directly or implicitly.  Moreover, usual caveats in using 
  <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code> are very valid.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cca.html">cca</a></code>, <code><a href="cca.html">rda</a></code>, <code><a href="anova.cca.html">anova.cca</a></code>,
    <code><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></code>, <code><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></code>,
    <code><a href="add1.cca.html">add1.cca</a></code>, <code><a href="add1.cca.html">drop1.cca</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The deviance of correspondence analysis equals Chi-square</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Chi-squared approximation may be incorrect</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pearson's Chi-squared test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  dune</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 1449, df = 551, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1448.956</span>
<span class="r-in"><span><span class="co"># Stepwise selection (forward from an empty model "dune ~ 1")</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></span><span class="op">(</span><span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">dune.env</span><span class="op">)</span>, scope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">ord</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start:  AIC=87.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dune ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df    AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Moisture    3 86.608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Management  3 86.935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1          1 87.411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;          87.657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure      4 88.832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use         2 89.134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step:  AIC=86.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dune ~ Moisture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Df    AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;none&gt;          86.608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Management  3 86.813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + A1          1 86.992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Use         2 87.259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + Manure      4 87.342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Moisture    3 87.657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = dune ~ Moisture, data = dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.1153     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.6283     0.2970    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  1.4870     0.7030   16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CCA1   CCA2   CCA3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4187 0.1330 0.0766 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8    CA9   CA10   CA11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4098 0.2259 0.1761 0.1234 0.1082 0.0908 0.0859 0.0609 0.0566 0.0467 0.0419 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CA12   CA13   CA14   CA15   CA16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0201 0.0143 0.0099 0.0085 0.0080 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

