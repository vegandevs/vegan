<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prediction Tools for [Constrained] Ordination (CCA, RDA, DCA, CA, PCA) — predict.cca • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction Tools for [Constrained] Ordination (CCA, RDA, DCA, CA, PCA) — predict.cca"><meta name="description" content="Function predict can be used to find site and species scores or
  estimates of the response data with new data sets, Function
  calibrate estimates values of constraints with new data set.
  Functions fitted and residuals return estimates of
  response data."><meta property="og:description" content="Function predict can be used to find site and species scores or
  estimates of the response data with new data sets, Function
  calibrate estimates values of constraints with new data set.
  Functions fitted and residuals return estimates of
  response data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prediction Tools for [Constrained] Ordination (CCA, RDA, DCA, CA, PCA)</h1>

      <div class="d-none name"><code>predict.cca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function <code>predict</code> can be used to find site and species scores or
  estimates of the response data with new data sets, Function
  <code>calibrate</code> estimates values of constraints with new data set.
  Functions <code>fitted</code> and <code>residuals</code> return estimates of
  response data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCA"</span>, <span class="st">"CA"</span>, <span class="st">"pCCA"</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="st">"working"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'capscale'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCA"</span>, <span class="st">"CA"</span>, <span class="st">"pCCA"</span>, <span class="st">"Imaginary"</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="st">"working"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="st">"wa"</span>, <span class="st">"sp"</span>, <span class="st">"lc"</span>, <span class="st">"working"</span><span class="op">)</span>,</span>
<span>        rank <span class="op">=</span> <span class="st">"full"</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCA"</span>, <span class="st">"CA"</span><span class="op">)</span>, scaling <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        hill <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'rda'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="st">"wa"</span>, <span class="st">"sp"</span>, <span class="st">"lc"</span>, <span class="st">"working"</span><span class="op">)</span>,</span>
<span>        rank <span class="op">=</span> <span class="st">"full"</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCA"</span>, <span class="st">"CA"</span><span class="op">)</span>, scaling <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        correlation <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">const</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'dbrda'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="st">"lc"</span>, <span class="st">"wa"</span>, <span class="st">"working"</span><span class="op">)</span>,</span>
<span>        rank <span class="op">=</span> <span class="st">"full"</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCA"</span>, <span class="st">"CA"</span><span class="op">)</span>, scaling <span class="op">=</span> <span class="st">"none"</span>, <span class="va">const</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu">calibrate</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, rank <span class="op">=</span> <span class="st">"full"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, norm <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'decorana'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"response"</span>, <span class="st">"sites"</span>, <span class="st">"species"</span><span class="op">)</span>,</span>
<span>    rank <span class="op">=</span> <span class="fl">4</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A result object from <code><a href="cca.html">cca</a></code>,
    <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code>, <code><a href="dbrda.html">capscale</a></code> or
    <code><a href="decorana.html">decorana</a></code>.</p></dd>


  <dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Show constrained (<code>"CCA"</code>), unconstrained
    (<code>"CA"</code>) or conditioned “partial” (<code>"pCCA"</code>)
    results. For <code>fitted</code> method of <code><a href="dbrda.html">capscale</a></code> this can
    also be <code>"Imaginary"</code> for imaginary components with negative
    eigenvalues</p></dd>


  <dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>New data frame to be used in prediction or in
    calibration.  Usually this a new community data frame, but with
    <code>type = "lc"</code> and for constrained component with <code>type =
    "response"</code> and <code>type = "working"</code> it must be a data frame of
    constraints.  The <code>newdata</code> must have the same number of rows
    as the original community data for a <code><a href="cca.html">cca</a></code> result with
    <code>type = "response"</code> or <code>type = "working"</code>.  If the
    original model had row or column names, then new data must contain
    rows or columns with the same names (row names for species scores,
    column names for <code>"wa"</code> scores and constraint names of
    <code>"lc"</code> scores). In other cases the rows or columns must match
    directly. The argument is not implemented for <code>"wa"</code> scores in
    <code>dbrda</code>.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of prediction, fitted values or residuals:
    <code>"response"</code> scales results so that the same ordination gives
    the same results, and <code>"working"</code> gives the values used
    internally, that is after Chi-square standardization in
    <code><a href="cca.html">cca</a></code> and scaling and centring in
    <code><a href="cca.html">rda</a></code>. In <code><a href="dbrda.html">capscale</a></code> and
    <code><a href="dbrda.html">dbrda</a></code> the <code>"response"</code> gives the
    dissimilarities, and <code>"working"</code> the internal data structure
    analysed in the ordination. Alternative <code>"wa"</code> gives the site
    scores as weighted averages of the community data, <code>"lc"</code> the
    site scores as linear combinations of environmental data, and
    <code>"sp"</code> the species scores. In <code>predict.decorana</code> the
    alternatives are scores for <code>"sites"</code> or <code>"species"</code>.</p></dd>

  <dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>The rank or the number of axes used in the approximation.
    The default is to use all axes (full rank) of the <code>"model"</code> or
    all available four axes in <code>predict.decorana</code>.</p></dd>

  <dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>logical, character, or numeric; Scaling or predicted
    scores with the same meaning as in <code><a href="cca.html">cca</a></code>,
    <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code>, and
    <code><a href="dbrda.html">capscale</a></code>. See <code>scores.cca</code> for further details
    on acceptable values.</p></dd>

  <dt id="arg-correlation-hill">correlation, hill<a class="anchor" aria-label="anchor" href="#arg-correlation-hill"></a></dt>
<dd><p>logical; correlation-like scores or Hill's
    scaling as appropriate for RDA and CCA respectively. See
    <code><a href="plot.cca.html">scores.cca</a></code> for additional details.</p></dd>

  <dt id="arg-const">const<a class="anchor" aria-label="anchor" href="#arg-const"></a></dt>
<dd><p>Constant multiplier for  RDA scores. This will be used
    only when <code>scaling</code> is not <code>FALSE</code>, and the default value
    will give similar scaling as in <code><a href="plot.cca.html">scores.rda</a></code>.</p></dd>

  <dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>Coefficients for variables that are centred and scaled
    to unit norm.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters to the functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Function <code>fitted</code> gives the approximation of the original data
  matrix or dissimilarities from the ordination result either in the
  scale of the response or as scaled internally by the function.
  Function <code>residuals</code> gives the approximation of the original data
  from the unconstrained ordination.  With argument <code>type =
  "response"</code> the <code>fitted.cca</code> and <code>residuals.cca</code> function
  both give the same marginal totals as the original data matrix, and
  fitted and residuals do not add up to the original data.  Functions
  <code>fitted</code> and <code>residuals</code> for <code><a href="dbrda.html">dbrda</a></code> and
  <code><a href="dbrda.html">capscale</a></code> give the dissimilarities with <code>type =
  "response"</code>, but these are not additive.  However, the
  <code>"working"</code> scores are additive for <code><a href="dbrda.html">capscale</a></code> (but
  not for <code><a href="dbrda.html">dbrda</a></code>). The <code>fitted</code> and <code>residuals</code>
  for <code><a href="dbrda.html">capscale</a></code> and <code><a href="dbrda.html">dbrda</a></code> will include the
  additive constant if that was requested in the function call.  All
  variants of <code>fitted</code> and <code>residuals</code> are defined so that for
  model <code>mod &lt;- cca(y ~ x)</code>, <code>cca(fitted(mod))</code> is equal to
  constrained ordination, and <code>cca(residuals(mod))</code> is equal to
  unconstrained part of the ordination.</p>
<p>Function <code>predict</code> can find the estimate of the original data
  matrix or dissimilarities (<code>type = "response"</code>) with any rank.
  With <code>rank = "full"</code> it is identical to <code>fitted</code>.  In
  addition, the function can find the species scores or site scores from
  the community data matrix for <code><a href="cca.html">cca</a></code> or <code><a href="cca.html">rda</a></code>.
  The function can be used with new data, and it can be used to add new
  species or site scores to existing ordinations.  The function returns
  (weighted) orthonormal scores by default, and you must specify
  explicit <code>scaling</code> to add those scores to ordination
  diagrams. With <code>type = "wa"</code> the function finds the site scores
  from species scores. In that case, the new data can contain new sites,
  but species must match in the original and new data.  With <code>type="sp"</code>
  the function finds species scores from site constraints
  (linear combination scores). In that case the new data can contain new
  species, but sites must match in the original and new data. With
  <code>type = "lc"</code> the function finds the linear combination scores
  for sites from environmental data. In that case the new data frame
  must contain all constraining and conditioning environmental variables
  of the model formula. With <code>type = "response"</code> or
  <code>type = "working"</code> the new data must contain environmental variables
  if constrained component is desired, and community data matrix if
  residual or unconstrained component is desired.  With these types, the
  function uses <code>newdata</code> to find new <code>"lc"</code> (constrained) or
  <code>"wa"</code> scores (unconstrained) and then finds the response or
  working data from these new row scores and species scores.  The
  original site (row) and species (column) weights are used for
  <code>type = "response"</code> and <code>type = "working"</code> in correspondence
  analysis (<code><a href="cca.html">cca</a></code>) and therefore the number of rows must
  match in the original data and <code>newdata</code>.</p>
<p>If a completely new data frame is created, extreme care is needed
  defining variables similarly as in the original model, in particular
  with (ordered) factors. If ordination was performed with the formula
  interface, the <code>newdata</code> can be a data frame or matrix, but
  extreme care is needed that the columns match in the original and
  <code>newdata</code>.</p>
<p>Function <code>calibrate.cca</code> finds estimates of constraints from
  community ordination or <code>"wa"</code> scores from <code><a href="cca.html">cca</a></code>,
  <code><a href="cca.html">rda</a></code> and <code><a href="dbrda.html">capscale</a></code>. This is often known as
  calibration, bioindication or environmental reconstruction, and it
  is equivalent to performing Weighted Averaging (see
  <code><a href="wascores.html">wascores</a></code>). As a Weighted Averaging method it uses
  deshrinking where the sum of weighted prediction errors is
  zero. Basically, the method is similar to projecting site scores
  onto biplot arrows, but it uses regression coefficients.  The
  function can be called with <code>newdata</code> so that cross-validation
  is possible.  The <code>newdata</code> may contain new sites, but species
  must match in the original and new data.  The function does not work
  with ‘partial’ models with <code>Condition</code> term, and it
  cannot be used with <code>newdata</code> for <code><a href="dbrda.html">capscale</a></code> or
  <code><a href="dbrda.html">dbrda</a></code> results.  The results may only be interpretable
  for continuous variables.</p>
<p>Function <code>coef</code> will give the regression coefficients from centred
  environmental variables (constraints and conditions) to linear
  combination scores. The coefficients are for unstandardized environmental
  variables. The coefficients will be <code>NA</code> for aliased effects.</p>
<p>Function <code>predict.decorana</code> is similar to <code>predict.cca</code>.
  However, <code>type = "species"</code> is not available in detrended
  correspondence analysis  (DCA), because detrending destroys the mutual
  reciprocal averaging (except for the first axis when rescaling is not
  used). Detrended CA does not attempt to approximate the original data
  matrix, so <code>type = "response"</code> has no meaning in detrended
  analysis (except with <code>rank = 1</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The functions return matrices, vectors or dissimilarities as is appropriate.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Greenacre, M. J. (1984). Theory and applications of correspondence
  analysis. Academic Press, London.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cca.html">cca</a></code>, <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code>,
  <code><a href="dbrda.html">capscale</a></code>, <code><a href="decorana.html">decorana</a></code>,
  <code><a href="goodness.cca.html">goodness.cca</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">Management</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Moisture</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Definition of the concepts 'fitted' and 'residuals'</span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = dune ~ A1 + Management + Condition(Moisture), data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.1153     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    0.6283     0.2970    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.5109     0.2415    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  0.9761     0.4615   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CCA1    CCA2    CCA3    CCA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.24932 0.12090 0.08160 0.05904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8     CA9    CA10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.30637 0.13191 0.11516 0.10947 0.07724 0.07575 0.04871 0.03758 0.03106 0.02102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA11    CA12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.01254 0.00928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(X = fitted(mod))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          0.5109     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  0.5109    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CA1     CA2     CA3     CA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.24932 0.12090 0.08160 0.05904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(X = residuals(mod))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          0.9761     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  0.9761   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8     CA9    CA10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.30637 0.13191 0.11516 0.10947 0.07724 0.07575 0.04871 0.03758 0.03106 0.02102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA11    CA12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.01254 0.00928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Remove rare species (freq==1) from 'cca' and find their scores</span></span></span>
<span class="r-in"><span><span class="co"># 'passively'.</span></span></span>
<span class="r-in"><span><span class="va">freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="diversity.html">specnumber</a></span><span class="op">(</span><span class="va">dune</span>, MARGIN<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">freq</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Achimill Agrostol Airaprae Alopgeni Anthodor Bellpere Bromhord Chenalbu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        7       10        2        8        6        6        5        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cirsarve Comapalu Eleopalu Elymrepe Empenigr Hyporadi Juncarti Juncbufo </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2        5        6        1        3        5        4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lolipere Planlanc  Poaprat  Poatriv Ranuflam Rumeacet Sagiproc Salirepe </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       12        7       14       13        6        5        7        3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scorautu Trifprat Trifrepe Vicilath Bracruta Callcusp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       18        3       16        3       15        3 </span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span><span class="op">[</span>, <span class="va">freq</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">Management</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Moisture</span><span class="op">)</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_BEGIN</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"sp"</span>, newdata<span class="op">=</span><span class="va">dune</span><span class="op">[</span>, <span class="va">freq</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, scaling<span class="op">=</span><span class="st">"species"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                CCA1      CCA2       CCA3        CCA4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chenalbu  1.5737337 0.7842538  0.5503660 -0.35108333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cirsarve  0.5945146 0.3714228 -0.2862647 -0.88373727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empenigr -1.8771953 0.9904299 -0.2446222 -0.04858656</span>
<span class="r-in"><span><span class="co"># New sites</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"lc"</span>, new<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">3</span>, Management<span class="op">=</span><span class="st">"NM"</span>, Moisture<span class="op">=</span><span class="st">"2"</span><span class="op">)</span>, scal<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       CCA1     CCA2       CCA3      CCA4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -2.38829 1.230652 -0.2363485 0.3338258</span>
<span class="r-in"><span><span class="co"># Calibration and residual plot</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">A1</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">calibrate</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         A1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.418491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2.873101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3.873171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.976229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 3.116662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 3.479079</span>
<span class="r-in"><span><span class="co">## For single variable similar to weighted averaging calibration, but</span></span></span>
<span class="r-in"><span><span class="co">## different deshrinking</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="wascores.html">wascores</a></span><span class="op">(</span><span class="fu"><a href="wascores.html">wascores</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">$</span><span class="va">A1</span>, <span class="va">dune</span>, expand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span>, expand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.326038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.376503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 4.098717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 4.173142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 3.552394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 3.814118</span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_END</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">A1</span>, <span class="va">pred</span> <span class="op">-</span> <span class="va">A1</span>, ylab<span class="op">=</span><span class="st">"Prediction Error"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.cca-1.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

