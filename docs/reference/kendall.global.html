<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Kendall coefficient of concordance — kendall.global • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Kendall coefficient of concordance — kendall.global" />
<meta property="og:description" content="Function kendall.global computes and tests the coefficient of
  concordance among several judges (variables, species) through a
  permutation test.
Function kendall.post carries out a posteriori tests
  of the contributions of individual judges (variables, species) to
  the overall concordance of their group through permutation tests.
If several groups of judges are identified in the data table,
  coefficients of concordance (kendall.global) or a posteriori
  tests (kendall.post) will be computed for each group
  separately. Use in ecology: to identify significant species
  associations." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kendall coefficient of concordance</h1>
    
    <div class="hidden name"><code>kendall.global.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>kendall.global</code> computes and tests the coefficient of
  concordance among several judges (variables, species) through a
  permutation test.</p>
<p>Function <code>kendall.post</code> carries out <em>a posteriori</em> tests
  of the contributions of individual judges (variables, species) to
  the overall concordance of their group through permutation tests.</p>
<p>If several groups of judges are identified in the data table,
  coefficients of concordance (<code>kendall.global</code>) or a posteriori
  tests (<code>kendall.post</code>) will be computed for each group
  separately. Use in ecology: to identify significant species
  associations.</p>
    </div>

    <pre class="usage"><span class='fu'>kendall.global</span>(<span class='no'>Y</span>, <span class='no'>group</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>999</span>, <span class='kw'>mult</span> <span class='kw'>=</span> <span class='st'>"holm"</span>)
<span class='fu'>kendall.post</span>(<span class='no'>Y</span>, <span class='no'>group</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>999</span>, <span class='kw'>mult</span> <span class='kw'>=</span> <span class='st'>"holm"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>Data file (data frame or matrix) containing quantitative or
    semiquantitative data. Rows are objects and columns are judges
    (variables). In community ecology, that table is often a
    site-by-species table.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A vector defining how judges should be divided into
    groups. See example below. If groups are not explicitly defined,
    all judges in the data file will be considered as forming a single
    group.</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>Number of permutations to be performed. Default is
    999.</p></td>
    </tr>
    <tr>
      <th>mult</th>
      <td><p>Correct P-values for multiple testing using the
    alternatives described in <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> and in addition
    <code>"sidak"</code> (see Details). The Bonferroni correction is overly
    conservative; it is not recommended. It is included to allow
    comparisons with the other methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>Y</code> must contain quantitative data. They will be transformed to
  ranks within each column before computation of the coefficient of
  concordance.</p>
<p>The search for species associations described in Legendre (2005)
  proceeds in 3 steps:</p>
<p>(1) Correlation analysis of the species. A possible method is to
  compute Ward's agglomerative clustering of a matrix of correlations
  among the species. In detail: (1.1) compute a Pearson or Spearman
  correlation matrix (<code>correl.matrix</code>) among the species; (1.2)
  turn it into a distance matrix: <code>mat.D = as.dist(1-correl.matrix)</code>; 
  (1.3) carry out Ward's hierarchical
  clustering of that matrix using <code>hclust</code>: 
  <code>clust.ward = hclust(mat.D, "ward")</code>; (1.4) plot the dendrogram:
  <code><a href='https://rdrr.io/r/graphics/plot.html'>plot(clust.ward, hang=-1)</a></code>; (1.5) cut the dendrogram in two
  groups, retrieve the vector of species membership: 
  <code>group.2 = cutree(clust.ward, k=2)</code>. (1.6) After steps 2 and 3 below, 
  you may
  have to come back and try divisions of the species into k = \(3, 4, 5, \dots\) 
  groups.</p>
<p>(2) Compute global tests of significance of the 2 (or more) groups
  using the function <code>kendall.global</code> and the vector defining the
  groups. Groups that are not globally significant must be refined or
  abandoned.</p>
<p>(3) Compute a posteriori tests of the contribution of individual
  species to the concordance of their group using the function
  <code>kendall.post</code> and the vector defining the groups. If some
  species have negative values for "Spearman.mean", this means that
  these species clearly do not belong to the group, hence that group
  is too inclusive. Go back to (1.5) and cut the dendrogram more
  finely. The left and right groups can be cut separately,
  independently of the levels along the dendrogram; write your own
  vector of group membership if <code>cutree</code> does not produce the
  desired groups.</p>
<p>The corrections used for multiple testing are applied to the list of
  P-values (P); they take into account the number of tests (k) carried
  out simultaneously (number of groups in <code>kendall.global</code>, or
  number of species in <code>kendall.post</code>). The corrections are
  performed using function <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code>; see that function
  for the description of the correction methods. In addition, there is
  Šidák correction which defined as 
  \(P_{corr} = 1 -(1 - P)^k\).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<p>A table containing the following information in rows. The columns
  correspond to the groups of "judges" defined in vector "group". When
  function <code>Kendall.post</code> is used, there are as many tables as
  the number of predefined groups.</p>
<p></p>
<dt>W </dt><dd><p>Kendall's coefficient of concordance, W.</p></dd>

  <dt>F </dt><dd><p>F statistic. F = W*(m-1)/(1-W) where m is the number of
  judges.</p></dd>

  <dt>Prob.F </dt><dd><p>Probability associated with the F statistic, computed
  from the F distribution with nu1 = n-1-(2/m) and nu2 = nu1*(m-1); n is
  the number of objects.</p></dd>

  <dt>Corrected prob.F </dt><dd><p>Probabilities associated with F, corrected
  using the method selected in parameter <code>mult</code>. Shown only if
  there are more than one group.</p></dd>

  <dt>Chi2 </dt><dd><p>Friedman's chi-square statistic (Friedman 1937) used in
  the permutation test of W.</p></dd>

  <dt>Prob.perm </dt><dd><p>Permutational probabilities, uncorrected.</p></dd>

  <dt>Corrected prob.perm </dt><dd><p>Permutational probabilities corrected
  using the method selected in parameter <code>mult</code>. Shown only if
  there are more than one group.</p></dd>

  <dt>Spearman.mean </dt><dd><p>Mean of the Spearman correlations between the
  judge under test and all the other judges in the same group.</p></dd>

  <dt>W.per.species </dt><dd><p>Contribution of the judge under test to the
  overall concordance statistic for that group.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

     

<p>Friedman, M. 1937. The use of ranks to avoid the assumption of normality
implicit in the analysis of variance. Journal of the American
Statistical Association 32: 675-701.</p>
<p>Kendall, M. G. and B. Babington Smith. 1939. The problem of m
rankings. Annals of Mathematical Statistics 10: 275-287.</p>
<p>Legendre, P. 2005. Species associations: the Kendall coefficient of
concordance revisited. Journal of Agricultural, Biological, and
Environmental Statistics 10: 226-245.</p>
<p>Legendre, P. 2009. Coefficient of concordance. In: Encyclopedia of
Research Design. SAGE Publications (in press).</p>
<p>Siegel, S. and N. J. Castellan, Jr. 1988. Nonparametric statistics for
the behavioral sciences. 2nd edition. McGraw-Hill, New York.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/cor.html'>cor</a></code>, <code><a href='https://rdrr.io/r/stats/friedman.test.html'>friedman.test</a></code>,
<code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>, <code><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></code>, <code><a href='https://rdrr.io/r/stats/kmeans.html'>kmeans</a></code>,
<code><a href='cascadeKM.html'>cascadeKM</a></code>, <code>indval</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mite</span>)
<span class='no'>mite.hel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='decostand.html'>decostand</a></span>(<span class='no'>mite</span>, <span class='st'>"hel"</span>)

<span class='co'># Reproduce the results shown in Table 2 of Legendre (2005), a single group</span>
<span class='no'>mite.small</span> <span class='kw'>&lt;-</span> <span class='no'>mite.hel</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>9</span>,<span class='fl'>14</span>,<span class='fl'>22</span>,<span class='fl'>31</span>,<span class='fl'>34</span>,<span class='fl'>45</span>,<span class='fl'>53</span>,<span class='fl'>61</span>,<span class='fl'>69</span>),<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>13</span>:<span class='fl'>15</span>,<span class='fl'>23</span>)]
<span class='fu'>kendall.global</span>(<span class='no'>mite.small</span>, <span class='kw'>nperm</span><span class='kw'>=</span><span class='fl'>49</span>)</div><div class='output co'>#&gt; $Concordance_analysis
#&gt;               Group.1
#&gt; W          0.44160305
#&gt; F          2.37252221
#&gt; Prob.F     0.04403791
#&gt; Chi2      15.89770992
#&gt; Prob.perm  0.06000000
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "kendall.global"</div><div class='input'><span class='fu'>kendall.post</span>(<span class='no'>mite.small</span>, <span class='kw'>mult</span><span class='kw'>=</span><span class='st'>"holm"</span>, <span class='kw'>nperm</span><span class='kw'>=</span><span class='fl'>49</span>)</div><div class='output co'>#&gt; $A_posteriori_tests
#&gt;                     TVEL      ONOV      SUCT   Trhypch1
#&gt; Spearman.mean  0.3265678 0.3965503 0.4570402 -0.1681251
#&gt; W.per.species  0.4949258 0.5474127 0.5927802  0.1239061
#&gt; Prob           0.0600000 0.0800000 0.0400000  0.7000000
#&gt; Corrected prob 0.1800000 0.1800000 0.1600000  0.7000000
#&gt; 
#&gt; $Correction.type
#&gt; [1] "holm"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "kendall.post"</div><div class='input'>
<span class='co'># Reproduce the results shown in Tables 3 and 4 of Legendre (2005), 2 groups</span>
<span class='no'>group</span> <span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>2</span>)
<span class='fu'>kendall.global</span>(<span class='no'>mite.hel</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>nperm</span><span class='kw'>=</span><span class='fl'>49</span>)</div><div class='output co'>#&gt; $Concordance_analysis
#&gt;                          Group.1      Group.2
#&gt; W                   3.097870e-01 2.911888e-01
#&gt; F                   1.032305e+01 4.108130e+00
#&gt; Prob.F              1.177138e-85 4.676566e-22
#&gt; Corrected prob.F    2.354275e-85 4.676566e-22
#&gt; Chi2                5.130073e+02 2.210123e+02
#&gt; Prob.perm           2.000000e-02 2.000000e-02
#&gt; Corrected prob.perm 4.000000e-02 4.000000e-02
#&gt; 
#&gt; $Correction.type
#&gt; [1] "holm"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "kendall.global"</div><div class='input'><span class='fu'>kendall.post</span>(<span class='no'>mite.hel</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>mult</span><span class='kw'>=</span><span class='st'>"holm"</span>, <span class='kw'>nperm</span><span class='kw'>=</span><span class='fl'>49</span>)</div><div class='output co'>#&gt; $A_posteriori_tests_Group
#&gt; $A_posteriori_tests_Group[[1]]
#&gt;                   Brachy      PHTH     RARD      SSTR   Protopl      MEGR
#&gt; Spearman.mean  0.1851177 0.4258111 0.359058 0.2505486 0.1802160 0.2833298
#&gt; W.per.species  0.2190711 0.4497357 0.385764 0.2817757 0.2143736 0.3131911
#&gt; Prob           0.0200000 0.0200000 0.020000 0.0200000 0.0200000 0.0200000
#&gt; Corrected prob 0.7000000 0.7000000 0.700000 0.7000000 0.7000000 0.7000000
#&gt;                      MPRO      HMIN     HMIN2      NPRA      TVEL      ONOV
#&gt; Spearman.mean  0.09248024 0.2444656 0.4138494 0.1263751 0.4177343 0.3301159
#&gt; W.per.species  0.13029357 0.2759462 0.4382723 0.1627761 0.4419954 0.3580278
#&gt; Prob           0.02000000 0.0200000 0.0200000 0.0400000 0.0200000 0.0200000
#&gt; Corrected prob 0.70000000 0.7000000 0.7000000 0.7000000 0.7000000 0.7000000
#&gt;                     SUCT Oribatl1      PWIL  Galumna1  Stgncrs2      HRUF
#&gt; Spearman.mean  0.2185421 0.421216 0.2574779 0.4180699 0.3623428 0.1250230
#&gt; W.per.species  0.2511028 0.445332 0.2884163 0.4423170 0.3889118 0.1614804
#&gt; Prob           0.0200000 0.020000 0.0200000 0.0200000 0.0200000 0.0400000
#&gt; Corrected prob 0.7000000 0.700000 0.7000000 0.7000000 0.7000000 0.7000000
#&gt;                     PPEL      SLAT      FSET  Lepidzts  Eupelops  Miniglmn
#&gt; Spearman.mean  0.2188216 0.3016159 0.4217606 0.2577037 0.1108022 0.2301430
#&gt; W.per.species  0.2513707 0.3307153 0.4458539 0.2886327 0.1478521 0.2622203
#&gt; Prob           0.0200000 0.0200000 0.0200000 0.0200000 0.1200000 0.0200000
#&gt; Corrected prob 0.7000000 0.7000000 0.7000000 0.7000000 0.7000000 0.7000000
#&gt; 
#&gt; $A_posteriori_tests_Group[[2]]
#&gt;                     HPAV      TVIE      LCIL  Ceratoz1  Trhypch1      NCOR
#&gt; Spearman.mean  0.1222579 0.2712078 0.1906408 0.1375601 0.1342409 0.3342345
#&gt; W.per.species  0.2020527 0.3374616 0.2642189 0.2159637 0.2129463 0.3947586
#&gt; Prob           0.0600000 0.0200000 0.0200000 0.0600000 0.0400000 0.0200000
#&gt; Corrected prob 0.7000000 0.7000000 0.7000000 0.7000000 0.7000000 0.7000000
#&gt;                     LRUG     PLAG2  Ceratoz3  Oppiminu  Trimalc2
#&gt; Spearman.mean  0.3446561 0.1833099 0.3188922 0.1764232 0.2498877
#&gt; W.per.species  0.4042328 0.2575544 0.3808111 0.2512938 0.3180797
#&gt; Prob           0.0200000 0.0200000 0.0200000 0.0200000 0.0200000
#&gt; Corrected prob 0.7000000 0.7000000 0.7000000 0.7000000 0.7000000
#&gt; 
#&gt; 
#&gt; $Correction.type
#&gt; [1] "holm"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "kendall.post"</div><div class='input'>
# NOTE: 'nperm' argument usually needs to be larger than 49.
# It was set to this low value for demonstration purposes.
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>F. Guillaume Blanchet, University of Alberta, and Pierre
  Legendre, Université de Montréal</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


