<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Weighted Averages Scores for Species — wascores • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weighted Averages Scores for Species — wascores"><meta name="description" content="Computes Weighted Averages scores of species for ordination
  configuration or for environmental variables."><meta property="og:description" content="Computes Weighted Averages scores of species for ordination
  configuration or for environmental variables."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Weighted Averages Scores for Species</h1>

      <div class="d-none name"><code>wascores.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes Weighted Averages scores of species for ordination
  configuration or for environmental variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wascores</span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span>, expand <span class="op">=</span> <span class="cn">FALSE</span>, stdev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">eigengrad</span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'wascores'</span></span>
<span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">x</span>, display <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wa"</span>, <span class="st">"stdev"</span>, <span class="st">"var"</span>, <span class="st">"se"</span>, <span class="st">"n2"</span>, <span class="st">"raw"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Environmental variables or ordination scores, or for
    <code>wascores</code> object with <code>stdev = TRUE</code>.</p></dd>

  <dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>Weights: species abundances.</p></dd>

  <dt id="arg-expand">expand<a class="anchor" aria-label="anchor" href="#arg-expand"></a></dt>
<dd><p>Expand weighted averages so that they have the same
    weighted variance as the corresponding environmental variables.</p></dd>

  <dt id="arg-stdev">stdev<a class="anchor" aria-label="anchor" href="#arg-stdev"></a></dt>
<dd><p>Estimate weighted standard deviation of WA scores.</p></dd>

  <dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>Type of scores returned.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to functions (currently ignored).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Weighted Averages are a classical way of estimating the species
  optima along continuous environmental variables
  (a.k.a. gradients). Function <code>wascores</code> is a simple function
  that is mainly designed to add species scores to unimodal
  ordinations (<code><a href="metaMDS.html">metaMDS</a></code>, <code><a href="sppscores.html">sppscores</a></code>) or
  ordering rows or columns to give diagonal pattern of tabulation
  (<code><a href="vegemite.html">vegemite</a></code>, <code><a href="vegemite.html">tabasco</a></code>). It can also be used
  to find species “optima” or sampling unit calibrations for
  community data. For this purpose, specialized packages such
  <span class="pkg">analogue</span> are recommended (but see
  <code><a href="predict.cca.html">calibrate.cca</a></code>).</p>
<p>First argument of <code>wascores</code> is the variable or a matrix of
  variables for which weighted averages are needed, and the second
  argument is the matrix of weights. In classical approaches weights are
  a community matrix, where taxon abundances define the weights. The
  number of rows must match. If the first argument is for taxa
  (columns), community weight matrix must be transposed.</p>
<p>Weighted averages “shrink”: they cannot be more extreme than
  values used for calculating the averages. With <code>expand = TRUE</code>,
  the function “deshrinks” the weighted averages making their
  weighted variance equal to the weighted variance of the
  corresponding input variable. Specialized packages (such as
  <span class="pkg">analogue</span>) offer a wider range of deshrinking alternatives, but
  deshrinking can also made after the analysis (see
  Examples). Function <code>eigengrad</code> returns the strength of
  expansion as attribute <code>shrinkage</code> of the <code>wascores</code>
  result for each environmental gradient.  The shrinkage equal to the
  constrained eigenvalue of <code><a href="cca.html">cca</a></code> when only this one
  gradient was used as a constraint, and describes the strength of the
  gradient.</p>
<p>With <code>stdev = TRUE</code> the function estimates the unbiased
  weighted standard deviation of the WA estimates using
  <code><a href="https://rdrr.io/r/stats/cov.wt.html" class="external-link">cov.wt</a></code>. For unbiased standard deviation the virtual
  number of observations is equal to inverse Simpson index of
  diversity also known as Hill number N2 (see
  <code><a href="diversity.html">diversity</a></code>). The numeric results can be accessed with
  <code>scores</code> function.  Function <code><a href="tolerance.html">tolerance</a></code> uses the
  same algebra for weighted standard deviation, but bases the variance
  on linear combination scores (constaints) variables instead of the
  weighted averages of the sites like <code>wascores</code>.</p>
<p>Weighted averages are closely linked to correspondence analysis
  (<code><a href="cca.html">ca</a></code>, <code><a href="cca.html">cca</a></code>). Repeated use of
  <code>wascores</code> will converge to the first axis of unconstrained
  correspondence analysis (<code><a href="cca.html">ca</a></code>) which therefore is also
  known as Reciprocal Averaging (Hill 1973). Constrained
  correspondence analysis (<code><a href="cca.html">cca</a></code>) is equivalent to
  weighted averages and <code><a href="predict.cca.html">calibrate.cca</a></code> will return
  weighted averages of the constraint with different deshrinking.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>stdev = TRUE</code>, function returns an object of class
  <code>"wascores"</code> with items</p>
<p></p>
<dl><dt>wa</dt>
<dd><p>A matrix of weighted averages with.  If
    <code>expand=TRUE</code>, attribute <code>shrinkage</code> has the inverses of
    squared expansion factors or <code><a href="cca.html">cca</a></code> eigenvalues for the
    variable and attribute <code>centre</code> for the weighted means of the
    variables.</p></dd>


  <dt>stdev</dt>
<dd><p>a matrix of weighted standard deviations</p></dd>

  <dt>n2</dt>
<dd><p>effective sample sizes which are equal to inverse Simpson
    diversity or Hill number N2</p></dd>


</dl><p>If <code>stdev = FALSE</code> (default), only the plain matrix <code>wa</code>
  is returned.  Function <code>eigengrad</code> returns only the
  <code>shrinkage</code> attribute. With <code>stdev = TRUE</code> only a brief
  summary of the result is printed, and the individvual scores can be
  accessed with <code>scores</code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="predict.cca.html">calibrate.cca</a></code>, <code><a href="tolerance.html">tolerance.cca</a></code>,
  <code><a href="sppscores.html">sppscores</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Hill, M.O. (1973) Reciprocal averaging: An eigenvector method of
  ordination. <em>Journal of Ecology</em> 61, 237–249.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span>, <span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## add species points to ordination</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="monoMDS.html">monoMDS</a></span><span class="op">(</span><span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## add species points; sppscores does the same and can also add the</span></span></span>
<span class="r-in"><span><span class="co">## species scores to mod</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu">wascores</span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>, <span class="va">mite</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, pch<span class="op">=</span><span class="st">"+"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="wascores-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Get taxon optima for WatrCont</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">wascores</span><span class="op">(</span><span class="va">mite.env</span><span class="op">$</span><span class="va">WatrCont</span>, <span class="va">mite</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Brachy  360.4302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PHTH    292.0329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HPAV    392.4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RARD    277.4195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSTR    359.1609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Protopl 248.4969</span>
<span class="r-in"><span><span class="co">## WA calibration: site WA from species WA; NB using transpose for site WA</span></span></span>
<span class="r-in"><span><span class="va">spwa</span> <span class="op">&lt;-</span> <span class="fu">wascores</span><span class="op">(</span><span class="va">mite.env</span><span class="op">$</span><span class="va">WatrCont</span>, <span class="va">mite</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wacalib</span> <span class="op">&lt;-</span> <span class="fu">wascores</span><span class="op">(</span><span class="va">spwa</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wacalib</span> <span class="op">~</span> <span class="va">WatrCont</span>, data<span class="op">=</span><span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="wascores-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## use traditional 'inverse' regression deshrinking instead of wascores</span></span></span>
<span class="r-in"><span><span class="co">## 'expand'</span></span></span>
<span class="r-in"><span><span class="va">wareg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">WatrCont</span> <span class="op">~</span> <span class="va">wacalib</span>, data<span class="op">=</span><span class="va">mite.env</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"WatrCont"</span> <span class="op">=</span> <span class="va">mite.env</span><span class="op">$</span><span class="va">WatrCont</span>, <span class="st">"expand"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">wacalib</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"regression"</span> <span class="op">=</span> <span class="va">wareg</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WatrCont   expand regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   350.15 418.9468   418.3084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   434.81 505.9779   484.6130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   371.72 481.1096   465.6672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   360.50 430.6437   427.2198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   204.13 210.6019   259.5811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   311.55 227.7218   272.6239</span>
<span class="r-in"><span><span class="co">## Reciprocal Averaging algorithm for Correspondence Analysis</span></span></span>
<span class="r-in"><span><span class="co">## start with random values</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## repeat the following steps so long that the shrinkage converges</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">wascores</span><span class="op">(</span><span class="va">u</span>, <span class="va">mite</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu">wascores</span><span class="op">(</span><span class="va">v</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">u</span>, <span class="st">"shrinkage"</span><span class="op">)</span> <span class="co"># current estimate of eigenvalue</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.07763647</span>
<span class="r-in"><span><span class="co">## The strengths of two continuous variables in the data set</span></span></span>
<span class="r-in"><span><span class="fu">eigengrad</span><span class="op">(</span><span class="va">mite.env</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SubsDens   WatrCont </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.09996798 0.39512786 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

