<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analysis of Similarities — anosim • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of Similarities — anosim"><meta name="description" content="Analysis of similarities (ANOSIM) provides a way to test statistically
  whether there is a significant difference between two or more groups
  of sampling units."><meta property="og:description" content="Analysis of similarities (ANOSIM) provides a way to test statistically
  whether there is a significant difference between two or more groups
  of sampling units."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis of Similarities</h1>

      <div class="d-none name"><code>anosim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Analysis of similarities (ANOSIM) provides a way to test statistically
  whether there is a significant difference between two or more groups
  of sampling units.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anosim</span><span class="op">(</span><span class="va">x</span>, <span class="va">grouping</span>, permutations <span class="op">=</span> <span class="fl">999</span>, distance <span class="op">=</span> <span class="st">"bray"</span>, strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Data matrix or data frame in which rows are samples and
    columns are response variable(s), or a dissimilarity object or a
    symmetric square matrix of dissimilarities.</p></dd>

  <dt id="arg-grouping">grouping<a class="anchor" aria-label="anchor" href="#arg-grouping"></a></dt>
<dd><p>Factor for grouping observations.</p></dd>

  <dt id="arg-permutations">permutations<a class="anchor" aria-label="anchor" href="#arg-permutations"></a></dt>
<dd><p>a list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the
    number of permutations required, or a permutation matrix where each
    row gives the permuted indices.</p></dd>

  <dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>Choice of distance metric that measures the
    dissimilarity between two observations. See <code><a href="vegdist.html">vegdist</a></code> for
    options.  This will be used if <code>x</code> was not a dissimilarity
    structure or a symmetric square matrix.</p></dd>

  <dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>An integer vector or factor specifying the strata for
    permutation. If supplied, observations are permuted only within the
    specified strata.</p></dd>

  <dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Analysis of similarities (ANOSIM) provides a way to test statistically
  whether there is a significant difference between two or more groups
  of sampling units.  Function <code>anosim</code> operates directly on a
  dissimilarity matrix.  A suitable dissimilarity matrix is produced by
  functions <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> or <code><a href="vegdist.html">vegdist</a></code>.  The
  method is philosophically allied with NMDS ordination
  (<code><a href="monoMDS.html">monoMDS</a></code>), in that it uses only the rank order of
  dissimilarity values.</p>
<p>If two groups of sampling units are really different in their species
  composition, then compositional dissimilarities between the groups
  ought to be greater than those within the groups.  The <code>anosim</code>
  statistic \(R\) is based on the difference of mean ranks between
  groups (\(r_B\)) and within groups (\(r_W\)):</p>
<p>$$R = (r_B - r_W)/(N (N-1) / 4)$$</p>
<p>The divisor is chosen so that \(R\) will be in the interval
  \(-1 \dots +1\), value \(0\) indicating completely random
  grouping.</p>
<p>The statistical significance of observed \(R\) is assessed by
  permuting the grouping vector to obtain the empirical distribution
  of \(R\) under null-model.  See <code><a href="permutations.html">permutations</a></code> for
  additional details on permutation tests in Vegan. The distribution
  of simulated values can be inspected with the <code><a href="permustats.html">permustats</a></code>
  function.</p>
<p>The function has <code>summary</code> and <code>plot</code> methods.  These both
  show valuable information to assess the validity of the method:  The
  function assumes that all ranked dissimilarities within groups
  have about equal median and range.  The <code>plot</code> method uses
  <code><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></code> with options <code>notch=TRUE</code> and
  <code>varwidth=TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a list of class <code>"anosim"</code> with following
  items:</p>
<dl><dt>call </dt>
<dd><p>Function call.</p></dd>

  <dt>statistic</dt>
<dd><p>The value of ANOSIM statistic \(R\)</p></dd>

  <dt>signif</dt>
<dd><p>Significance from permutation.</p></dd>

  <dt>perm</dt>
<dd><p>Permutation values of \(R\). The distribution of
    permutation values can be inspected with function <code><a href="permustats.html">permustats</a></code>.</p></dd>

  <dt>class.vec</dt>
<dd><p>Factor with value <code>Between</code> for dissimilarities
    between classes and class name for corresponding dissimilarity
    within class.</p></dd>

  <dt>dis.rank</dt>
<dd><p>Rank of dissimilarity entry.</p></dd>

  <dt>dissimilarity</dt>
<dd><p>The name of the dissimilarity index: the
    <code>"method"</code> entry of the <code>dist</code> object.</p></dd>

  <dt>control</dt>
<dd><p>A list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Clarke, K. R. (1993). Non-parametric multivariate analysis of changes
  in community structure. <em>Australian Journal of Ecology</em> 18,
  117–143.</p>
<p>Warton, D.I., Wright, T.W., Wang, Y. 2012. Distance-based multivariate
  analyses confound location and dispersion effects. <em>Methods in
  Ecology and Evolution</em>, 3, 89–101</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen, with a help from Peter R. Minchin.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>


<p>The <code>anosim</code> function can confound the differences between groups
  and dispersion within groups and the results can be difficult to
  interpret (cf. Warton et al. 2012).  The function returns a lot of
  information to ease studying its performance. Most <code>anosim</code>
  models could be analysed with <code><a href="adonis.html">adonis2</a></code> which seems to be a
  more robust alternative.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mrpp.html">mrpp</a></code> for a similar function using original
dissimilarities instead of their ranks.
<code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> and <code><a href="vegdist.html">vegdist</a></code> for obtaining
  dissimilarities, and <code><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></code> for ranking real values.  For
  comparing dissimilarities against continuous variables, see
  <code><a href="mantel.html">mantel</a></code>. Function <code><a href="adonis.html">adonis2</a></code> is a more robust
  alternative that should preferred.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dune.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dune.ano</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu">anosim</span><span class="op">(</span><span class="va">dune.dist</span>, <span class="va">Management</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dune.ano</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim(x = dune.dist, grouping = Management) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dissimilarity: bray </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANOSIM statistic R: 0.2579 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Significance: 0.009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper quantiles of permutations (null model):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   90%   95% 97.5%   99% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.121 0.164 0.205 0.242 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dissimilarity ranks between and within classes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0%   25%    50%     75%  100%   N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Between  4 58.50 104.00 145.500 188.0 147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BF       5 15.25  25.50  41.250  57.0   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HF       1  7.25  46.25  68.125  89.5  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NM       6 64.75 124.50 156.250 181.0  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SF       3 32.75  53.50  99.250 184.0  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dune.ano</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>some notches went outside hinges ('box'): maybe set notch=FALSE</span>
<span class="r-plt img"><img src="anosim-1.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

