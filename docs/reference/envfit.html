<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="

The function fits environmental vectors or factors onto an
  ordination. The projections of points onto vectors have maximum
  correlation with corresponding environmental variables, and the
  factors show the averages of factor levels. For continuous varaibles
  this is equal to fitting a linear trend surface (plane in 2D) for a
  variable (see ordisurf); this trend surface can be
  presented by showing its gradient (direction of steepest increase)
  using an arrow. The environmental variables are the dependent
  variables that are explained by the ordination scores, and each
  dependent variable is analysed separately."><title>Fits an Environmental Vector or Factor onto an Ordination — envfit • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fits an Environmental Vector or Factor onto an Ordination — envfit"><meta property="og:description" content="

The function fits environmental vectors or factors onto an
  ordination. The projections of points onto vectors have maximum
  correlation with corresponding environmental variables, and the
  factors show the averages of factor levels. For continuous varaibles
  this is equal to fitting a linear trend surface (plane in 2D) for a
  variable (see ordisurf); this trend surface can be
  presented by showing its gradient (direction of steepest increase)
  using an arrow. The environmental variables are the dependent
  variables that are explained by the ordination scores, and each
  dependent variable is analysed separately."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fits an Environmental Vector or Factor onto an Ordination</h1>
      
      <div class="d-none name"><code>envfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    

<p>The function fits environmental vectors or factors onto an
  ordination. The projections of points onto vectors have maximum
  correlation with corresponding environmental variables, and the
  factors show the averages of factor levels. For continuous varaibles
  this is equal to fitting a linear trend surface (plane in 2D) for a
  variable (see <code><a href="ordisurf.html">ordisurf</a></code>); this trend surface can be
  presented by showing its gradient (direction of steepest increase)
  using an arrow. The environmental variables are the dependent
  variables that are explained by the ordination scores, and each
  dependent variable is analysed separately.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu">envfit</span><span class="op">(</span><span class="va">ord</span>, <span class="va">env</span>, permutations <span class="op">=</span> <span class="fl">999</span>, strata <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>   choices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,  display <span class="op">=</span> <span class="st">"sites"</span>, w  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights</a></span><span class="op">(</span><span class="va">ord</span>, <span class="va">display</span><span class="op">)</span>,</span>
<span>   na.rm <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">envfit</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for envfit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">labels</span>, <span class="va">arrow.mul</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>   axis <span class="op">=</span> <span class="cn">FALSE</span>, p.max <span class="op">=</span> <span class="cn">NULL</span>, col <span class="op">=</span> <span class="st">"blue"</span>, <span class="va">bg</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for envfit</span></span>
<span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">display</span>, <span class="va">choices</span>, arrow.mul<span class="op">=</span><span class="fl">1</span>, tidy <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">vectorfit</span><span class="op">(</span><span class="va">X</span>, <span class="va">P</span>, permutations <span class="op">=</span> <span class="fl">0</span>, strata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">w</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">factorfit</span><span class="op">(</span><span class="va">X</span>, <span class="va">P</span>, permutations <span class="op">=</span> <span class="fl">0</span>, strata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">w</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ord</dt>
<dd><p>An ordination object or other structure from which the
    ordination <code><a href="scores.html">scores</a></code> can be extracted (including a data
    frame or matrix of scores).</p></dd>

  <dt>env</dt>
<dd><p>Data frame, matrix or vector of environmental
    variables. The variables can be of mixed type (factors, continuous
    variables) in data frames.</p></dd>

  <dt>X</dt>
<dd><p>Matrix or data frame of ordination scores.</p></dd>

  <dt>P</dt>
<dd><p>Data frame, matrix or vector of environmental
    variable(s). These must be continuous for <code>vectorfit</code> and
    factors or characters for <code>factorfit</code>.</p></dd>

  <dt>permutations</dt>
<dd><p>a list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the
    number of permutations required, or a permutation matrix where each
    row gives the permuted indices. Set <code>permutations = 0</code> to skip
    permutations.</p></dd>

  <dt>formula, data</dt>
<dd><p>Model  <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> and data.</p></dd>

  <dt>na.rm</dt>
<dd><p>Remove points with missing values in ordination scores
    or environmental variables. The operation is casewise: the whole
    row of data is removed if there is a missing value and 
    <code>na.rm = TRUE</code>.</p></dd>

    
  <dt>x</dt>
<dd><p>A result object from <code>envfit</code>. For <code>ordiArrowMul</code>
    and <code>ordiArrowTextXY</code> this must be a two-column matrix (or
    matrix-like object) containing the coordinates of arrow heads on
    the two plot axes, and other methods extract such a structure from
    the <code>envfit</code> results.</p></dd>

    
  <dt>choices</dt>
<dd><p>Axes to plotted.</p></dd>

  <dt>tidy</dt>
<dd><p>Return scores that are compatible with <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><span class="pkg">ggplot2</span></a>:
    all scores are in a single <code>data.frame</code>, score type is
    identified by factor variable <code>scores</code> (<code>"vectors"</code> or
    <code>"factors"</code>), the names by variable <code>label</code>. These scores
    are incompatible with conventional <code>plot</code> functions, but they can
    be used in <span class="pkg">ggplot2</span>.</p></dd>

    
  <dt>labels</dt>
<dd><p>Change plotting labels. The argument should be a list
    with elements <code>vectors</code> and <code>factors</code> which give the new
    plotting labels. If either of these elements is omitted, the
    default labels will be used. If there is only one type of elements
    (only <code>vectors</code> or only <code>factors</code>), the labels can be
    given as vector. The default labels can be displayed with
    <code>labels</code> command.</p></dd>

  <dt>arrow.mul</dt>
<dd><p>Multiplier for vector lengths. The arrows are
    automatically scaled similarly as in <code><a href="plot.cca.html">plot.cca</a></code> if this
    is not given in <code>plot</code> and <code>add = TRUE</code>. However, in
    <code>scores</code> it can be used to adjust arrow lengths when the
    <code>plot</code> function is not used.</p></dd>

  <dt>at</dt>
<dd><p>The origin of fitted arrows in the plot.  If you plot arrows
    in other places then origin, you probably have to specify
    <code>arrrow.mul</code>.</p></dd>

  <dt>axis</dt>
<dd><p>Plot axis showing the scaling of fitted arrows.</p></dd>

  <dt>p.max</dt>
<dd><p>Maximum estimated \(P\) value for displayed
    variables.  You must calculate \(P\) values with setting
    <code>permutations</code> to use this option.</p></dd>

  <dt>col</dt>
<dd><p>Colour in plotting.</p></dd>

  <dt>bg</dt>
<dd><p>Background colour for labels. If <code>bg</code> is set, the
    labels are displayed with <code><a href="ordilabel.html">ordilabel</a></code> instead of
    <code>text</code>. See Examples for using semitransparent background.</p></dd>

  <dt>add</dt>
<dd><p>Results added to an existing ordination plot.</p></dd>

  <dt>strata</dt>
<dd><p>An integer vector or factor specifying the strata for
    permutation. If supplied, observations are permuted only within the
    specified strata.</p></dd>

  <dt>display</dt>
<dd><p>In fitting functions these are ordinary site scores or
    linear combination scores 
    (<code>"lc"</code>) in constrained ordination (<code><a href="cca.html">cca</a></code>,
    <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code>). In <code>scores</code>
    function they are either <code>"vectors"</code> or <code>"factors"</code>
    (with synonyms <code>"bp"</code> or <code>"cn"</code>, resp.).</p></dd>

  <dt>w</dt>
<dd><p>Weights used in fitting (concerns mainly <code><a href="cca.html">cca</a></code>
    and <code><a href="decorana.html">decorana</a></code> results which have nonconstant weights).</p></dd>


  <dt>...</dt>
<dd><p>Parameters passed to <code><a href="scores.html">scores</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function <code>envfit</code> finds vectors or factor averages of
  environmental variables.  Function <code>plot.envfit</code> adds these in an
  ordination diagram.  If <code>X</code> is a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>,
  <code>envfit</code>
  uses <code>factorfit</code> for <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></code> variables and
  <code>vectorfit</code> for other variables.  If <code>X</code> is a matrix or a
  vector, <code>envfit</code> uses only <code>vectorfit</code>. Alternatively, the
  model can be defined a simplified model <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>, where
  the left hand side must be an ordination result object or a matrix of
  ordination scores, and right hand
  side lists the environmental variables. The formula interface can be
  used for easier selection and/or transformation of environmental
  variables. Only the main effects will be analysed even if interaction
  terms were defined in the formula.</p>
<p>The ordination results are extracted with <code><a href="scores.html">scores</a></code> and
  all extra arguments are passed to the <code>scores</code>. The fitted
  models only apply to the results defined when extracting the scores
  when using <code>envfit</code>. For instance, <code>scaling</code> in
  constrained ordination (see <code><a href="plot.cca.html">scores.rda</a></code>,
  <code><a href="plot.cca.html">scores.cca</a></code>) must be set in the same way in
  <code>envfit</code> and in the <code>plot</code> or the ordination results (see
  Examples).</p>
<p>The printed output of continuous variables (vectors) gives the
  direction cosines which are the coordinates of the heads of unit
  length vectors.  In <code>plot</code> these are scaled by their
  correlation (square root of the column <code>r2</code>) so that
  “weak” predictors have shorter arrows than “strong”
  predictors.  You can see the scaled relative lengths using command
  <code>scores</code>.  The <code>plot</code>ted (and scaled) arrows are further
  adjusted to the current graph using a constant multiplier: this will
  keep the relative <code>r2</code>-scaled lengths of the arrows but tries
  to fill the current plot.  You can see the multiplier using
  <code>ordiArrowMul(result_of_envfit)</code>, and set it with the
  argument <code>arrow.mul</code>.</p>  
<p>Functions <code>vectorfit</code> and <code>factorfit</code> can be called directly.
  Function <code>vectorfit</code> finds directions in the ordination space
  towards which the environmental vectors change most rapidly and to
  which they have maximal correlations with the ordination
  configuration.  Function <code>factorfit</code> finds averages of ordination
  scores for factor levels. Function <code>factorfit</code> treats ordered
  and unordered factors similarly.</p>
<p>If <code>permutations</code> \(&gt; 0\), the significance of fitted vectors
  or factors is assessed using permutation of environmental variables.
  The goodness of fit statistic is squared correlation coefficient
  (\(r^2\)).
  For factors this is defined as \(r^2 = 1 - ss_w/ss_t\), where
  \(ss_w\) and \(ss_t\) are within-group and total sums of
  squares. See <code><a href="permutations.html">permutations</a></code> for additional details on
  permutation tests in Vegan.</p>
<p>User can supply a vector of prior weights <code>w</code>. If the ordination
  object has weights, these will be used. In practise this means that
  the row totals are used as weights with <code><a href="cca.html">cca</a></code> or
  <code><a href="decorana.html">decorana</a></code> results. If you do not like this, but want to
  give equal weights to all sites, you should set <code>w = NULL</code>.  The
  fitted vectors are similar to biplot arrows in constrained ordination
  only when fitted to LC scores (<code>display = "lc"</code>) and you set
  <code>scaling = "species"</code> (see <code><a href="plot.cca.html">scores.cca</a></code>).  The
  weighted fitting gives similar results to biplot arrows and class
  centroids in <code><a href="cca.html">cca</a></code>.</p>
<p>The lengths of arrows for fitted vectors are automatically adjusted
  for the physical size of the plot, and the arrow lengths cannot be
  compared across plots. For similar scaling of arrows, you must
  explicitly set the <code>arrow.mul</code> argument in the <code>plot</code>
  command; see <code><a href="ordiArrowTextXY.html">ordiArrowMul</a></code> and
  <code><a href="ordiArrowTextXY.html">ordiArrowTextXY</a></code>.</p>  
<p>The results can be accessed with <code>scores.envfit</code> function which
  returns either the fitted vectors scaled by correlation coefficient or
  the centroids of the fitted environmental variables, or a named list
  of both.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Functions <code>vectorfit</code> and <code>factorfit</code> return lists of
  classes <code>vectorfit</code> and <code>factorfit</code> which have a</p>
<p></p>
<p><code>print</code> method.  The result object have the following items:</p>
<dl><dt>arrows</dt>
<dd><p>Arrow endpoints from <code>vectorfit</code>. The arrows are
    scaled to unit length.</p></dd>

  <dt>centroids</dt>
<dd><p>Class centroids from <code>factorfit</code>.</p></dd>

  <dt>r</dt>
<dd><p>Goodness of fit statistic: Squared correlation coefficient</p></dd>

  <dt>permutations</dt>
<dd><p>Number of permutations.</p></dd>

  <dt>control</dt>
<dd><p>A list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>.</p></dd>

  <dt>pvals</dt>
<dd><p>Empirical P-values for each variable.</p></dd>


</dl><p>Function <code>envfit</code> returns a list of class <code>envfit</code> with
  results of <code>vectorfit</code> and <code>envfit</code> as items.</p>
  

<p>Function <code>plot.envfit</code> scales the vectors by correlation.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen.  The permutation test derives from the code
  suggested by Michael Scroggie.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Fitted vectors have become the method of choice in displaying
  environmental variables in ordination.  Indeed, they are the optimal
  way of presenting environmental variables in Constrained
  Correspondence Analysis <code><a href="cca.html">cca</a></code>, since there they are the
  linear constraints.
  In unconstrained ordination the relation between external variables
  and ordination configuration may be less linear, and therefore other
  methods than arrows may be more useful.  The simplest is to adjust the
  plotting symbol sizes (<code>cex</code>, <code><a href="https://rdrr.io/r/graphics/symbols.html" class="external-link">symbols</a></code>) by
  environmental variables.
  Fancier methods involve smoothing and regression methods that
  abound in <span style="R">R</span>, and <code><a href="ordisurf.html">ordisurf</a></code> provides a wrapper for some.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>A better alternative to vectors may be <code><a href="ordisurf.html">ordisurf</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span>, <span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Square root transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wisconsin double standardization</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 0 stress 0.1843196 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 1 stress 0.2276827 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 2 stress 0.2204286 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 3 stress 0.1967393 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 4 stress 0.2066032 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 5 stress 0.2234314 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 6 stress 0.1869637 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 7 stress 0.18584 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 8 stress 0.18458 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 0.04935318  max resid 0.1575045 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 9 stress 0.2178486 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 10 stress 0.195049 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 11 stress 0.2300388 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 12 stress 0.1948413 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 13 stress 0.1955836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 14 stress 0.2390981 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 15 stress 0.2229031 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 16 stress 0.1825658 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... New best solution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 0.04162605  max resid 0.1518104 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 17 stress 0.2390411 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 18 stress 0.1825658 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 1.358437e-05  max resid 2.641802e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Similar to previous best</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 19 stress 0.2092456 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 20 stress 0.1982376 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Best solution repeated 1 times</span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">envfit</span><span class="op">(</span><span class="va">ord</span>, <span class="va">varechem</span>, perm <span class="op">=</span> <span class="fl">999</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***VECTORS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             NMDS1    NMDS2     r2 Pr(&gt;r)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N        -0.05732 -0.99836 0.2536  0.046 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P         0.61973  0.78481 0.1938  0.093 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K         0.76646  0.64229 0.1809  0.121    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ca        0.68520  0.72835 0.4119  0.008 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mg        0.63253  0.77454 0.4270  0.004 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S         0.19140  0.98151 0.1752  0.123    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Al       -0.87159  0.49023 0.5269  0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fe       -0.93602  0.35195 0.4451  0.002 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mn        0.79871 -0.60172 0.5231  0.002 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Zn        0.61756  0.78652 0.1879  0.107    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mo       -0.90306  0.42951 0.0609  0.539    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Baresoil  0.92488 -0.38025 0.2508  0.041 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Humdepth  0.93283 -0.36032 0.5201  0.002 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pH       -0.64798  0.76165 0.2308  0.070 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"vectors"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                NMDS1      NMDS2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N        -0.02886657 -0.5027884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P         0.27284738  0.3455254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K         0.32602389  0.2732093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ca        0.43973450  0.4674260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mg        0.41334179  0.5061403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S         0.08011287  0.4108193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Al       -0.63269483  0.3558584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fe       -0.62444176  0.2347947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mn        0.57765881 -0.4351900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Zn        0.26771371  0.3409563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mo       -0.22293623  0.1060315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Baresoil  0.46316234 -0.1904201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Humdepth  0.67271099 -0.2598473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pH       -0.31130599  0.3659163</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, p.max <span class="op">=</span> <span class="fl">0.05</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="envfit-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Adding fitted arrows to CCA. We use "lc" scores, and hope</span></span></span>
<span class="r-in"><span><span class="co">## that arrows are scaled similarly in cca and envfit plots</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">Al</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span> <span class="va">K</span>, <span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord</span>, type<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">envfit</span><span class="op">(</span><span class="va">ord</span>, <span class="va">varechem</span>, perm <span class="op">=</span> <span class="fl">999</span>, display <span class="op">=</span> <span class="st">"lc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, p.max <span class="op">=</span> <span class="fl">0.05</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="envfit-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## 'scaling' must be set similarly in envfit and in ordination plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord</span>, type <span class="op">=</span> <span class="st">"p"</span>, scaling <span class="op">=</span> <span class="st">"sites"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">envfit</span><span class="op">(</span><span class="va">ord</span>, <span class="va">varechem</span>, perm <span class="op">=</span> <span class="fl">0</span>, display <span class="op">=</span> <span class="st">"lc"</span>, scaling <span class="op">=</span> <span class="st">"sites"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="envfit-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Class variables, formula interface, and displaying the</span></span></span>
<span class="r-in"><span><span class="co">## inter-class variability with ordispider, and semitransparent</span></span></span>
<span class="r-in"><span><span class="co">## white background for labels (semitransparent colours are not</span></span></span>
<span class="r-in"><span><span class="co">## supported by all graphics devices)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">envfit</span><span class="op">(</span><span class="va">ord</span> <span class="op">~</span> <span class="va">Moisture</span> <span class="op">+</span> <span class="va">A1</span>, <span class="va">dune.env</span>, perm <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord</span>, type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu"><a href="ordihull.html">ordispider</a></span><span class="op">(</span><span class="va">ord</span>, <span class="va">Moisture</span>, col<span class="op">=</span><span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ord</span>, display <span class="op">=</span> <span class="st">"sites"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Moisture</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, cex<span class="op">=</span><span class="fl">1.2</span>, axis<span class="op">=</span><span class="cn">TRUE</span>, bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="envfit-4.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Use shorter labels for factor centroids</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $factors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Moisture1" "Moisture2" "Moisture4" "Moisture5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>factors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="envfit-5.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

