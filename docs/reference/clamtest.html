<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The CLAM statistical approach for classifying generalists and
specialists in two distinct habitats is described in Chazdon et al. (2011)."><title>Multinomial Species Classification Method (CLAM) — clamtest • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multinomial Species Classification Method (CLAM) — clamtest"><meta property="og:description" content="The CLAM statistical approach for classifying generalists and
specialists in two distinct habitats is described in Chazdon et al. (2011)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multinomial Species Classification Method (CLAM)</h1>
      
      <div class="d-none name"><code>clamtest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The CLAM statistical approach for classifying generalists and
specialists in two distinct habitats is described in Chazdon et al. (2011).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clamtest</span><span class="op">(</span><span class="va">comm</span>, <span class="va">groups</span>, coverage.limit <span class="op">=</span> <span class="fl">10</span>, specialization <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, </span>
<span>   npoints <span class="op">=</span> <span class="fl">20</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co"># S3 method for clamtest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for clamtest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">xlab</span>, <span class="va">ylab</span>, <span class="va">main</span>,  pch <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">24</span>, col.points <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, </span>
<span>   col.lines <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, position <span class="op">=</span> <span class="st">"bottomright"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>comm</dt>
<dd><p>Community matrix, consisting of counts.</p></dd>

  <dt>groups</dt>
<dd><p>A vector identifying the two habitats. Must have exactly
two unique values or levels. Habitat IDs in the grouping vector
must match corresponding rows in the community matrix <code>comm</code>.</p></dd>

  <dt>coverage.limit</dt>
<dd><p>Integer, the sample coverage based correction 
is applied to rare species with counts below this limit. 
Sample coverage is calculated separately 
for the two habitats. Sample relative abundances are used for species 
with higher than or equal to <code>coverage.limit</code> total counts per habitat.</p></dd>

  <dt>specialization</dt>
<dd><p>Numeric, specialization threshold value between 0 and 1.
The value of \(2/3\) represents ‘supermajority’ rule,
while a value of \(1/2\) represents a ‘simple majority’ rule
to assign shared species as habitat specialists.</p></dd>

  <dt>npoints</dt>
<dd><p>Integer, number of points used to determine the boundary lines
in the plots.</p></dd>

<dt>alpha</dt>
<dd><p>Numeric, nominal significance level for individual
  tests.  The default value reduces the conventional limit of
  \(0.05\) to account for overdispersion and multiple testing for
  several species simultaneously. However, the is no firm reason for
  exactly this limit.</p></dd>

  <dt>x, object</dt>
<dd><p>Fitted model object of class <code>"clamtest"</code>.</p></dd>

  <dt>xlab, ylab</dt>
<dd><p>Labels for the plot axes.</p></dd>

  <dt>main</dt>
<dd><p>Main title of the plot.</p></dd>

  <dt>pch, col.points</dt>
<dd><p>Symbols and colors used in plotting species groups.</p></dd>

  <dt>lty, col.lines</dt>
<dd><p>Line types and colors for boundary lines in plot to separate species groups.</p></dd>

  <dt>position</dt>
<dd><p>Position of figure legend, see <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></code> for specification details.
Legend not shown if <code>position = NULL</code>.</p></dd>

  <dt>...</dt>
<dd><p>Additional arguments passed to methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The method uses a multinomial model based on estimated
  species relative abundance in two habitats (A, B). It minimizes bias
  due to differences in sampling intensities between two habitat types
  as well as bias due to insufficient sampling within each
  habitat. The method permits a robust statistical classification of
  habitat specialists and generalists, without excluding rare species
  <em>a priori</em> (Chazdon et al. 2011).  Based on a user-defined
  <code>specialization</code> threshold, the model classifies species into
  one of four groups: (1) generalists; (2) habitat A specialists; (3)
  habitat B specialists; and (4) too rare to classify with confidence.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame (with class attribute <code>"clamtest"</code>),
  with columns:</p>
<dl><dt><code>Species</code>:</dt>
<dd><p>species name (column names from <code>comm</code>),</p></dd>
 
    <dt><code>Total_*A*</code>:</dt>
<dd><p>total count in habitat A,</p></dd>
 
    <dt><code>Total_*B*</code>:</dt>
<dd><p>total count in habitat B,</p></dd>
 
    <dt><code>Classes</code>:</dt>
<dd><p>species classification, a factor with
       levels <code>Generalist</code>, <code>Specialist_*A*</code>,
       <code>Specialist_*B*</code>, and <code>Too_rare</code>.</p></dd>
  

  </dl><p><code>*A*</code> and <code>*B*</code> are placeholders for habitat names/labels found in the
  data.</p>


<p>The <code>summary</code> method returns descriptive statistics of the results.
The <code>plot</code> method returns values invisibly and produces a bivariate
scatterplot of species total abundances in the two habitats. Symbols and
boundary lines are shown for species groups.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chazdon, R. L., Chao, A., Colwell, R. K., Lin, S.-Y., Norden, N., 
Letcher, S. G., Clark, D. B., Finegan, B. and Arroyo J. P.(2011). 
A novel statistical method for classifying habitat
generalists and specialists. <em>Ecology</em> <b>92</b>, 1332--1343.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Peter Solymos <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The code was tested against standalone CLAM software provided
on the website of Anne Chao (which were then at http://chao.stat.nthu.edu.tw/wordpress);
minor inconsistencies were found, especially for finding the
threshold for 'too rare' species.
These inconsistencies are probably due to numerical differences between the
two implementation. The current <span style="R">R</span> implementation uses 
root finding for iso-lines instead of iterative search.</p>
<p>The original method (Chazdon et al. 2011) has two major problems:</p><ol><li><p>It assumes that the error distribution is multinomial. This is
    a justified choice if individuals are freely distributed, and
    there is no over-dispersion or clustering of individuals. In most
    ecological data, the variance is much higher than multinomial
    assumption, and therefore test statistic are too optimistic.</p></li>
<li><p>The original authors suggest that multiple testing adjustment
    for multiple testing should be based on the number of points
    (<code>npoints</code>) used to draw the critical lines on the plot,
    whereas the adjustment should be based on the number of tests (i.e.,
    tested species). The function uses the same numerical values as
    the original paper, but there is no automatic connection between
    <code>npoints</code> and <code>alpha</code> arguments, but you must work out
    the adjustment yourself.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mite.env</span>, <span class="fu">clamtest</span><span class="op">(</span><span class="va">mite</span>, <span class="va">Shrub</span><span class="op">==</span><span class="st">"None"</span>, alpha<span class="op">=</span><span class="fl">0.005</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Two Groups Species Classification Method (CLAM)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Specialization threshold = 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alpha level = 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated sample coverage:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  FALSE   TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.0000 0.9996 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum abundance for classification:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FALSE  TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    27     9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Species Proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalist            10      0.286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Specialist_FALSE      14      0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Specialist_TRUE        4      0.114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Too_rare               7      0.200</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Species Total_FALSE Total_TRUE          Classes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Brachy         534         77       Generalist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    PHTH          89          0 Specialist_FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    HPAV         389        207       Generalist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    RARD          85          0 Specialist_FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    SSTR          22          0         Too_rare</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Protopl          26          0         Too_rare</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="clamtest-1.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

