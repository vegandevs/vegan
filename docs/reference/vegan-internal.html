<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Internal vegan functions that are not intended to be called directly,
  but only within other functions."><title>Internal vegan functions — vegan-internal • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Internal vegan functions — vegan-internal"><meta property="og:description" content="Internal vegan functions that are not intended to be called directly,
  but only within other functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Internal vegan functions</h1>
      
      <div class="d-none name"><code>vegan-internal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Internal vegan functions that are not intended to be called directly,
  but only within other functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ordiParseFormula</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, xlev <span class="op">=</span> <span class="cn">NULL</span>,  na.action <span class="op">=</span> <span class="va">na.fail</span>,</span>
<span>    subset <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">X</span><span class="op">)</span></span>
<span><span class="fu">ordiTerminfo</span><span class="op">(</span><span class="va">d</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu">ordiNAexclude</span><span class="op">(</span><span class="va">x</span>, <span class="va">excluded</span><span class="op">)</span></span>
<span><span class="fu">ordiNApredict</span><span class="op">(</span><span class="va">omit</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">ordiArgAbsorber</span><span class="op">(</span><span class="va">...</span>, <span class="va">shrink</span>, <span class="va">origin</span>, <span class="va">scaling</span>, <span class="va">triangular</span>,</span>
<span>                <span class="va">display</span>, <span class="va">choices</span>, <span class="va">const</span>, <span class="va">truemean</span>, <span class="va">FUN</span><span class="op">)</span></span>
<span><span class="fu">centroids.cca</span><span class="op">(</span><span class="va">x</span>, <span class="va">mf</span>, <span class="va">wt</span><span class="op">)</span></span>
<span><span class="fu">getPermuteMatrix</span><span class="op">(</span><span class="va">perm</span>, <span class="va">N</span>, strata <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">howHead</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">pasteCall</span><span class="op">(</span><span class="va">call</span>, prefix <span class="op">=</span> <span class="st">"Call:"</span><span class="op">)</span></span>
<span><span class="fu">veganCovEllipse</span><span class="op">(</span><span class="va">cov</span>, center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">1</span>, npoints <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu">veganMahatrans</span><span class="op">(</span><span class="va">x</span>, <span class="va">s2</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">hierParseFormula</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu">GowerDblcen</span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">addLingoes</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="fu">addCailliez</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The description here is only intended for <span class="pkg">vegan</span>
  developers: these functions are not intended for users, but they
  only should be used within functions.  In general, these functions
  are not exported to the namespace, but you must use
  <code><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></code> or <code><a href="https://rdrr.io/r/base/ns-dblcolon.html" class="external-link">:::</a></code> to directly call these
  functions.</p>  
<p><code>ordiParseFormula</code> returns a list of three matrices (dependent
  variables, and <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></code> of constraints and
  conditions, possibly <code>NULL</code>) needed in constrained
  ordination. Argument <code>xlev</code> is passed to
  <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></code>. If the left-hand-side was already
  evaluated in calling code, it can be given as argument <code>X</code> and
  will not be re-evaluated. <code>ordiTermInfo</code> finds the term
  information for constrained ordination as described in
  <code><a href="cca.object.html">cca.object</a></code>. <code>ordiNAexclude</code> implements
  <code>na.action = na.exclude</code> for constrained ordination finding WA
  scores of CCA components and site scores of unconstrained component
  from <code>excluded</code> rows of observations. Function
  <code>ordiNApredict</code> pads the result object with these or with WA
  scores similarly as <code><a href="https://rdrr.io/r/stats/nafns.html" class="external-link">napredict</a></code>.</p>
<p><code>ordiArgAbsorber</code> absorbs arguments of <code><a href="scores.html">scores</a></code>
  function of <span class="pkg">vegan</span> so that these do not cause superfluous
  warnings in graphical function <code>FUN</code>. If you implement
  <code>scores</code> functions with new arguments, you should update
  <code>ordiArgAbsorber</code>.</p>
<p><code>centroids.cca</code> finds the weighted centroids of variables.</p>
<p><code>getPermuteMatrix</code> interprets user input and returns a
  permutation matrix where each row gives indices of observations for
  a permutation. The input <code>perm</code> can be a single number for the
  number of simple permutations, a result of
  <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code> defining a permutation scheme or a
  permutation matrix.</p>
<p><code>howHead</code> formats the permutation scheme of
  <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code> for display. The formatting is more
  compact than the one used in <code>print</code> in the <span class="pkg">permute</span>
  package, and shows only non-default choices. This output is normally
  used when printing the results of <span class="pkg">vegan</span> permutations.</p>
<p><code>pasteCall</code> prints the function call so that it is nicely wrapped
  in <code><a href="https://rdrr.io/r/utils/Sweave.html" class="external-link">Sweave</a></code> output.</p>
<p><code>veganCovEllipse</code> finds the coordinates for drawing a
  covariance ellipse.</p>
<p><code>veganMahatrans</code> transforms data matrix so that its Euclidean
  distances are Mahalanobis distances. The input data <code>x</code> must be
  a matrix centred by columns, and <code>s2</code> its covariance matrix. If
  <code>s2</code> is not given, covariance matrix is found from <code>x</code>
  within the function. If <code>na.rm = TRUE</code>, <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></code> is
  called with <code>use = "pairwise.complete.obs"</code>.</p>
<p><code>hierParseFormula</code> returns a list of one matrix (left hand side)
  and a model frame with factors representing hierarchy levels 
  (right hand side) to be used in <code><a href="adipart.html">adipart</a></code>, 
  <code><a href="multipart.html">multipart</a></code> and <code><a href="adipart.html">hiersimu</a></code>.</p>
<p><code>GowerDblcen</code> performs the Gower double centring of a matrix of
  dissimilarities. Similar function was earlier available as a compiled
  code in <span class="pkg">stats</span>, but it is not a part of official API, and
  therefore we have this poorer replacement.</p>
<p><code>addLingoes</code> and <code>addCailliez</code> find the constant added to
  non-diagonal (squared) dissimilarities to make all eigenvalues
  non-negative in Principal Co-ordinates Analysis
  (<code><a href="wcmdscale.html">wcmdscale</a></code>, <code><a href="dbrda.html">dbrda</a></code>,
  <code><a href="dbrda.html">capscale</a></code>). Function <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code> implements
  the Cailliez method. The argument is a matrix of dissimilarities.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

