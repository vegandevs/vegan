<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Distance-based redundancy analysis (dbRDA) is an ordination method
  similar to Redundancy Analysis (rda), but it allows
  non-Euclidean dissimilarity indices, such as Manhattan or
  Bray--Curtis distance. Despite this non-Euclidean feature, the analysis
  is strictly linear and metric. If called with Euclidean distance,
  the results are identical to rda, but dbRDA
  will be less efficient. Functions capscale and dbrda are
  constrained versions of metric scaling, a.k.a. principal coordinates
  analysis, which are based on the Euclidean distance but can be used,
  and are more useful, with other dissimilarity measures. The functions
  can also perform unconstrained principal coordinates analysis,
  optionally using extended dissimilarities."><title>[Partial] Distance-based Redundancy Analysis — capscale • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="[Partial] Distance-based Redundancy Analysis — capscale"><meta property="og:description" content="Distance-based redundancy analysis (dbRDA) is an ordination method
  similar to Redundancy Analysis (rda), but it allows
  non-Euclidean dissimilarity indices, such as Manhattan or
  Bray--Curtis distance. Despite this non-Euclidean feature, the analysis
  is strictly linear and metric. If called with Euclidean distance,
  the results are identical to rda, but dbRDA
  will be less efficient. Functions capscale and dbrda are
  constrained versions of metric scaling, a.k.a. principal coordinates
  analysis, which are based on the Euclidean distance but can be used,
  and are more useful, with other dissimilarity measures. The functions
  can also perform unconstrained principal coordinates analysis,
  optionally using extended dissimilarities."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>[Partial] Distance-based Redundancy Analysis</h1>
      
      <div class="d-none name"><code>capscale.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Distance-based redundancy analysis (dbRDA) is an ordination method
  similar to Redundancy Analysis (<code><a href="cca.html">rda</a></code>), but it allows
  non-Euclidean dissimilarity indices, such as Manhattan or
  Bray--Curtis distance. Despite this non-Euclidean feature, the analysis
  is strictly linear and metric. If called with Euclidean distance,
  the results are identical to <code><a href="cca.html">rda</a></code>, but dbRDA
  will be less efficient. Functions <code>capscale</code> and <code>dbrda</code> are
  constrained versions of metric scaling, a.k.a. principal coordinates
  analysis, which are based on the Euclidean distance but can be used,
  and are more useful, with other dissimilarity measures. The functions
  can also perform unconstrained principal coordinates analysis,
  optionally using extended dissimilarities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">capscale</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, distance <span class="op">=</span> <span class="st">"euclidean"</span>, sqrt.dist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    comm <span class="op">=</span> <span class="cn">NULL</span>, add <span class="op">=</span> <span class="cn">FALSE</span>,  dfun <span class="op">=</span> <span class="va">vegdist</span>, metaMDSdist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    na.action <span class="op">=</span> <span class="va">na.fail</span>, subset <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">dbrda</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, distance <span class="op">=</span> <span class="st">"euclidean"</span>, sqrt.dist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    add <span class="op">=</span> <span class="cn">FALSE</span>, dfun <span class="op">=</span> <span class="va">vegdist</span>, metaMDSdist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    na.action <span class="op">=</span> <span class="va">na.fail</span>, subset <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Model formula. The function can be called only with the
    formula interface. Most usual features of <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> hold,
    especially as defined in <code><a href="cca.html">cca</a></code> and <code><a href="cca.html">rda</a></code>. The
    LHS must be either a community data matrix or a dissimilarity matrix,
    e.g., from
    <code><a href="vegdist.html">vegdist</a></code> or <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>.
    If the LHS is a data matrix, function <code><a href="vegdist.html">vegdist</a></code> or
    function given in <code>dfun</code>
    will be used to find the dissimilarities. The RHS defines the
    constraints. The constraints can be continuous variables or factors,
    they can be transformed within the formula, and they can have
    interactions as in a typical <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>. The RHS can have a
    special term <code>Condition</code> that defines variables to be
    “partialled out” before constraints, just like in <code><a href="cca.html">rda</a></code>
    or <code><a href="cca.html">cca</a></code>. This allows the use of partial dbRDA.</p></dd>

  <dt>data</dt>
<dd><p>Data frame containing the variables on the right hand side of
    the model formula.</p></dd>

  <dt>distance</dt>
<dd><p>The name of the dissimilarity (or distance) index if
    the LHS of the <code>formula</code> is a data frame instead of
    dissimilarity matrix.</p></dd>

  <dt>sqrt.dist</dt>
<dd><p>Take square roots of dissimilarities. See section
    <code>Details</code> below.</p></dd>


  <dt>comm</dt>
<dd><p>Community data frame which will be used for finding
    species scores when the LHS of the <code>formula</code> was a
    dissimilarity matrix. This is not used if the LHS is a data
    frame. If this is not supplied, the “species scores” are
    unavailable when dissimilarities were supplied. N.B., this is
    only available in <code>capscale</code>: <code>dbrda</code> does not return
    species scores. Function <code><a href="sppscores.html">sppscores</a></code> can be used to add
    species scores if they are missing.</p></dd>


  <dt>add</dt>
<dd><p>Add a constant to the non-diagonal dissimilarities such
     that all eigenvalues are non-negative in the underlying Principal
     Co-ordinates Analysis (see <code><a href="wcmdscale.html">wcmdscale</a></code> for
     details). <code>"lingoes"</code> (or <code>TRUE</code>) uses the
     recommended method of Legendre &amp; Anderson (1999: “method
     1”) and <code>"cailliez"</code> uses their “method 2”. The
     latter is the only one in <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>.</p></dd>

  <dt>dfun</dt>
<dd><p>Distance or dissimilarity function used. Any function
     returning standard <code>"dist"</code> and taking the index name as the
     first argument can be used.</p></dd>

   <dt>metaMDSdist</dt>
<dd><p>Use <code><a href="metaMDS.html">metaMDSdist</a></code> similarly as in
     <code><a href="metaMDS.html">metaMDS</a></code>. This means automatic data transformation and
     using extended flexible shortest path dissimilarities (function
     <code><a href="stepacross.html">stepacross</a></code>) when there are many dissimilarities based on
     no shared species.</p></dd>

   <dt>na.action</dt>
<dd><p>Handling of missing values in constraints or
     conditions. The default (<code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.fail</a></code>) is to stop
     with missing values. Choices <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code> and
     <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code> delete rows with missing values, but
     differ in representation of results. With <code>na.omit</code> only
     non-missing site scores are shown, but <code>na.exclude</code> gives
     <code>NA</code> for scores of missing observations. Unlike in
     <code><a href="cca.html">rda</a></code>, no WA scores are available for missing
     constraints or conditions.</p></dd>

   <dt>subset</dt>
<dd><p>Subset of data rows. This can be a logical vector
     which is <code>TRUE</code> for kept observations, or a logical
     expression which can contain variables in the working
     environment, <code>data</code> or species names of the community data
     (if given in the formula or as <code>comm</code> argument).</p></dd>

   <dt>...</dt>
<dd><p>Other parameters passed to underlying functions (e.g.,
     <code><a href="metaMDS.html">metaMDSdist</a></code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>Functions <code>capscale</code> and <code>dbrda</code> provide two alternative
  implementations of dbRDA. Function <code>capscale</code> is based on
  Legendre &amp; Anderson (1999): the dissimilarity data are first
  ordinated using metric scaling, and the ordination results are
  analysed as <code><a href="cca.html">rda</a></code>. Function <code>dbrda</code> is based on
  McArdle &amp; Anderson (2001) and directly decomposes
  dissimilarities. It does not use <code><a href="cca.html">rda</a></code> but a parallel
  implementation adapted for analysing dissimilarities and returns a
  subset of <code><a href="cca.html">rda</a></code> items. With Euclidean distances both
  results are identical to <code><a href="cca.html">rda</a></code>.  Other dissimilarities
  may give negative eigenvalues associated with imaginary
  axes. Negative eigenvalues are handled differently: <code>capscale</code>
  ignores imaginary axes and analyses only real axes with positive
  eigenvalues, and <code>dbrda</code> directly analyses dissimilarities and
  can give negative eigenvalues in any component.</p>
<p>If the user supplied a community data frame instead of
  dissimilarities, the functions will find dissimilarities using
  <code><a href="vegdist.html">vegdist</a></code> or distance function given in <code>dfun</code> with
  specified <code>distance</code>. The functions will accept distance
  objects from <code><a href="vegdist.html">vegdist</a></code>, <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, or any other
  method producing compatible objects. The constraining variables can be
  continuous or factors or both, they can have interaction terms, or
  they can be transformed in the call. Moreover, there can be a
  special term <code>Condition</code> just like in <code><a href="cca.html">rda</a></code> and
  <code><a href="cca.html">cca</a></code> so that “partial” analysis can be performed.</p>
<p>Function <code>dbrda</code> does not return species scores, and they can
  also be missing in <code>capscale</code>, but they can be added after the
  analysis using function <code><a href="sppscores.html">sppscores</a></code>.</p>
<p>Non-Euclidean dissimilarities can produce negative eigenvalues
  (Legendre &amp; Anderson 1999, McArdle &amp; Anderson 2001).  If there are
  negative eigenvalues, the printed output of <code>capscale</code> will add
  a column with sums of positive eigenvalues and an item of sum of
  negative eigenvalues, and <code>dbrda</code> will add a column giving the
  number of real dimensions with positive eigenvalues.  If negative
  eigenvalues are disturbing, functions let you to distort the
  dissimilarities so that only non-negative eigenvalues will be
  produced with argument <code>add = TRUE</code>. Alternatively, with
  <code>sqrt.dist = TRUE</code>, square roots of dissimilarities will be
  used which may help in avoiding negative eigenvalues (Legendre &amp;
  Anderson 1999).</p>
<p>The functions can be also used to perform ordinary metric scaling
  a.k.a. principal coordinates analysis by using a formula with only a
  constant on the left hand side, or <code>comm ~ 1</code>. With
  <code>metaMDSdist = TRUE</code>, the function can do automatic data
  standardization and use extended dissimilarities using function
  <code><a href="stepacross.html">stepacross</a></code> similarly as in non-metric multidimensional
  scaling with <code><a href="metaMDS.html">metaMDS</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    


<p>The functions return an object of class <code>capscale</code> or</p>
<p></p>
<p><code>dbrda</code> which inherits from <code><a href="cca.html">rda</a></code>. See</p>
<p></p>
<p><code><a href="cca.object.html">cca.object</a></code> for description of the result object.</p>


    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anderson, M.J. &amp; Willis, T.J. (2003). Canonical analysis of principal
  coordinates: a useful method of constrained ordination for
  ecology. <em>Ecology</em> 84, 511--525.</p>
<p>Gower, J.C. (1985). Properties of Euclidean and non-Euclidean
  distance matrices. <em>Linear Algebra and its Applications</em> 67, 81--97.</p>
<p>Legendre, P. &amp; Anderson, M. J. (1999). Distance-based redundancy
  analysis: testing multispecies responses in multifactorial ecological
  experiments. <em>Ecological Monographs</em> 69, 1--24.</p>
<p>Legendre, P. &amp; Legendre, L. (2012).  <em>Numerical Ecology</em>. 3rd English
  Edition. Elsevier.</p>
<p>McArdle, B.H. &amp; Anderson, M.J. (2001). Fitting multivariate models
  to community data: a comment on distance-based redundancy
  analysis. <em>Ecology</em> 82, 290--297.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The function <code>capscale</code> was originally developed as a
  variant of constrained analysis of proximities (Anderson &amp; Willis
  2003), but these developments made it similar to dbRDA. However, it
  discards the imaginary dimensions with negative eigenvalues and
  ordination and significance tests area only based on real dimensions
  and positive eigenvalues.</p>
<p>The inertia is named after the dissimilarity index as defined in the
  dissimilarity data, or as <code>unknown distance</code> if such
  information is missing. If the largest original dissimilarity was
  larger than 4, <code>capscale</code> handles input similarly as <code>rda</code>
  and bases its analysis on variance instead of sum of
  squares. Keyword <code>mean</code> is added to the inertia in these cases,
  e.g. with Euclidean and Manhattan distances.  Inertia is based on
  squared index, and keyword <code>squared</code> is added to the name of
  distance, unless data were square root transformed (argument
  <code>sqrt.dist=TRUE</code>). If an additive constant was used with
  argument <code>add</code>, <code>Lingoes</code> or <code>Cailliez adjusted</code> is
  added to the the name of inertia, and the value of the constant is
  printed.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cca.html">rda</a></code>, <code><a href="cca.html">cca</a></code>, <code><a href="plot.cca.html">plot.cca</a></code>,
  <code><a href="anova.cca.html">anova.cca</a></code>, <code><a href="vegdist.html">vegdist</a></code>,
  <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></code>, <code><a href="wcmdscale.html">wcmdscale</a></code>
  for underlying and related functions. Function <code><a href="sppscores.html">sppscores</a></code>
  can add species scores or replace existing species scores.</p>
<p>The function returns similar result object as <code><a href="cca.html">rda</a></code> (see
  <code><a href="cca.object.html">cca.object</a></code>). This section for <code><a href="cca.html">rda</a></code> gives a
  more complete list of functions that can be used to access and
  analyse dbRDA results.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Basic Analysis</span></span></span>
<span class="r-in"><span><span class="va">vare.cap</span> <span class="op">&lt;-</span> <span class="fu">capscale</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">N</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Al</span><span class="op">)</span>, <span class="va">varechem</span>,</span></span>
<span class="r-in"><span>                     dist<span class="op">=</span><span class="st">"bray"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.cap</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: capscale(formula = varespec ~ N + P + K + Condition(Al), data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varechem, distance = "bray")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          4.792609   1.000000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    0.977190   0.203895    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.997170   0.208064    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  2.829038   0.590292   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Imaginary     -0.010790  -0.002251    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is squared Bray distance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species scores projected from ‘varespec’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CAP1   CAP2   CAP3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5413 0.3265 0.1293 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MDS1   MDS2   MDS3   MDS4   MDS5   MDS6   MDS7   MDS8   MDS9  MDS10  MDS11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9065 0.5127 0.3379 0.2626 0.2032 0.1618 0.1242 0.0856 0.0689 0.0583 0.0501 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MDS12  MDS13  MDS14  MDS15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0277 0.0208 0.0073 0.0013 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vare.cap</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="capscale-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">vare.cap</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for capscale under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: capscale(formula = varespec ~ N + P + K + Condition(Al), data = varechem, distance = "bray")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df SumOfSqs      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model     3  0.99717 2.2324  0.002 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 19  2.82904                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="co">## Avoid negative eigenvalues with additive constant</span></span></span>
<span class="r-in"><span><span class="fu">capscale</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">N</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Al</span><span class="op">)</span>, <span class="va">varechem</span>,</span></span>
<span class="r-in"><span>                     dist<span class="op">=</span><span class="st">"bray"</span>, add <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: capscale(formula = varespec ~ N + P + K + Condition(Al), data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varechem, distance = "bray", add = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          6.2496     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    1.0468     0.1675    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    1.1956     0.1913    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  4.0073     0.6412   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is Lingoes adjusted squared Bray distance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species scores projected from ‘varespec’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CAP1   CAP2   CAP3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6103 0.3940 0.1913 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MDS1   MDS2   MDS3   MDS4   MDS5   MDS6   MDS7   MDS8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9796 0.5811 0.4077 0.3322 0.2769 0.2346 0.1962 0.1566 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constant added to distances: 0.07413903 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Avoid negative eigenvalues by taking square roots of dissimilarities</span></span></span>
<span class="r-in"><span><span class="fu">capscale</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">N</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Al</span><span class="op">)</span>, <span class="va">varechem</span>,</span></span>
<span class="r-in"><span>                     dist <span class="op">=</span> <span class="st">"bray"</span>, sqrt.dist<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: capscale(formula = varespec ~ N + P + K + Condition(Al), data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varechem, distance = "bray", sqrt.dist = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          6.9500     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    0.9535     0.1372    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    1.2267     0.1765    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  4.7698     0.6863   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is Bray distance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species scores projected from ‘varespec’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CAP1   CAP2   CAP3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5817 0.4086 0.2365 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MDS1   MDS2   MDS3   MDS4   MDS5   MDS6   MDS7   MDS8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9680 0.6100 0.4469 0.3837 0.3371 0.3012 0.2558 0.2010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Principal coordinates analysis with extended dissimilarities</span></span></span>
<span class="r-in"><span><span class="fu">capscale</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="fl">1</span>, dist<span class="op">=</span><span class="st">"bray"</span>, metaMDS <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Square root transformation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wisconsin double standardization</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: capscale(formula = varespec ~ 1, distance = "bray", metaMDSdist =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Inertia Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.593021     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  2.594999   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Imaginary     -0.001978    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is squared Bray distance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species scores projected from ‘varespec’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MDS1   MDS2   MDS3   MDS4   MDS5   MDS6   MDS7   MDS8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6075 0.3820 0.3335 0.2046 0.1731 0.1684 0.1505 0.1163 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metaMDSdist transformed data: wisconsin(sqrt(varespec)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## dbrda</span></span></span>
<span class="r-in"><span><span class="fu">dbrda</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">N</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Al</span><span class="op">)</span>, <span class="va">varechem</span>,</span></span>
<span class="r-in"><span>                     dist<span class="op">=</span><span class="st">"bray"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: dbrda(formula = varespec ~ N + P + K + Condition(Al), data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varechem, distance = "bray")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank RealDims</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          4.5444     1.0000              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    0.9726     0.2140    1         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.9731     0.2141    3        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  2.5987     0.5718   19       13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is squared Bray distance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dbRDA1 dbRDA2 dbRDA3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5362 0.3198 0.1171 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MDS1   MDS2   MDS3   MDS4   MDS5   MDS6   MDS7   MDS8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9054 0.5070 0.3336 0.2581 0.2027 0.1605 0.1221 0.0825 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## avoid negative eigenvalues also with Jaccard distances</span></span></span>
<span class="r-in"><span><span class="fu">dbrda</span><span class="op">(</span><span class="va">varespec</span> <span class="op">~</span> <span class="va">N</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Al</span><span class="op">)</span>, <span class="va">varechem</span>,</span></span>
<span class="r-in"><span>                     dist<span class="op">=</span><span class="st">"jaccard"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: dbrda(formula = varespec ~ N + P + K + Condition(Al), data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> varechem, distance = "jaccard")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          6.5044     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    1.0330     0.1588    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    1.2068     0.1855    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  4.2646     0.6557   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is squared Jaccard distance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dbRDA1 dbRDA2 dbRDA3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5992 0.3994 0.2082 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MDS1   MDS2   MDS3   MDS4   MDS5   MDS6   MDS7   MDS8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.0388 0.6441 0.4518 0.3759 0.3239 0.2785 0.2279 0.1644 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

