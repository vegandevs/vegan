<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Performs detrended correspondence analysis and basic reciprocal
  averaging or orthogonal correspondence analysis."><title>Detrended Correspondence Analysis and Basic Reciprocal Averaging — decorana • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detrended Correspondence Analysis and Basic Reciprocal Averaging — decorana"><meta property="og:description" content="Performs detrended correspondence analysis and basic reciprocal
  averaging or orthogonal correspondence analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Detrended Correspondence Analysis and Basic Reciprocal Averaging</h1>
      
      <div class="d-none name"><code>decorana.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs detrended correspondence analysis and basic reciprocal
  averaging or orthogonal correspondence analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">decorana</span><span class="op">(</span><span class="va">veg</span>, iweigh<span class="op">=</span><span class="fl">0</span>, iresc<span class="op">=</span><span class="fl">4</span>, ira<span class="op">=</span><span class="fl">0</span>, mk<span class="op">=</span><span class="fl">26</span>, short<span class="op">=</span><span class="fl">0</span>,</span>
<span>         before<span class="op">=</span><span class="cn">NULL</span>, after<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for decorana</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, choices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, origin<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>     display<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>,<span class="st">"sites"</span>,<span class="st">"species"</span>,<span class="st">"none"</span><span class="op">)</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">0.8</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">type</span>, <span class="va">xlim</span>, <span class="va">ylim</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for decorana</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x</span>, display <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sites"</span>, <span class="st">"species"</span><span class="op">)</span>, <span class="va">labels</span>,</span>
<span>     choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, origin <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">select</span>,  <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for decorana</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x</span>, display <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sites"</span>, <span class="st">"species"</span><span class="op">)</span>,</span>
<span>       choices<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, origin <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">select</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for decorana</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, digits<span class="op">=</span><span class="fl">3</span>, origin<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>        display<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"species"</span>,<span class="st">"sites"</span>,<span class="st">"none"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for summary.decorana</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, head <span class="op">=</span> <span class="cn">NA</span>, tail <span class="op">=</span> <span class="va">head</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">downweight</span><span class="op">(</span><span class="va">veg</span>, fraction <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for decorana</span></span>
<span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">x</span>, display<span class="op">=</span><span class="st">"sites"</span>, choices<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>       origin<span class="op">=</span><span class="cn">TRUE</span>, tidy<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>veg</dt>
<dd><p>Community data, a matrix-like object.</p></dd>

  <dt>iweigh</dt>
<dd><p>Downweighting of rare species (0: no).</p></dd>

  <dt>iresc</dt>
<dd><p>Number of rescaling cycles (0: no rescaling).</p></dd>

  <dt>ira</dt>
<dd><p>Type of analysis (0: detrended, 1: basic reciprocal averaging).</p></dd>

  <dt>mk</dt>
<dd><p>Number of segments in rescaling.</p></dd>

  <dt>short</dt>
<dd><p>Shortest gradient to be rescaled.</p></dd>

  <dt>before</dt>
<dd><p>Hill's piecewise transformation: values before transformation.</p></dd>

  <dt>after</dt>
<dd><p>Hill's piecewise transformation: values after
  transformation -- these must correspond to values in <code>before</code>.</p></dd>

  <dt>x, object</dt>
<dd><p>A <code>decorana</code> result object.</p></dd>

  <dt>choices</dt>
<dd><p>Axes shown.</p></dd>

  <dt>origin</dt>
<dd><p>Use true origin even in detrended correspondence analysis.</p></dd>

  <dt>display</dt>
<dd><p>Display only sites, only species, both or neither.</p></dd>

  <dt>cex</dt>
<dd><p>Plot character size.</p></dd>

  <dt>cols</dt>
<dd><p>Colours used for sites and species.</p></dd>

  <dt>type</dt>
<dd><p>Type of plots, partial match to <code>"text"</code>,
    <code>"points"</code> or <code>"none"</code>.</p></dd>

  <dt>labels</dt>
<dd><p>Optional text to be used instead of row names.</p></dd>

  <dt>select</dt>
<dd><p>Items to be displayed.  This can either be a logical
    vector which is <code>TRUE</code> for displayed items or a vector of indices
    of displayed items.</p></dd>

  <dt>xlim, ylim</dt>
<dd><p>the x and y limits (min,max) of the plot.</p></dd>

  <dt>digits</dt>
<dd><p>Number of digits in summary output.</p></dd>

  <dt>head, tail</dt>
<dd><p>Number of rows printed from the head and tail of
    species and site scores. Default <code>NA</code> prints all.</p></dd>

  <dt>fraction</dt>
<dd><p>Abundance fraction where downweighting begins.</p></dd>

  <dt>tidy</dt>
<dd><p>Return scores that are compatible with <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><span class="pkg">ggplot2</span></a>:
    all scores are in a single <code>data.frame</code>, score type is
    identified by factor variable <code>score</code> (<code>"sites"</code>,
    <code>"species"</code>), the names by variable <code>label</code>. These scores
    are incompatible with conventional <code>plot</code> functions, but they can
    be used in <span class="pkg">ggplot2</span>.</p></dd>

  <dt>...</dt>
<dd><p>Other arguments for <code>plot</code> function.</p></dd>

  </dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In late 1970s, correspondence analysis became the method of choice for
  ordination in vegetation science, since it seemed better able to cope 
  with non-linear species responses than principal components
  analysis. However, even correspondence analysis can produce an arc-shaped
  configuration of a single gradient. Mark Hill developed detrended
  correspondence analysis to correct two assumed ‘faults’ in 
  correspondence analysis: curvature of straight gradients and packing
  of sites at the ends of the gradient.</p>
<p>The curvature is removed by replacing the orthogonalization of axes
  with detrending.  In orthogonalization successive axes are made
  non-correlated, but detrending should remove all systematic dependence
  between axes.  Detrending is performed using a smoothing window on
  <code>mk</code> segments.  The packing of sites at the ends of the gradient
  is undone by rescaling the axes after extraction.  After rescaling,
  the axis is supposed to be scaled by ‘SD’ units, so that the
  average width of Gaussian species responses is supposed to be one over
  whole axis. Other innovations were the piecewise linear transformation
  of species abundances and downweighting of rare species which were
  regarded to have an unduly high influence on ordination axes.</p>
<p>It seems that detrending actually works by twisting the ordination
  space, so that the results look non-curved in two-dimensional
  projections (‘lolly paper effect’).  As a result, the points
  usually have an easily recognized triangular or diamond shaped
  pattern, obviously an artefact of detrending.  Rescaling works
  differently than commonly presented, too. <code>decorana</code> does not
  use, or even evaluate, the widths of species responses.  Instead, it
  tries to equalize the weighted standard deviation of species scores on
  axis segments (parameter <code>mk</code> has no effect, since
  <code>decorana</code> finds the segments internally). Function
  <code><a href="tolerance.html">tolerance</a></code> returns this internal criterion and can be
  used to assess the success of rescaling.</p>
<p>The <code>summary</code> method prints the ordination scores,
  possible prior weights used in downweighting, and the marginal totals
  after applying these weights. The <code>plot</code> method plots
  species and site scores.  Classical <code>decorana</code> scaled the axes
  so that smallest site score was 0 (and smallest species score was
  negative), but <code>summary</code>, <code>plot</code> and
  <code>scores</code> use the true origin, unless <code>origin = FALSE</code>.</p>
<p>In addition to proper eigenvalues, the function reports
  ‘decorana values’ in detrended analysis. These ‘decorana
  values’ are the values that the legacy code of <code>decorana</code> returns
  as eigenvalues. They are estimated during iteration, and describe the
  joint effects of axes and detrending. The ‘decorana values’ are
  estimated before rescaling and do not show its effect on
  eigenvalues. The proper eigenvalues are estimated after extraction of
  the axes and they are the ratio of weighted sum of squares of site and
  species scores even in detrended and rescaled solutions. These
  eigenvalues are estimated for each axis separately, but they are not
  additive, because higher <code>decorana</code> axes can show effects already
  explained by prior axes. ‘Additive eigenvalues’ are cleansed
  from the effects of prior axes, and they can be assumed to add up to
  total inertia (scaled Chi-square). For proportions and cumulative
  proportions explained you can use <code><a href="eigenvals.html">eigenvals.decorana</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>decorana</code> returns an object of class <code>"decorana"</code>, which
  has <code>print</code>, <code>summary</code>, <code>scores</code>, <code>plot</code>,</p>
<p></p>
<p><code>points</code> and <code>text</code> methods, and support functions</p>
<p></p>
<p><code><a href="eigenvals.html">eigenvals</a></code>, <code><a href="screeplot.cca.html">bstick</a></code>, <code>screeplot</code>,</p>
<p></p>
<p><code>predict</code> and <code><a href="tolerance.html">tolerance</a></code>. <code>downweight</code> is an
  independent function that can also be used with other methods than</p>
<p></p>
<p><code>decorana</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hill, M.O. and Gauch, H.G. (1980). Detrended correspondence analysis:
  an improved ordination technique. <em>Vegetatio</em> <strong>42</strong>,
  47--58.</p>
<p>Oksanen, J. and Minchin, P.R. (1997). Instability of ordination
  results under changes in input data order: explanations and
  remedies. <em>Journal of Vegetation Science</em> <strong>8</strong>, 447--454.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mark O. Hill wrote the original Fortran code, the <span style="R">R</span> port was by
  Jari Oksanen.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>decorana</code> uses the central numerical engine of the
  original Fortran code (which is in the public domain), or about 1/3 of
  the original program.  I have tried to implement the original
  behaviour, although a great part of preparatory steps were written in
  <span style="R">R</span> language, and may differ somewhat from the original code. However,
  well-known bugs are corrected and strict criteria used (Oksanen &amp;
  Minchin 1997).</p>
<p>Please note that there really is no need for piecewise transformation
  or even downweighting within <code>decorana</code>, since there are more
  powerful and extensive alternatives in <span style="R">R</span>, but these options are
  included for compliance with the original software.  If a different
  fraction of abundance is needed in downweighting, function
  <code>downweight</code> must be applied before <code>decorana</code>.  Function
  <code>downweight</code> indeed can be applied prior to correspondence
  analysis, and so it can be used together with <code><a href="cca.html">cca</a></code>, too.</p>
<p>Github package <span class="pkg">natto</span> has an <span style="R">R</span> implementation of
  <code>decorana</code> which allows easier inspection of the
  algorithm and also easier development of the function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">

<p>For unconstrained ordination, non-metric multidimensional scaling in
  <code><a href="monoMDS.html">monoMDS</a></code> may be more robust (see also
  <code><a href="metaMDS.html">metaMDS</a></code>).  Constrained (or ‘canonical’)
  correspondence analysis can be made with <code><a href="cca.html">cca</a></code>.
  Orthogonal correspondence analysis can be made with <code>decorana</code> or
  <code><a href="cca.html">cca</a></code>, but the scaling of results vary (and the one in
  <code>decorana</code> corresponds to <code>scaling = "sites"</code> and <code>hill
  = TRUE</code> in <code><a href="cca.html">cca</a></code>.).  See <code><a href="predict.cca.html">predict.decorana</a></code>
  for adding new points to an ordination.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.dca</span> <span class="op">&lt;-</span> <span class="fu">decorana</span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.dca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> decorana(veg = varespec) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Detrended correspondence analysis with 26 segments.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rescaling of axes with 4 iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total inertia (scaled Chi-square): 2.0832 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        DCA1   DCA2    DCA3    DCA4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues          0.5235 0.3253 0.20010 0.19176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Additive Eigenvalues 0.5235 0.3217 0.17919 0.11922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decorana values      0.5249 0.1572 0.09669 0.06075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Axis lengths         2.8161 2.2054 1.54650 1.64864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">vare.dca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> decorana(veg = varespec) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Detrended correspondence analysis with 26 segments.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rescaling of axes with 4 iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total inertia (scaled Chi-square): 2.0832 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        DCA1   DCA2    DCA3    DCA4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues          0.5235 0.3253 0.20010 0.19176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Additive Eigenvalues 0.5235 0.3217 0.17919 0.11922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decorana values      0.5249 0.1572 0.09669 0.06075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Axis lengths         2.8161 2.2054 1.54650 1.64864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species scores:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              DCA1     DCA2     DCA3     DCA4 Totals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Callvulg  0.04119 -1.53268 -2.55101  1.32277  45.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empenigr  0.09019  0.82274  0.20569  0.30631 151.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rhodtome  1.34533  2.47141 -0.34970 -1.13823   8.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vaccmyrt  1.86298  1.71424 -0.60535 -0.40205  50.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vaccviti  0.16641  0.71095  0.00313 -0.55801 275.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pinusylv -0.73490  1.62050 -1.60275 -2.10199   4.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descflex  1.97061  1.81651  1.74896 -0.91463   5.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Betupube  0.79745  3.36374 -0.94546 -1.01741   0.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vacculig -0.08912 -1.17478  2.86624  0.87025  15.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Diphcomp -0.82669 -0.44195  2.58579 -0.38459   3.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dicrsp    2.37743 -0.27373 -0.47099 -1.89036  40.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dicrfusc  1.58267 -1.33770 -1.33563  1.47417 113.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dicrpoly  0.86689  2.39519 -0.82064 -3.41534   6.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hylosple  2.66242  1.19669  1.48288 -0.69978  18.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pleuschr  1.64098  0.15607  0.30044 -0.26717 377.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polypili -0.56213  0.14009  0.25198  0.49177   0.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polyjuni  1.22244 -0.89173  0.61287  3.60066  13.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polycomm  1.01545  2.08388  0.06402  0.84199   0.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pohlnuta -0.00712  1.09704 -0.82126 -1.59862   2.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ptilcili  0.48093  2.86420 -0.71801 -1.02698  14.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Barbhatc  0.58303  3.71792 -0.84212 -1.88837   3.19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladarbu -0.18554 -1.18973  0.68113  0.55399 255.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladrang -0.83427 -0.78085  0.90603  0.70057 388.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladstel -1.67768  0.98907 -0.83789 -0.60206 486.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladunci  0.97686 -1.70859 -1.68281 -2.26756  56.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladcocc -0.27221 -0.76713 -0.63836  0.66927   2.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladcorn  0.29068 -0.97039  0.50414  0.95738   6.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladgrac  0.21778 -0.41879  0.06530 -0.31472   5.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladfimb  0.00889 -0.23922 -0.26505  0.33123   3.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladcris  0.37774 -1.09161 -0.55627  0.23868   7.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladchlo -0.91983  1.54955 -0.58109 -1.48643   1.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladbotr  0.66438  2.19584 -0.90331 -0.91391   0.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladamau -0.96418 -0.98992  2.71458  0.52352   0.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladsp   -1.12318 -0.15330 -0.69833  0.44040   0.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cetreric  0.27163 -1.28867 -0.81682 -1.93935   3.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cetrisla -0.50158  2.22098 -1.16461 -1.89349   2.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Flavniva -1.67937 -3.67985  4.15644  3.18919  11.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nepharct  2.18561 -0.82837  0.71958  5.81930   5.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stersp   -0.78699 -2.01214  2.31212  2.03946  17.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Peltapht  0.45763 -0.34395  0.09916  1.34695   0.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Icmaeric  0.04950 -1.97605  1.41509  2.10154   0.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladcerv -1.21585 -2.30519  2.55186  3.41532   0.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Claddefo  0.60517 -1.19771 -0.33388  0.22585  10.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cladphyl -1.53959  1.48574 -1.43209 -1.52387   0.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site scores:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       DCA1    DCA2    DCA3    DCA4 Totals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 -0.1729 -0.2841  0.4775  0.2521   89.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  0.8539 -0.3360  0.0708  0.0924   89.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  1.2467 -0.1183 -0.1211 -0.8718   94.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  1.0675  0.4169  0.2897 -0.1758  125.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  0.4234  0.0112  0.2179  0.1265   90.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  0.0252  0.3600 -0.0263 -0.1168   81.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  1.0695 -0.3707 -0.4285  0.4145  109.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  0.7724 -0.5325 -0.2856  0.5269   88.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  1.6189  0.5482  0.2342 -0.3333  110.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 -0.2642 -0.6851 -0.3777  0.5003  101.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  0.6431 -0.9604 -0.6000 -0.2885   81.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  0.4504 -0.1666  0.1850 -0.1291   64.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  1.2501 -0.2248  0.0244  0.3741   94.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  -0.3910 -0.7618  0.8640  0.5557  103.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  -0.6407 -0.9427  0.9465  0.7769   94.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -0.4523 -0.5529  0.3988  0.2781  110.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -1.1043  0.2106 -0.0653 -0.0539  106.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -0.9454 -0.5974  0.4639  0.4889   84.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -1.1971  0.5691 -0.3246 -0.2522  119.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  -1.0983  0.7850 -0.5274 -0.4848  122.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 -0.8673  0.5621 -0.3254 -0.3217  119.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 -1.1842  0.7442 -0.4995 -0.3917  122.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 -0.4134  0.0260  0.0107 -0.0682  112.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  0.3210  1.2450 -0.2541 -0.5253   99.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vare.dca</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="decorana-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### the detrending rationale:</span></span></span>
<span class="r-in"><span><span class="va">gaussresp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">u</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span>,length<span class="op">=</span><span class="fl">15</span><span class="op">)</span> <span class="co">## The gradient</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">8</span>,len<span class="op">=</span><span class="fl">23</span><span class="op">)</span>   <span class="co">## The optima</span></span></span>
<span class="r-in"><span><span class="va">pack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">u</span>,<span class="va">gaussresp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pack</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">"Species packing"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="decorana-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">pack</span><span class="op">)</span><span class="op">)</span>, asp<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"PCA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu">decorana</span><span class="op">(</span><span class="va">pack</span>, ira<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, asp<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"CA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu">decorana</span><span class="op">(</span><span class="va">pack</span><span class="op">)</span><span class="op">)</span>, asp<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"DCA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">pack</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>, dis<span class="op">=</span><span class="st">"sites"</span><span class="op">)</span>, asp<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"CCA"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="decorana-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Let's add some noise:</span></span></span>
<span class="r-in"><span><span class="va">noisy</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pack</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">pack</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">pack</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">"Ideal model"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">noisy</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">"Noisy model"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="decorana-4.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">noisy</span><span class="op">)</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"PCA"</span>, asp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu">decorana</span><span class="op">(</span><span class="va">noisy</span>, ira<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"CA"</span>, asp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu">decorana</span><span class="op">(</span><span class="va">noisy</span><span class="op">)</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"DCA"</span>, asp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">noisy</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span>, dis<span class="op">=</span><span class="st">"sites"</span><span class="op">)</span>, asp<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">"b"</span>, main<span class="op">=</span><span class="st">"CCA"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="decorana-5.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

