<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Principal Response Curves for Treatments with Repeated Observations — prc • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Principal Response Curves for Treatments with Repeated Observations — prc"><meta name="description" content="Principal Response Curves (PRC) are a special case of
  Redundancy Analysis (rda) for multivariate responses in
  repeated observation design. They were originally suggested for
  ecological communities. They should be easier to interpret than
  traditional constrained ordination. They can also be used to study how
  the effects of a factor A depend on the levels of a factor
  B, that is A + A:B, in a multivariate response
  experiment."><meta property="og:description" content="Principal Response Curves (PRC) are a special case of
  Redundancy Analysis (rda) for multivariate responses in
  repeated observation design. They were originally suggested for
  ecological communities. They should be easier to interpret than
  traditional constrained ordination. They can also be used to study how
  the effects of a factor A depend on the levels of a factor
  B, that is A + A:B, in a multivariate response
  experiment."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Principal Response Curves for Treatments with Repeated Observations</h1>

      <div class="d-none name"><code>prc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Principal Response Curves (PRC) are a special case of
  Redundancy Analysis (<code><a href="cca.html">rda</a></code>) for multivariate responses in
  repeated observation design. They were originally suggested for
  ecological communities. They should be easier to interpret than
  traditional constrained ordination. They can also be used to study how
  the effects of a factor <code>A</code> depend on the levels of a factor
  <code>B</code>, that is <code>A + A:B</code>, in a multivariate response
  experiment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prc</span><span class="op">(</span><span class="va">response</span>, <span class="va">treatment</span>, <span class="va">time</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'prc'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, axis <span class="op">=</span> <span class="fl">1</span>, scaling <span class="op">=</span> <span class="st">"sites"</span>, <span class="va">const</span>,</span>
<span>        digits <span class="op">=</span> <span class="fl">4</span>, correlation <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'prc'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, species <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">select</span>, scaling <span class="op">=</span> <span class="st">"symmetric"</span>,</span>
<span>     axis <span class="op">=</span> <span class="fl">1</span>, correlation <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">const</span>, type <span class="op">=</span> <span class="st">"l"</span>, <span class="va">xlab</span>, <span class="va">ylab</span>, <span class="va">ylim</span>,</span>
<span>     lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="va">pch</span>, <span class="va">legpos</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>Multivariate response data. Typically these are
    community (species) data. If the data are counts, they probably
    should be log transformed prior to the analysis.</p></dd>

  <dt id="arg-treatment">treatment<a class="anchor" aria-label="anchor" href="#arg-treatment"></a></dt>
<dd><p>A factor for treatments.</p></dd>

  <dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>An unordered factor defining the observations times in
    the repeated design.</p></dd>

  <dt id="arg-object-x">object, x<a class="anchor" aria-label="anchor" href="#arg-object-x"></a></dt>
<dd><p>An <code>prc</code> result object.</p></dd>

  <dt id="arg-axis">axis<a class="anchor" aria-label="anchor" href="#arg-axis"></a></dt>
<dd><p>Axis shown (only one axis can be selected).</p></dd>

  <dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>Scaling of species scores, identical to the
    <code>scaling</code> in <code><a href="plot.cca.html">scores.rda</a></code>.</p>
<p>The type of scores can also be specified as one of <code>"none"</code>,
    <code>"sites"</code>, <code>"species"</code>, or <code>"symmetric"</code>, which
    correspond to the values <code>0</code>, <code>1</code>, <code>2</code>, and <code>3</code>
    respectively. Argument <code>correlation</code> can be used in combination
    with these character descriptions to get the corresponding negative
    value.</p></dd>

  <dt id="arg-const">const<a class="anchor" aria-label="anchor" href="#arg-const"></a></dt>
<dd><p>General scaling constant for species scores (see
    <code><a href="plot.cca.html">scores.rda</a></code> for details). Lower values will reduce the
    range of species scores, but will not influence the regression
    coefficients.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Number of significant digits displayed.</p></dd>

  <dt id="arg-correlation">correlation<a class="anchor" aria-label="anchor" href="#arg-correlation"></a></dt>
<dd><p>logical; if <code>scaling</code> is a character
    description of the scaling type, <code>correlation</code> can be used to
    select correlation-like scores for PCA. See argument <code>scaling</code>
    for details.</p></dd>

  <dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>Display species scores.</p></dd>

  <dt id="arg-select">select<a class="anchor" aria-label="anchor" href="#arg-select"></a></dt>
<dd><p>Vector to select displayed species. This can be a vector
    of indices or a logical vector which is <code>TRUE</code> for the selected
    species</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Type of plot: <code>"l"</code> for lines, <code>"p"</code> for points
    or <code>"b"</code> for both.</p></dd>

  <dt id="arg-xlab-ylab">xlab, ylab<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab"></a></dt>
<dd><p>Text to replace default axis labels.</p></dd>

  <dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>Limits for the vertical axis.</p></dd>

  <dt id="arg-lty-col-pch">lty, col, pch<a class="anchor" aria-label="anchor" href="#arg-lty-col-pch"></a></dt>
<dd><p>Line type, colour and plotting characters
    (defaults supplied).</p></dd>

  <dt id="arg-legpos">legpos<a class="anchor" aria-label="anchor" href="#arg-legpos"></a></dt>
<dd><p>The position of the <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></code>. A guess is
    made if this is not supplied, and <code>NA</code> will suppress legend.</p></dd>

  <dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>Character expansion for symbols and species labels.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters passed to functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>PRC is a special case of <code><a href="cca.html">rda</a></code> with a single
  factor for <code>treatment</code> and a single factor for <code>time</code> points
  in repeated observations. In <span class="pkg">vegan</span>, the corresponding
  <code><a href="cca.html">rda</a></code> model is defined as <code>rda(response ~ treatment *
  time + Condition(time))</code>. Since the <code>time</code> appears twice in the
  model formula, its main effects will be aliased, and only the main
  effect of treatment and interaction terms are available, and will be
  used in PRC. Instead of usual multivariate ordination diagrams, PRC
  uses canonical (regression) coefficients and species scores for a
  single axis. All that the current functions do is to provide a special
  <code>summary</code> and <code>plot</code> methods that display the
  <code><a href="cca.html">rda</a></code> results in the PRC fashion. The current version only
  works with default contrasts (<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.treatment</a></code>) in which
  the coefficients are contrasts against the first level, and the levels
  must be arranged so that the first level is the control (or a
  baseline). If necessary, you must change the baseline level with
  function <code><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></code>.</p>

<p>Function <code>summary</code> prints the species scores and the
  coefficients. Function <code>plot</code> plots coefficients against
  <code>time</code> using <code><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></code>, and has similar defaults.
  The graph (and PRC) is meaningful only if the first <code>treatment</code>
  level is the control, as the results are contrasts to the first level
  when unordered factors are used. The plot also displays species scores
  on the right vertical axis using function
  <code><a href="linestack.html">linestack</a></code>. Typically the number of species is so high
  that not all can be displayed with the default settings, but users can
  reduce character size or padding (<code>air</code>) in
  <code><a href="linestack.html">linestack</a></code>, or <code>select</code> only a subset of the
  species. A legend will be displayed unless suppressed with
  <code>legpos = NA</code>, and the functions tries to guess where to put the
  legend if <code>legpos</code> is not supplied.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function is a special case of <code><a href="cca.html">rda</a></code> and returns its
  result object (see <code><a href="cca.object.html">cca.object</a></code>). However, a special
  <code>summary</code> and <code>plot</code> methods display returns differently
  than in <code><a href="cca.html">rda</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>van den Brink, P.J. &amp; ter Braak, C.J.F. (1999). Principal response
  curves: Analysis of time-dependent multivariate responses of
  biological community to stress. Environmental Toxicology and
  Chemistry, 18, 138–148.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen and Cajo ter Braak</p>
    </div>
    <div class="section level2">
    <h2 id="warning-">Warning <a class="anchor" aria-label="anchor" href="#warning-"></a></h2>
    <p>The first level of <code>treatment</code> must be the
  control: use function <code><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></code> to guarantee the correct
  reference level. The current version will ignore user setting of
  <code><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></code> and always use treatment contrasts
  (<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.treatment</a></code>). The <code>time</code> must be an unordered
  factor.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cca.html">rda</a></code>, <code><a href="anova.cca.html">anova.cca</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Chlorpyrifos experiment and experimental design: Pesticide</span></span></span>
<span class="r-in"><span><span class="co">## treatment in ditches (replicated) and followed over from 4 weeks</span></span></span>
<span class="r-in"><span><span class="co">## before to 24 weeks after exposure </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pyrifos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">week</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">15</span>, <span class="fl">19</span>, <span class="fl">24</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.9</span>, <span class="fl">0</span>, <span class="fl">44</span>, <span class="fl">6</span>, <span class="fl">0.1</span>, <span class="fl">44</span>, <span class="fl">0.9</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ditch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, length<span class="op">=</span><span class="fl">132</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_BEGIN</span></span></span>
<span class="r-in"><span><span class="co">## PRC</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">prc</span><span class="op">(</span><span class="va">pyrifos</span>, <span class="va">dose</span>, <span class="va">week</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span>            <span class="co"># RDA</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: prc(response = pyrifos, treatment = dose, time = week)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         288.9920     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    63.3493     0.2192   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    96.6837     0.3346   44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 128.9589     0.4462   77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RDA1   RDA2   RDA3   RDA4   RDA5   RDA6   RDA7   RDA8   RDA9  RDA10  RDA11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25.282  8.297  6.044  4.766  4.148  3.857  3.587  3.334  3.087  2.551  2.466 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  RDA12  RDA13  RDA14  RDA15  RDA16  RDA17  RDA18  RDA19  RDA20  RDA21  RDA22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.209  2.129  1.941  1.799  1.622  1.579  1.440  1.398  1.284  1.211  1.133 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  RDA23  RDA24  RDA25  RDA26  RDA27  RDA28  RDA29  RDA30  RDA31  RDA32  RDA33 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.001  0.923  0.862  0.788  0.750  0.712  0.685  0.611  0.584  0.537  0.516 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  RDA34  RDA35  RDA36  RDA37  RDA38  RDA39  RDA40  RDA41  RDA42  RDA43  RDA44 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.442  0.417  0.404  0.368  0.340  0.339  0.306  0.279  0.271  0.205  0.179 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17.156  9.189  7.585  6.064  5.730  4.843  4.518  4.105 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 77 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>   <span class="co"># PRC</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prc(response = pyrifos, treatment = dose, time = week) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species scores:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Simve     Daplo     Cerpu     Alogu     Aloco     Alore     Aloaf     Copsp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.688099  1.464566  0.542739  0.280040  0.177019  0.315038  0.426524  1.169368 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Ostsp     Slyla     Acrha     Aloex     Chysp     Alona     Plead     Oxyte </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.312186 -0.556899  0.105535  0.228092  0.095042  0.063689  0.138397  0.025401 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Grate     Copdi     NauLa     CilHa     Strvi     amosp     Ascmo     Synsp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.096840  1.428854  4.847070  0.895241  3.069709 -1.357663  0.069736 -0.026494 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Squro     Squmu     Polar     Kerqu     Anufi     Mytve     Mytvi     Mytmu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.264390 -0.452667  0.461989  0.495348  0.432767  0.074372  0.090928  0.105891 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Lepsp     Leppa     Colob     Colbi     Colun     Lecsp     Lecqu     Lecco </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.998286  0.084809 -0.723051 -0.139569 -0.828338  0.472866 -0.088860 -0.290531 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Leclu     Lecfl     Tripo     Cepsp     Monlo     Monae     Scalo     Trilo </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.049788 -0.408035  0.215234 -0.809597 -0.527913 -0.089948 -0.077192 -0.039086 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tripo.1     Tricy     Trisp     Tepat     Rotne     Notla     Filsp     Lopox </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.246435  0.335400  0.078423  0.007719  0.143730 -0.114301 -0.168356 -0.030990 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  hydrspec  bothrosp  olchaeta  erpoocto  glsicomp  alglhete  hebdstag   sphidae </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.048698  0.398665 -1.165154 -0.901030 -0.144389 -0.073049  0.902223  1.463655 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ansuvote  armicris  bathcont  binitent  gyraalbu  hippcomp  lymnstag  lymnaes7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.140685  1.680010  0.073282 -1.950500  0.033051  0.404473 -0.263679  0.135150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  physfont  plbacorn  popyanti  radiovat  radipere  valvcris  valvpisc  hycarina </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.026383  0.084761  1.272223 -0.019815 -0.625468  0.010579 -0.267577  1.044034 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gammpule  aselaqua  proameri  collembo  caenhora  caenluct  caenrobu  cloedipt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.526450  1.578743  0.116577  0.029906  5.767844  2.376188  0.126181  4.734035 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cloesimi  aeshniae  libellae  conagrae  corident  coripanz  coripunc  cymabons </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.242207  0.212699 -0.081867  1.630574  0.013761  0.120439 -0.176746  0.046360 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  hesplinn  hespsahl  notoglau  notomacu  notoobli  notoviri  pacoconc  pleaminu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.069465  0.033240  0.555201  0.050060  0.082356  0.215863  0.016709  0.071168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigadist  sigafall  sigastri  sigarasp  colyfusc  donacis6  gyrimari  haliconf </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.076479 -0.018364  0.060206 -0.277312  0.036493 -0.078608  0.010579  0.446911 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  haliflav  haligruf  haliobli  herubrev  hya_herm  hyglpusi  hyhyovat  hypoplan </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.044538  0.450146  0.131472 -0.128486 -0.322379 -0.011775  0.024196  0.014976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  hyporusp  hytuinae  hytuvers  laphminu  noteclav  rhantusp  sialluta  ablalong </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.232042  2.316179  1.772351  0.632897  0.007912  0.067618  1.109341  0.014976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ablaphmo  cltanerv  malopisp  mopetenu  prdiussp  pstavari  chironsp  crchirsp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.992695  0.075631  0.047658  0.008716  0.554911  0.082842  1.889916  0.016709 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  crclglat  ditendsp  mitegchl  pachgarc  pachgvit  popegnub  popedisp  acriluce </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.028953  0.083481  0.230629 -0.012187 -0.029907  0.224272 -0.069649 -0.007950 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  chclpige  conescut  cricotsp  liesspec  psclbarb  psclgsli  psclobvi  psclplat </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.008744  0.821036  0.121530  0.107387 -0.028639  0.601568 -0.362378 -0.052054 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  psclpsil  pscladsp  cladotsp  laa_spec  patanysp  tatarssp  zaa_spec  anopmacu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.007339  0.005674  0.539894  0.034105  0.146807  0.669430  0.049949 -0.163731 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cepogoae  chaoobsc  cucidae4  tabanusp  agdasphr  athrater  cyrncren  holodubi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.555403  2.442310  0.033240 -0.011601  0.271815  0.067618  0.071168  0.094754 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  holopici  leceriae  lilurhom  monaangu  mystazur  mystloni  oecefurv  oecelacu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.611618  0.298633  0.009063  0.644295  0.033240  2.998460  0.536628  0.259064 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  triabico  paponysp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.088915  0.097788 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients for dose + week:dose interaction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> which are contrasts to dose 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rows are dose, columns are week</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           -4      -1     0.1        1       2       4        8      12      15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1 -0.07218 -0.1375 -0.1020 -0.04068 -0.2101 -0.1364 -0.08077 -0.1536 -0.1123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9 -0.08106 -0.1935 -0.1936 -0.47699 -0.4977 -0.4306 -0.13532 -0.3548 -0.2408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -0.16616 -0.1232 -0.4539 -1.15638 -1.0835 -1.1511 -0.56112 -0.4698 -0.3078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  -0.13979 -0.1958 -0.7308 -1.26088 -1.2978 -1.4627 -1.29139 -1.0081 -0.7819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          19       24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1 -0.2163 -0.07835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9 -0.1756 -0.15442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -0.3293 -0.18227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  -0.5768 -0.31022</span>
<span class="r-in"><span><span class="va">logabu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">pyrifos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, select <span class="op">=</span> <span class="va">logabu</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prc-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_END</span></span></span>
<span class="r-in"><span><span class="co">## Ditches are randomized, we have a time series, and are only</span></span></span>
<span class="r-in"><span><span class="co">## interested in the first axis</span></span></span>
<span class="r-in"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></span><span class="op">(</span>plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">Plots</a></span><span class="op">(</span>strata <span class="op">=</span> <span class="va">ditch</span>,type <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">Within</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"series"</span><span class="op">)</span>, nperm <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span>, permutations <span class="op">=</span> <span class="va">ctrl</span>, first<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for rda under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Plots: ditch, plot permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: series</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: prc(response = pyrifos, treatment = dose, time = week)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df Variance      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RDA1      1   25.282 15.096   0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 77  128.959                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

