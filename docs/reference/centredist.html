<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Distances of Points to Class Centroids — centredist • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Distances of Points to Class Centroids — centredist"><meta name="description" content="Function finds Euclidean or squared Mahalanobis distances of points
  to class centroids in betadisper or ordination results."><meta property="og:description" content="Function finds Euclidean or squared Mahalanobis distances of points
  to class centroids in betadisper or ordination results."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Distances of Points to Class Centroids</h1>

      <div class="d-none name"><code>centredist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function finds Euclidean or squared Mahalanobis distances of points
  to class centroids in <code><a href="betadisper.html">betadisper</a></code> or ordination results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Default S3 method</span></span>
<span><span class="fu">centredist</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>,</span>
<span>    <span class="st">"mahalanobis"</span><span class="op">)</span>, display <span class="op">=</span> <span class="st">"sites"</span>, <span class="va">w</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'betadisper'</span></span>
<span><span class="fu">centredist</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu">centredist</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>, <span class="st">"mahalanobis"</span><span class="op">)</span>,</span>
<span>    display <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sites"</span>, <span class="st">"species"</span><span class="op">)</span>, rank <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'rda'</span></span>
<span><span class="fu">centredist</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>, <span class="st">"mahalanobis"</span><span class="op">)</span>,</span>
<span>    display <span class="op">=</span> <span class="st">"sites"</span>, rank <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'dbrda'</span></span>
<span><span class="fu">centredist</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>,<span class="st">"mahalanobis"</span><span class="op">)</span>,</span>
<span>    display <span class="op">=</span> <span class="st">"sites"</span>, rank <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'wcmdscale'</span></span>
<span><span class="fu">centredist</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, distance<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>,<span class="st">"mahalanobis"</span><span class="op">)</span>,</span>
<span>    display <span class="op">=</span> <span class="st">"sites"</span>, rank <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An ordination result object, or a matrix for the default
    method or a <code>betadisper</code> result object.</p></dd>

  <dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Factor to define classes for which centroids are found.</p></dd>

  <dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>Use either simple Euclidean distance or squared Mahalanobis
    distances that take into account the shape of covariance ellipses.</p></dd>

  <dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>Kind of <code><a href="scores.html">scores</a></code>.</p></dd>

  <dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>Weights. If <code>x</code> has weights (such as <code><a href="cca.html">cca</a></code>
    result), these will be used.</p></dd>

  <dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>Number of axes used in ordination methods.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments to functions (ignored).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Function finds either simple Euclidean distances of all points to
  their centroid as given by argument <code>group</code> or squared
  Mahalanobis distances of points to the centroid. In addition to the
  distances, it returns information of the original group and the
  nearest group for each point.</p>
<p>Currently the distances are scaled so that the sum of squared
  Euclidean distance will give the residual (unexplained) eigenvalue
  in constrained ordination with given group. The distances may not
  correspond to the distances in ordination plots with specific
  <code>scaling</code> and setting argument <code>scaling</code> gives an
  error. Due to restriction of this scaling, Euclidean distances for
  species scores are only allowed in <code><a href="cca.html">ca</a></code> and
  <code><a href="cca.html">cca</a></code>. These restrictions may be relaxed in the future
  versions of the method.</p>
<p>Squared Mahalanobis distances (<code><a href="https://rdrr.io/r/stats/mahalanobis.html" class="external-link">mahalanobis</a></code>) are scaled
  by the within group covariance matrix, and they are consistent with
  <code><a href="ordihull.html">ordiellipse</a></code>.</p>
<p>Mahalanobis distances can only be calculated for <code>group</code> that
  are larger than <code>rank</code>. For <code>rank = 2</code>, minimum
  permissible <code>group</code> has three points. However, even this can
  fail in degenerate cases, such as three points on a line. Euclidean
  distances can be calculated for any <code>rank</code>. With <code>rank = "full"</code>
  distance-based methods <code><a href="wcmdscale.html">wcmdscale</a></code>, <code><a href="dbrda.html">pco</a></code>,
  <code><a href="dbrda.html">dbrda</a></code> and <code><a href="betadisper.html">betadisper</a></code> will handle
  negative eigenvalues and associated eigenvectors, but with numeric
  rank they will only use real eigenvectors with positive eigenvalues.</p>
<p>There are specific methods for some ordination models, but many will
  be handled by the default method (including <code><a href="metaMDS.html">metaMDS</a></code>
  and <code><a href="monoMDS.html">monoMDS</a></code>).</p>
<p>The specific method for <code><a href="betadisper.html">betadisper</a></code> ignores most
  arguments and calculates the distances as specified in model
  fitting. The <code><a href="betadisper.html">betadisper</a></code> result with argument
  <code>type = "centroid"</code> is equal to <code><a href="wcmdscale.html">wcmdscale</a></code>,
  <code><a href="dbrda.html">pco</a></code> or <code><a href="dbrda.html">dbrda</a></code> with the same
  <code>group</code> and <code>rank = "full"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function returns a list with components</p>
<dl><dt>centre</dt>
<dd><p>Centre to which a point was originally allocated.</p></dd>

  <dt>nearest</dt>
<dd><p>Nearest centre to a point.</p></dd>

  <dt>distances</dt>
<dd><p>Distance matrix where each observation point is a
    row, and column gives the distance of the point to that centre.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>centerdist</code> is a synonym of <code>centredist</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="betadisper.html">betadisper</a></code>, <code><a href="goodness.cca.html">goodness.cca</a></code>,
  <code><a href="https://rdrr.io/r/stats/mahalanobis.html" class="external-link">mahalanobis</a></code> and various ordination methods.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span> <span class="co"># Bray-Curtis</span></span></span>
<span class="r-in"><span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu"><a href="betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">Management</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">centredist</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distances:  bray </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    centre nearest         BF        HF        NM        SF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      SF      BF 0.49644568 0.5418457 0.8517511 0.5644371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      BF      BF 0.25251672 0.3780172 0.7075570 0.4114648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      SF      SF 0.41470128 0.3855665 0.6204737 0.1110907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      SF      SF 0.42624976 0.4393619 0.6358864 0.2266270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      HF      HF 0.37738597 0.2087227 0.6498706 0.5146204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      HF      HF 0.34039792 0.2456723 0.6126336 0.5642756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      HF      HF 0.29310989 0.1150411 0.6612193 0.4818030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      HF      SF 0.50164812 0.4375138 0.4274640 0.2449894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      HF      SF 0.53148596 0.3887899 0.5918427 0.2614780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     BF      BF 0.03881034 0.2868014 0.6154078 0.5175787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     BF      BF 0.36741961 0.4427340 0.5443921 0.5525589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     SF      SF 0.67759762 0.5249557 0.5627151 0.3810054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     SF      SF 0.67165475 0.5651190 0.5987912 0.3495776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     NM      NM 0.75201600 0.7713289 0.4241926 0.6703521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     NM      NM 0.81690124 0.7245346 0.3013518 0.6254642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     SF      NM 0.86797919 0.7654150 0.4951610 0.5510415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     NM      NM 0.66496238 0.6792701 0.6563399 0.8377509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     NM      BF 0.44376561 0.5052147 0.5074504 0.6320749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     NM      NM 0.67278867 0.6880656 0.5126987 0.7579196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     NM      NM 0.86808311 0.7719325 0.3037948 0.6683067</span>
<span class="r-in"><span>  <span class="co">## equal to metric scaling when using centroids instead of medians</span></span></span>
<span class="r-in"><span>  <span class="va">modc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu"><a href="betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">Management</span>, type <span class="op">=</span> <span class="st">"centroid"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="dbrda.html">pco</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu">centredist</span><span class="op">(</span><span class="va">modc</span><span class="op">)</span>, <span class="fu">centredist</span><span class="op">(</span><span class="va">ord</span>, <span class="va">dune.env</span><span class="op">$</span><span class="va">Management</span>, rank<span class="op">=</span><span class="st">"full"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     check.attributes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

