<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Design your own Dissimilarities — designdist • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Design your own Dissimilarities — designdist"><meta name="description" content="

Function designdist lets you define your own dissimilarities
  using terms for shared and total quantities, number of rows and number
  of columns. The shared and total quantities can be binary, quadratic
  or minimum terms. In binary terms, the shared component is number of
  shared species, and totals are numbers of species on sites. The
  quadratic terms are cross-products and sums of squares, and minimum
  terms are sums of parallel minima and row totals. Function
  designdist2 is similar, but finds dissimilarities among two
  data sets. Function chaodist lets you define your own
  dissimilarities using terms that are supposed to take into account the
  &amp;#8220;unseen species&amp;#8221; (see Chao et al., 2005 and Details in
  vegdist)."><meta property="og:description" content="

Function designdist lets you define your own dissimilarities
  using terms for shared and total quantities, number of rows and number
  of columns. The shared and total quantities can be binary, quadratic
  or minimum terms. In binary terms, the shared component is number of
  shared species, and totals are numbers of species on sites. The
  quadratic terms are cross-products and sums of squares, and minimum
  terms are sums of parallel minima and row totals. Function
  designdist2 is similar, but finds dissimilarities among two
  data sets. Function chaodist lets you define your own
  dissimilarities using terms that are supposed to take into account the
  &amp;#8220;unseen species&amp;#8221; (see Chao et al., 2005 and Details in
  vegdist)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Design your own Dissimilarities</h1>

      <div class="d-none name"><code>designdist.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Function <code>designdist</code> lets you define your own dissimilarities
  using terms for shared and total quantities, number of rows and number
  of columns. The shared and total quantities can be binary, quadratic
  or minimum terms. In binary terms, the shared component is number of
  shared species, and totals are numbers of species on sites. The
  quadratic terms are cross-products and sums of squares, and minimum
  terms are sums of parallel minima and row totals. Function
  <code>designdist2</code> is similar, but finds dissimilarities among two
  data sets. Function <code>chaodist</code> lets you define your own
  dissimilarities using terms that are supposed to take into account the
  “unseen species” (see Chao et al., 2005 and Details in
  <code><a href="vegdist.html">vegdist</a></code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">designdist</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"(A+B-2*J)/(A+B)"</span>,</span>
<span>           terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"binary"</span>, <span class="st">"quadratic"</span>, <span class="st">"minimum"</span><span class="op">)</span>, </span>
<span>           abcd <span class="op">=</span> <span class="cn">FALSE</span>, alphagamma <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">name</span>, <span class="va">maxdist</span><span class="op">)</span></span>
<span><span class="fu">designdist2</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"(A+B-2*J)/(A+B)"</span>,</span>
<span>           terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"binary"</span>, <span class="st">"quadratic"</span>, <span class="st">"minimum"</span><span class="op">)</span>,</span>
<span>           abcd <span class="op">=</span> <span class="cn">FALSE</span>, alphagamma <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">name</span>, <span class="va">maxdist</span><span class="op">)</span></span>
<span><span class="fu">chaodist</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"1 - 2*U*V/(U+V)"</span>, <span class="va">name</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Input data.</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Another input data set: dissimilarities will be calculated
    among rows of <code>x</code> and rows of <code>y</code>.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Equation for your dissimilarities. This can use terms
    <code>J</code> for shared quantity, <code>A</code> and <code>B</code> for totals,
    <code>N</code> for the number of rows (sites) and <code>P</code> for the
    number of columns (species) or in <code>chaodist</code> it can use terms
    <code>U</code> and <code>V</code>. The equation can also contain any <span style="R">R</span>
    functions that accepts vector arguments and returns vectors of the
    same length.</p></dd>

  <dt id="arg-terms">terms<a class="anchor" aria-label="anchor" href="#arg-terms"></a></dt>
<dd><p>How shared and total components are found. For vectors
    <code>x</code> and <code>y</code> the  <code>"quadratic"</code> terms are <code>J = sum(x*y)</code>,
    <code>A = sum(x^2)</code>, <code>B = sum(y^2)</code>, and <code>"minimum"</code> terms
    are <code>J = sum(pmin(x,y))</code>, <code>A = sum(x)</code> and <code>B = sum(y)</code>,
    and <code>"binary"</code> terms are either of these after transforming
    data into binary form (shared number of species, and number of
    species for each row).</p></dd>

  <dt id="arg-abcd">abcd<a class="anchor" aria-label="anchor" href="#arg-abcd"></a></dt>
<dd><p>Use 2x2 contingency table notation for binary data:
    \(a\) is the number of shared species, \(b\) and \(c\) are the
    numbers of species occurring only one of the sites but not in both,
    and \(d\) is the number of species that occur on neither of the sites.</p></dd>

  <dt id="arg-alphagamma">alphagamma<a class="anchor" aria-label="anchor" href="#arg-alphagamma"></a></dt>
<dd><p>Use beta diversity notation with terms
    <code>alpha</code> for average alpha diversity for compared sites,
    <code>gamma</code> for diversity in pooled sites, and <code>delta</code> for the
    absolute value of difference of average <code>alpha</code> and alpha
    diversities of compared sites. Terms <code>A</code> and
    <code>B</code> refer to alpha diversities of compared sites.</p></dd>

  <dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>The name you want to use for your index. The default is to
    combine the <code>method</code> equation and <code>terms</code> argument.</p></dd>

  <dt id="arg-maxdist">maxdist<a class="anchor" aria-label="anchor" href="#arg-maxdist"></a></dt>
<dd><p>Theoretical maximum of the dissimilarity, or <code>NA</code>
    if index is open and has no absolute maximum. This is not a necessary
    argument, but only used in some <span class="pkg">vegan</span> functions, and if you are
    not certain about the maximum, it is better not supply any value.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Most popular dissimilarity measures in ecology can be expressed with
  the help of terms <code>J</code>, <code>A</code> and <code>B</code>, and some also involve
  matrix dimensions <code>N</code> and <code>P</code>. Some examples you can define in
  <code>designdist</code> are:</p><table class="table table"><tr><td><code>A+B-2*J</code></td><td><code>"quadratic"</code></td><td>squared Euclidean</td></tr><tr><td><code>A+B-2*J</code></td><td><code>"minimum"</code></td><td>Manhattan</td></tr><tr><td><code>(A+B-2*J)/(A+B)</code></td><td><code>"minimum"</code></td><td>Bray-Curtis</td></tr><tr><td><code>(A+B-2*J)/(A+B)</code></td><td><code>"binary"</code></td><td>Sørensen</td></tr><tr><td><code>(A+B-2*J)/(A+B-J)</code></td><td><code>"binary"</code></td><td>Jaccard</td></tr><tr><td><code>(A+B-2*J)/(A+B-J)</code></td><td><code>"minimum"</code></td><td>Ružička</td></tr><tr><td><code>(A+B-2*J)/(A+B-J)</code></td><td><code>"quadratic"</code></td><td>(dis)similarity ratio</td></tr><tr><td><code>1-J/sqrt(A*B)</code></td><td><code>"binary"</code></td><td>Ochiai</td></tr><tr><td><code>1-J/sqrt(A*B)</code></td><td><code>"quadratic"</code></td><td>cosine
    complement</td></tr><tr><td><code>1-phyper(J-1, A, P-A, B)</code></td><td><code>"binary"</code></td><td>Raup-Crick (but see <code><a href="raupcrick.html">raupcrick</a></code>)</td></tr></table><p>The function <code>designdist</code> can implement most dissimilarity
  indices in <code><a href="vegdist.html">vegdist</a></code> or elsewhere, and it can also be
  used to implement many other indices, amongst them, most of those
  described in Legendre &amp; Legendre (2012). It can also be used to
  implement all indices of beta diversity described in Koleff et
  al. (2003), but there also is a specific function
  <code><a href="betadiver.html">betadiver</a></code> for the purpose.</p>
<p>If you want to implement binary dissimilarities based on the 2x2
  contingency table notation, you can set <code>abcd = TRUE</code>. In this
  notation <code>a = J</code>, <code>b = A-J</code>, <code>c = B-J</code>, <code>d = P-A-B+J</code>.
  This notation is often used instead of the more more
  tangible default notation for reasons that are opaque to me.</p>
<p>With <code>alphagamma = TRUE</code> it is possible to use beta diversity
  notation with terms <code>alpha</code> for average alpha diversity and
  <code>gamma</code> for gamma diversity in two compared sites. The terms
  are calculated as <code>alpha = (A+B)/2</code>, <code>gamma = A+B-J</code> and
  <code>delta = abs(A-B)/2</code>.  Terms <code>A</code> and <code>B</code> are also
  available and give the alpha diversities of the individual compared
  sites.  The beta diversity terms may make sense only for binary
  terms (so that diversities are expressed in numbers of species), but
  they are calculated for quadratic and minimum terms as well (with a
  warning).</p>
<p>Function <code>chaodist</code> is similar to <code>designgist</code>, but uses
  terms <code>U</code> and <code>V</code> of Chao et al. (2005). These terms are
  supposed to take into account the effects of unseen species. Both
  <code>U</code> and <code>V</code> are scaled to range \(0 \dots 1\). They take
  the place of <code>A</code> and <code>B</code> and the product <code>U*V</code> is used
  in the place of <code>J</code> of <code>designdist</code>.  Function
  <code>chaodist</code> can implement any commonly used Chao et al. (2005)
  style dissimilarity:</p><table class="table table"><tr><td><code>1 - 2*U*V/(U+V)</code></td><td>Sørensen type</td></tr><tr><td><code>1 - U*V/(U+V-U*V)</code></td><td>Jaccard type</td></tr><tr><td><code>1 - sqrt(U*V)</code></td><td>Ochiai type</td></tr><tr><td><code>(pmin(U,V) - U*V)/pmin(U,V)</code></td><td>Simpson type</td></tr></table><p>Function <code><a href="vegdist.html">vegdist</a></code> implements Jaccard-type Chao distance,
  and its documentation contains more complete discussion on the
  calculation of the terms.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>designdist</code> returns an object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Chao, A., Chazdon, R. L., Colwell, R. K. and Shen, T. (2005) A new
  statistical approach for assessing similarity of species composition
  with incidence and abundance data. <em>Ecology Letters</em> <strong>8</strong>,
  148–159.</p>
<p>Koleff, P., Gaston, K.J. and Lennon, J.J. (2003) Measuring beta
  diversity for presence–absence data. <em>J. Animal Ecol.</em>
  <strong>72</strong>, 367–382.</p>
<p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd
  English ed. Elsevier</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>designdist</code> does not use compiled code, but it is based on
  vectorized <span style="R">R</span> code. The <code>designdist</code> function can be much
  faster than <code><a href="vegdist.html">vegdist</a></code>, although the latter uses compiled
  code. However, <code>designdist</code> cannot skip missing values and uses
  much more memory during calculations.</p>
<p>The use of sum terms can be numerically unstable. In particularly,
  when these terms are large, the precision may be lost. The risk is
  large when the number of columns is high, and particularly large with
  quadratic terms. For precise calculations it is better to use
  functions like <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> and <code><a href="vegdist.html">vegdist</a></code> which are
  more robust against numerical problems.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="vegdist.html">vegdist</a></code>, <code><a href="betadiver.html">betadiver</a></code>, <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>,
  <code><a href="raupcrick.html">raupcrick</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BCI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Four ways of calculating the same Sørensen dissimilarity</span></span></span>
<span class="r-in"><span><span class="va">d0</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"bray"</span>, binary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu">designdist</span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"(A+B-2*J)/(A+B)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu">designdist</span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"(b+c)/(2*a+b+c)"</span>, abcd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu">designdist</span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"gamma/alpha - 1"</span>, alphagamma <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Arrhenius dissimilarity: the value of z in the species-area model</span></span></span>
<span class="r-in"><span><span class="co">## S = c*A^z when combining two sites of equal areas, where S is the</span></span></span>
<span class="r-in"><span><span class="co">## number of species, A is the area, and c and z are model parameters.</span></span></span>
<span class="r-in"><span><span class="co">## The A below is not the area (which cancels out), but number of</span></span></span>
<span class="r-in"><span><span class="co">## species in one of the sites, as defined in designdist().</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu">designdist</span><span class="op">(</span><span class="va">BCI</span>, <span class="st">"(log(A+B-J)-log(A+B)+log(2))/log(2)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## This can be used in clustering or ordination...</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ordiplot.html">ordiplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> species scores not available</span>
<span class="r-plt img"><img src="designdist-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## ... or in analysing beta diversity (without gradients)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2733  0.3895  0.4192  0.4213  0.4537  0.5906 </span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

