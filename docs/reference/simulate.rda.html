<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function simulates a response data frame so that it adds
 Gaussian error to the fitted responses of Redundancy Analysis
 (rda), Constrained Correspondence Analysis
 (cca) or distance-based RDA (capscale).
 The function is a special case of generic simulate, and
 works similarly as simulate.lm."><title>Simulate Responses with Gaussian Error or Permuted Residuals for Constrained Ordination — simulate.rda • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate Responses with Gaussian Error or Permuted Residuals for Constrained Ordination — simulate.rda"><meta property="og:description" content="Function simulates a response data frame so that it adds
 Gaussian error to the fitted responses of Redundancy Analysis
 (rda), Constrained Correspondence Analysis
 (cca) or distance-based RDA (capscale).
 The function is a special case of generic simulate, and
 works similarly as simulate.lm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate Responses with Gaussian Error or Permuted Residuals for Constrained Ordination</h1>
      
      <div class="d-none name"><code>simulate.rda.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function simulates a response data frame so that it adds
 Gaussian error to the fitted responses of Redundancy Analysis
 (<code><a href="cca.html">rda</a></code>), Constrained Correspondence Analysis
 (<code><a href="cca.html">cca</a></code>) or distance-based RDA (<code><a href="dbrda.html">capscale</a></code>).
 The function is a special case of generic <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></code>, and
 works similarly as <code>simulate.lm</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for rda</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">object</span>, nsim <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, indx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    rank <span class="op">=</span> <span class="st">"full"</span>, correlated <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>an object representing a fitted <code><a href="cca.html">rda</a></code>,
    <code><a href="cca.html">cca</a></code> or <code><a href="dbrda.html">capscale</a></code> model.</p></dd>


  <dt>nsim</dt>
<dd><p>number of response matrices to be simulated. Only one
    dissimilarity matrix is returned for <code><a href="dbrda.html">capscale</a></code>, and
    larger <code>nsim</code> is an error.</p></dd>


  <dt>seed</dt>
<dd><p>an object specifying if and how the random number
    generator should be initialized (‘seeded’). See 
    <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></code> for details.</p></dd>


  <dt>indx</dt>
<dd><p>Index of residuals added to the fitted values, such as
    produced by <code><a href="https://rdrr.io/pkg/permute/man/shuffleSet.html" class="external-link">shuffleSet</a></code> or
    <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></code>.  The index can have duplicate entries so
    that bootstrapping is allowed. If <code>nsim</code> \(&gt;1\), the output
    should be compliant with <code><a href="https://rdrr.io/pkg/permute/man/shuffleSet.html" class="external-link">shuffleSet</a></code> with
    one line for each simulation.  If <code>nsim</code> is missing, the
    number of rows of <code>indx</code> is used to define the number of
    simulations, but if <code>nsim</code> is given, it should match number
    of rows in <code>indx</code>. If null, parametric simulation is used and
    Gaussian error is added to the fitted values.</p></dd>


  <dt>rank</dt>
<dd><p>The rank of the constrained component: passed to
    <code><a href="predict.cca.html">predict.rda</a></code> or <code><a href="predict.cca.html">predict.cca</a></code>.</p></dd>


  <dt>correlated</dt>
<dd><p>Are species regarded as correlated in parametric
    simulation or when <code>indx</code> is not given? If
    <code>correlated = TRUE</code>, multivariate Gaussian random error is
    generated, and if <code>FALSE</code>, Gaussian random error is generated
    separately for each species. The argument has no effect in
    <code><a href="dbrda.html">capscale</a></code> which has no information on species.</p></dd>


  <dt>...</dt>
<dd><p>additional optional arguments (ignored).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The implementation follows <code>"lm"</code> method of
  <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></code>, and adds Gaussian (Normal) error to the fitted
  values (<code><a href="predict.cca.html">fitted.rda</a></code>) using function <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></code>
  if <code>correlated = FALSE</code> or <code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></code> if
  <code>correlated = TRUE</code>. The standard deviations (<code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></code>)
  or covariance matrices for species (<code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></code>) are
  estimated from the residuals after fitting the constraints.
  Alternatively, the function can take a permutation index that is used
  to add permuted residuals (unconstrained component) to the fitted
  values. Raw data are used in <code><a href="cca.html">rda</a></code>. Internal Chi-square
  transformed data are used in <code><a href="cca.html">cca</a></code> within the function,
  but the returned matrix is similar to the original input data. The
  simulation is performed on internal metric scaling data in
  <code><a href="dbrda.html">capscale</a></code>, but the function returns the Euclidean
  distances calculated from the simulated data.  The simulation uses
  only the real components, and the imaginary dimensions are ignored.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>nsim = 1</code>, returns a matrix or dissimilarities (in</p>
<p></p>
<p><code><a href="dbrda.html">capscale</a></code>) with similar additional arguments on random
  number seed as <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></code>. If <code>nsim &gt; 1</code>, returns a
  similar array as returned by <code><a href="nullmodel.html">simulate.nullmodel</a></code> with
  similar attributes.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></code> for the generic case and for
  <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> objects, and <code><a href="nullmodel.html">simulate.nullmodel</a></code> for
  community null model simulation. Functions <code><a href="predict.cca.html">fitted.rda</a></code>
  and <code><a href="predict.cca.html">fitted.cca</a></code> return fitted values without the error
  component. See <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></code> and <code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></code>
  (<span class="pkg">MASS</span> package) for simulating Gaussian random error.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span>  <span class="va">Moisture</span> <span class="op">+</span> <span class="va">Management</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## One simulation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="op">~</span>  <span class="va">.</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = simulate(mod) ~ Moisture + Management, data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         79.3906     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   52.2955     0.6587    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 27.0951     0.3413   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RDA1   RDA2   RDA3   RDA4   RDA5   RDA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24.007 14.238  5.712  3.314  2.879  2.145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10  PC11  PC12  PC13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.128 4.391 3.331 3.143 2.121 1.757 1.488 1.152 1.115 1.044 0.682 0.539 0.205 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## An impression of confidence regions of site scores</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, display<span class="op">=</span><span class="st">"sites"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="procrustes.html">procrustes</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simulate.rda-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Simulate a set of null communities with permutation of residuals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">mod</span>, indx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/permute/man/shuffleSet.html" class="external-link">shuffleSet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span>, <span class="fl">99</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class “simulate.rda” </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ‘simulate index’ method (abundance, non-sequential)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 x 30 matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permuted matrices = 99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

