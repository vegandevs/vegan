<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trellis (Lattice) Plots for Ordination — ordixyplot • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trellis (Lattice) Plots for Ordination — ordixyplot"><meta name="description" content="Functions ordicloud, ordisplom and ordixyplot
  provide an interface to plot ordination results using Trellis
  functions cloud, splom
  and xyplot in package lattice."><meta property="og:description" content="Functions ordicloud, ordisplom and ordixyplot
  provide an interface to plot ordination results using Trellis
  functions cloud, splom
  and xyplot in package lattice."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Trellis (Lattice) Plots for Ordination</h1>

      <div class="d-none name"><code>ordixyplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions <code>ordicloud</code>, <code>ordisplom</code> and <code>ordixyplot</code>
  provide an interface to plot ordination results using Trellis
  functions <code><a href="https://rdrr.io/pkg/lattice/man/cloud.html" class="external-link">cloud</a></code>, <code><a href="https://rdrr.io/pkg/lattice/man/splom.html" class="external-link">splom</a></code>
  and <code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></code> in package <span class="pkg">lattice</span>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ordixyplot</span><span class="op">(</span><span class="va">x</span>, data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">formula</span>, display <span class="op">=</span> <span class="st">"sites"</span>, choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>    panel <span class="op">=</span> <span class="st">"panel.ordi"</span>, aspect <span class="op">=</span> <span class="st">"iso"</span>, <span class="va">envfit</span>,</span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"biplot"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">ordisplom</span><span class="op">(</span><span class="va">x</span>, data<span class="op">=</span><span class="cn">NULL</span>, formula <span class="op">=</span> <span class="cn">NULL</span>,  display <span class="op">=</span> <span class="st">"sites"</span>, choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>    panel <span class="op">=</span> <span class="st">"panel.ordi"</span>, type <span class="op">=</span> <span class="st">"p"</span>,  <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">ordicloud</span><span class="op">(</span><span class="va">x</span>, data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">formula</span>, display <span class="op">=</span> <span class="st">"sites"</span>, choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span>
<span>    panel <span class="op">=</span> <span class="st">"panel.ordi3d"</span>, prepanel <span class="op">=</span> <span class="st">"prepanel.ordi3d"</span>,  <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An ordination result that <code><a href="scores.html">scores</a></code> knows: any
    ordination result in <span class="pkg">vegan</span> and many others.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Optional data to amend ordination results. The ordination
    results are found from <code>x</code>, but you may give here data for other
    variables needed in plots. Typically these are environmental data.</p></dd>

  <dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Formula to define the plots. A default formula will be
    used if this is omitted. The
    ordination axes must be called by the same names as in the
    ordination results (and these names vary among methods). In
    <code>ordisplom</code>, special character <code>.</code> refers to the
    ordination result.</p></dd>

  <dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>The kind of scores: an argument passed to
    <code><a href="scores.html">scores</a></code>.</p></dd>

  <dt id="arg-choices">choices<a class="anchor" aria-label="anchor" href="#arg-choices"></a></dt>
<dd><p>The axes selected: an argument passed to
    <code><a href="scores.html">scores</a></code>.</p></dd>

  <dt id="arg-panel-prepanel">panel, prepanel<a class="anchor" aria-label="anchor" href="#arg-panel-prepanel"></a></dt>
<dd><p>The names of the panel and prepanel
    functions.</p></dd>

  <dt id="arg-aspect">aspect<a class="anchor" aria-label="anchor" href="#arg-aspect"></a></dt>
<dd><p>The aspect of the plot (passed to the <span class="pkg">lattice</span>
    function).</p></dd>

  <dt id="arg-envfit">envfit<a class="anchor" aria-label="anchor" href="#arg-envfit"></a></dt>
<dd><p>Result of <code><a href="envfit.html">envfit</a></code> function displayed in
    <code>ordixyplot</code>. Please note that this needs same <code>choices</code>
    as <code>ordixyplot</code>.</p></dd>


  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of plot. This knows the same alternatives as
    <code><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.xyplot</a></code>. In addition <code>ordixyplot</code>
    has alternatives <code>"biplot"</code>, <code>"arrows"</code> and
    <code>"polygon"</code>. The first displays fitted vectors and factor
    centroids of <code>envfit</code>, or in constrained ordination, the
    biplot arrows and factor centroids if <code>envfit</code> is not
    given. The second (<code>type = "arrows"</code>) is a trellis variant of
    <code><a href="ordiarrows.html">ordiarrows</a></code> and draws arrows by <code>groups</code>. The
    line parameters are controlled by
    <code><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html" class="external-link">trellis.par.set</a></code> for <code>superpose.line</code>,
    and the user can set <code>length</code>, <code>angle</code> and <code>ends</code>
    parameters of <code><a href="https://rdrr.io/pkg/lattice/man/llines.html" class="external-link">panel.arrows</a></code>.  The last one
    (<code>type = "polygon"</code>) draws a polygon enclosing all points in
    a panel over a polygon enclosing all points in the data. The
    overall polygon is controlled by
    <code><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html" class="external-link">trellis.par.set</a></code> for <code>plot.polygon</code>,
    and each panel polygon is controlled by <code>superpose.polygon</code>.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to <code><a href="scores.html">scores</a></code> methods or
    <span class="pkg">lattice</span> functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The functions provide an interface to the corresponding <span class="pkg">lattice</span>
  functions.  All graphical parameters are passed to the <span class="pkg">lattice</span>
  function so that these graphs are extremely configurable. See
  <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">Lattice</a></code> and <code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></code>,
    <code><a href="https://rdrr.io/pkg/lattice/man/splom.html" class="external-link">splom</a></code> and <code><a href="https://rdrr.io/pkg/lattice/man/cloud.html" class="external-link">cloud</a></code> for
  details, usage and possibilities.</p>
<p>The argument <code>x</code> must always be an ordination result. The scores
  are extracted with <span class="pkg">vegan</span> function <code><a href="scores.html">scores</a></code> so that
  these functions work with all <span class="pkg">vegan</span> ordinations and many others.</p>
<p>The <code>formula</code> is used to define the models. All functions have
  simple default formulae which are used if <code>formula</code> is missing.
  If formula is omitted in <code>ordisplom</code> it
  produces a pairs plot of ordination axes and variables in
  <code>data</code>. If <code>formula</code> is given, ordination results must be
  referred to as <code>.</code> and other variables by their names. In other
  functions, the formula must use the names of ordination scores and names
  of <code>data</code>.</p>
<p>The ordination scores are found from <code>x</code>, and <code>data</code> is
  optional. The <code>data</code> should contain other variables than
  ordination scores to be used in plots. Typically, they are
  environmental variables (typically factors) to define panels or plot
  symbols.</p>
<p>The proper work is done by the panel function. The layout can be
  changed by defining own panel functions. See
  <code><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.xyplot</a></code>,
  <code><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.splom</a></code> and
  <code><a href="https://rdrr.io/pkg/lattice/man/panel.cloud.html" class="external-link">panel.cloud</a></code> for details and survey of
  possibilities.</p>
<p>Ordination graphics should always be isometric: same scale should be
  used in all axes. This is controlled (and can be changed) with
  argument <code>aspect</code> in <code>ordixyplot</code>. In <code>ordicloud</code> the
  isometric scaling is defined in <code>panel</code> and <code>prepanel</code>
  functions. You must replace these functions if you want to have
  non-isometric scaling of graphs. You cannot select isometric scaling
  in <code>ordisplom</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function return <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">Lattice</a></code> objects of class
  <code>"trellis"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">Lattice</a></code>,
  <code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></code>,
  <code><a href="https://rdrr.io/pkg/lattice/man/splom.html" class="external-link">splom</a></code>,
  <code><a href="https://rdrr.io/pkg/lattice/man/cloud.html" class="external-link">cloud</a></code>,
  <code><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.splom</a></code>,
  <code><a href="https://rdrr.io/pkg/lattice/man/panel.cloud.html" class="external-link">panel.cloud</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Pairs plots</span></span></span>
<span class="r-in"><span><span class="fu">ordisplom</span><span class="op">(</span><span class="va">ord</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu">ordisplom</span><span class="op">(</span><span class="va">ord</span>, data<span class="op">=</span><span class="va">dune.env</span>, choices<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu">ordisplom</span><span class="op">(</span><span class="va">ord</span>, data<span class="op">=</span><span class="va">dune.env</span>, form <span class="op">=</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">Management</span>, groups<span class="op">=</span><span class="va">Manure</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Scatter plot with polygons</span></span></span>
<span class="r-in"><span><span class="fu">ordixyplot</span><span class="op">(</span><span class="va">ord</span>, data<span class="op">=</span><span class="va">dune.env</span>, form <span class="op">=</span> <span class="va">CA1</span> <span class="op">~</span> <span class="va">CA2</span> <span class="op">|</span> <span class="va">Management</span>,</span></span>
<span class="r-in"><span>  groups<span class="op">=</span><span class="va">Manure</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>,<span class="st">"polygon"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-4.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Choose a different scaling</span></span></span>
<span class="r-in"><span><span class="fu">ordixyplot</span><span class="op">(</span><span class="va">ord</span>, scaling <span class="op">=</span> <span class="st">"symmetric"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-5.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## ... Slices of third axis</span></span></span>
<span class="r-in"><span><span class="fu">ordixyplot</span><span class="op">(</span><span class="va">ord</span>, form <span class="op">=</span> <span class="va">CA1</span> <span class="op">~</span> <span class="va">CA2</span> <span class="op">|</span> <span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/shingles.html" class="external-link">equal.count</a></span><span class="op">(</span><span class="va">CA3</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>,<span class="st">"p"</span>, <span class="st">"polygon"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-6.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Display environmental variables</span></span></span>
<span class="r-in"><span><span class="fu">ordixyplot</span><span class="op">(</span><span class="va">ord</span>, envfit <span class="op">=</span> <span class="fu"><a href="envfit.html">envfit</a></span><span class="op">(</span><span class="va">ord</span> <span class="op">~</span> <span class="va">Management</span> <span class="op">+</span> <span class="va">A1</span>, <span class="va">dune.env</span>, choices<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-7.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## 3D Scatter plots</span></span></span>
<span class="r-in"><span><span class="fu">ordicloud</span><span class="op">(</span><span class="va">ord</span>, form <span class="op">=</span> <span class="va">CA2</span> <span class="op">~</span> <span class="va">CA3</span><span class="op">*</span><span class="va">CA1</span>, groups <span class="op">=</span> <span class="va">Manure</span>, data <span class="op">=</span> <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-8.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu">ordicloud</span><span class="op">(</span><span class="va">ord</span>, form <span class="op">=</span> <span class="va">CA2</span> <span class="op">~</span> <span class="va">CA3</span><span class="op">*</span><span class="va">CA1</span> <span class="op">|</span> <span class="va">Management</span>, groups <span class="op">=</span> <span class="va">Manure</span>,</span></span>
<span class="r-in"><span>   data <span class="op">=</span> <span class="va">dune.env</span>, auto.key <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>,<span class="st">"h"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordixyplot-9.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

