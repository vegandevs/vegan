<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Screeplots for Ordination Results and Broken Stick Distributions — screeplot.cca • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Screeplots for Ordination Results and Broken Stick Distributions — screeplot.cca"><meta name="description" content="Screeplot methods for plotting variances of ordination axes/components
  and overlaying broken stick distributions. Also, provides alternative
  screeplot methods for princomp and prcomp."><meta property="og:description" content="Screeplot methods for plotting variances of ordination axes/components
  and overlaying broken stick distributions. Also, provides alternative
  screeplot methods for princomp and prcomp."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Screeplots for Ordination Results and Broken Stick Distributions</h1>

      <div class="d-none name"><code>screeplot.cca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Screeplot methods for plotting variances of ordination axes/components
  and overlaying broken stick distributions. Also, provides alternative
  screeplot methods for <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></code> and <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>         npcs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">CCA</span><span class="op">)</span> <span class="op">||</span> <span class="va">x</span><span class="op">$</span><span class="va">CCA</span><span class="op">$</span><span class="va">rank</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">CA</span><span class="op">$</span><span class="va">rank</span> <span class="kw">else</span> <span class="va">x</span><span class="op">$</span><span class="va">CCA</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span>,</span>
<span>         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, legend <span class="op">=</span> <span class="va">bstick</span>,</span>
<span>         <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'decorana'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>         npcs <span class="op">=</span> <span class="fl">4</span>,</span>
<span>         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, legend <span class="op">=</span> <span class="va">bstick</span>,</span>
<span>         <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'prcomp'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>         npcs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, legend <span class="op">=</span> <span class="va">bstick</span>,</span>
<span>         <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'princomp'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>         npcs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, legend <span class="op">=</span> <span class="va">bstick</span>,</span>
<span>         <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, tot.var <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'prcomp'</span></span>
<span><span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'princomp'</span></span>
<span><span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'decorana'</span></span>
<span><span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object from which the component variances can be determined.</p></dd>

  <dt id="arg-bstick">bstick<a class="anchor" aria-label="anchor" href="#arg-bstick"></a></dt>
<dd><p>logical; should the broken stick distribution be drawn?</p></dd>

  <dt id="arg-npcs">npcs<a class="anchor" aria-label="anchor" href="#arg-npcs"></a></dt>
<dd><p>the number of components to be plotted.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>the type of plot.</p></dd>

  <dt id="arg-ptype">ptype<a class="anchor" aria-label="anchor" href="#arg-ptype"></a></dt>
<dd><p>if <code>type == "lines"</code> or <code>bstick = TRUE</code>, a
    character indicating the type of plotting used for the lines;
    actually any of the <code>type</code>s as in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></code>.</p></dd>

  <dt id="arg-bst-col-bst-lty">bst.col, bst.lty<a class="anchor" aria-label="anchor" href="#arg-bst-col-bst-lty"></a></dt>
<dd><p>the colour and line type used to draw the
    broken stick distribution.</p></dd>

  <dt id="arg-xlab-ylab-main">xlab, ylab, main<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab-main"></a></dt>
<dd><p>graphics parameters.</p></dd>

  <dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>logical; draw a legend?</p></dd>

  <dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>an object from which the variances can be extracted or the
    number of variances (components) in the case of
    <code>bstick.default</code>.</p></dd>

  <dt id="arg-tot-var">tot.var<a class="anchor" aria-label="anchor" href="#arg-tot-var"></a></dt>
<dd><p>the total variance to be split.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed to other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The functions provide screeplots for most ordination methods in
  <span class="pkg">vegan</span> and enhanced versions with broken stick for
  <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code> and <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></code>.</p>
<p>Function <code>bstick</code> gives the brokenstick values which are ordered
  random proportions, defined as  \(p_i = (tot/n) \sum_{x=i}^n
    (1/x)\) (Legendre &amp; Legendre 2012), where
  \(tot\) is the total  and \(n\) is the number of brokenstick
  components (cf. <code><a href="radfit.html">radfit</a></code>).  Broken stick has
  been recommended as a stopping rule in principal component analysis
  (Jackson 1993): principal components should be retained as long as
  observed eigenvalues are higher than corresponding random broken stick
  components.</p>
<p>The <code>bstick</code> function is generic. The default needs the number of
  components and the total, and specific methods extract this
  information from ordination results.  There also is a <code>bstick</code>
  method for <code><a href="cca.html">cca</a></code>.  However, the broken stick model is not
  strictly valid for correspondence analysis (CA), because eigenvalues
  of CA are defined to be \(\leq 1\), whereas brokenstick
  components have no such restrictions. The brokenstick components in
  detrended correspondence analysis (DCA) assume that input data are of
  full rank, and additive eigenvalues are used in <code>screeplot</code> (see
  <code><a href="decorana.html">decorana</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>screeplot</code> draws a plot on the currently active device,
  and returns invisibly the <code><a href="https://rdrr.io/r/grDevices/xy.coords.html" class="external-link">xy.coords</a></code> of the points or
  bars for the eigenvalues.</p>
<p>Function <code>bstick</code> returns a numeric vector of broken stick
  components.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jackson, D. A. (1993). Stopping rules in principal components
  analysis: a comparison of heuristical and statistical
  approaches. <em>Ecology</em> 74, 2204–2214.</p>
<p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd English
  ed. Elsevier.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gavin L. Simpson</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cca.html">cca</a></code>, <code><a href="decorana.html">decorana</a></code>, <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></code> and
  <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code> for the ordination functions, and
  <code><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></code> for the stock version.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="va">varespec</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bstick</span><span class="op">(</span><span class="va">vare.pca</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PC1       PC2       PC3       PC4       PC5       PC6       PC7       PC8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.1438620 5.2308185 4.2742968 3.6366156 3.1583548 2.7757461 2.4569055 2.1836136 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PC9      PC10      PC11      PC12      PC13      PC14      PC15      PC16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.9444831 1.7319228 1.5406184 1.3667054 1.2072851 1.0601279 0.9234819 0.7959457 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PC17      PC18      PC19      PC20      PC21      PC22      PC23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6763805 0.5638485 0.4575683 0.3568818 0.2612296 0.1701323 0.0831758 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">vare.pca</span>, bstick <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"lines"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="screeplot.cca-1.png" alt="" width="700" height="1133"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

