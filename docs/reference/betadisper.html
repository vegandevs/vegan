<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Implements Marti Anderson's PERMDISP2 procedure for the analysis of
  multivariate homogeneity of group dispersions (variances).
  betadisper is a multivariate analogue of Levene's test for
  homogeneity of variances. Non-euclidean distances between objects and
  group centres (centroids or medians) are handled by reducing the
  original distances to principal coordinates. This procedure has
  latterly been used as a means of assessing beta diversity. There are
  anova, scores, plot and boxplot methods.
TukeyHSD.betadisper creates a set of confidence intervals on
  the differences between the mean distance-to-centroid of the levels of
  the grouping factor with the specified family-wise probability of
  coverage.  The intervals are based on the Studentized range statistic,
  Tukey's 'Honest Significant Difference' method."><title>Multivariate homogeneity of groups dispersions (variances) — betadisper • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate homogeneity of groups dispersions (variances) — betadisper"><meta property="og:description" content="Implements Marti Anderson's PERMDISP2 procedure for the analysis of
  multivariate homogeneity of group dispersions (variances).
  betadisper is a multivariate analogue of Levene's test for
  homogeneity of variances. Non-euclidean distances between objects and
  group centres (centroids or medians) are handled by reducing the
  original distances to principal coordinates. This procedure has
  latterly been used as a means of assessing beta diversity. There are
  anova, scores, plot and boxplot methods.
TukeyHSD.betadisper creates a set of confidence intervals on
  the differences between the mean distance-to-centroid of the levels of
  the grouping factor with the specified family-wise probability of
  coverage.  The intervals are based on the Studentized range statistic,
  Tukey's 'Honest Significant Difference' method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multivariate homogeneity of groups dispersions (variances)</h1>
      
      <div class="d-none name"><code>betadisper.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements Marti Anderson's PERMDISP2 procedure for the analysis of
  multivariate homogeneity of group dispersions (variances).
  <code>betadisper</code> is a multivariate analogue of Levene's test for
  homogeneity of variances. Non-euclidean distances between objects and
  group centres (centroids or medians) are handled by reducing the
  original distances to principal coordinates. This procedure has
  latterly been used as a means of assessing beta diversity. There are
  <code>anova</code>, <code>scores</code>, <code>plot</code> and <code>boxplot</code> methods.</p>
<p><code>TukeyHSD.betadisper</code> creates a set of confidence intervals on
  the differences between the mean distance-to-centroid of the levels of
  the grouping factor with the specified family-wise probability of
  coverage.  The intervals are based on the Studentized range statistic,
  Tukey's 'Honest Significant Difference' method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">betadisper</span><span class="op">(</span><span class="va">d</span>, <span class="va">group</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span>,<span class="st">"centroid"</span><span class="op">)</span>, bias.adjust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       sqrt.dist <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betadisper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betadisper</span></span>
<span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">x</span>, display <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sites"</span>, <span class="st">"centroids"</span><span class="op">)</span>,</span>
<span>       choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betadisper</span></span>
<span><span class="fu"><a href="eigenvals.html">eigenvals</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betadisper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>     pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ng</span><span class="op">)</span>, col <span class="op">=</span> <span class="cn">NULL</span>, lty <span class="op">=</span> <span class="st">"solid"</span>, lwd <span class="op">=</span> <span class="fl">1</span>, hull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     ellipse <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">conf</span>,</span>
<span>     segments <span class="op">=</span> <span class="cn">TRUE</span>, seg.col <span class="op">=</span> <span class="st">"grey"</span>, seg.lty <span class="op">=</span> <span class="va">lty</span>, seg.lwd <span class="op">=</span> <span class="va">lwd</span>,</span>
<span>     label <span class="op">=</span> <span class="cn">TRUE</span>, label.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     <span class="va">ylab</span>, <span class="va">xlab</span>, <span class="va">main</span>, <span class="va">sub</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betadisper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">x</span>, ylab <span class="op">=</span> <span class="st">"Distance to centroid"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betadisper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="st">"group"</span>, ordered <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         conf.level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for betadisper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                           neigen <span class="op">=</span> <span class="fl">8</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>d</dt>
<dd><p>a distance structure such as that returned by 
    <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, <code><a href="betadiver.html">betadiver</a></code> or
    <code><a href="vegdist.html">vegdist</a></code>.</p></dd>

  <dt>group</dt>
<dd><p>vector describing the group structure, usually a factor
    or an object that can be coerced to a factor using
    <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></code>. Can consist of a factor with a single
    level (i.e., one group).</p></dd>

  <dt>type</dt>
<dd><p>the type of analysis to perform. Use the spatial median or
    the group centroid? The spatial median is now the default.</p></dd>

  <dt>bias.adjust</dt>
<dd><p>logical: adjust for small sample bias in beta
    diversity estimates?</p></dd>

  <dt>sqrt.dist</dt>
<dd><p>Take square root of dissimilarities. This often
    euclidifies dissimilarities.</p></dd>

  <dt>add</dt>
<dd><p>Add a constant to the non-diagonal dissimilarities such
    that all eigenvalues are non-negative in the underlying Principal
    Co-ordinates Analysis (see <code><a href="wcmdscale.html">wcmdscale</a></code> for
    details). Choice <code>"lingoes"</code> (or <code>TRUE</code>) use the
    recommended method of Legendre &amp; Anderson (1999: “method
    1”) and <code>"cailliez"</code> uses their “method 2”.</p></dd>

  <dt>display</dt>
<dd><p>character; partial match to access scores for
    <code>"sites"</code> or <code>"species"</code>.</p></dd>

  <dt>object, x</dt>
<dd><p>an object of class <code>"betadisper"</code>, the result of a
    call to <code>betadisper</code>.</p></dd>

  <dt>choices, axes</dt>
<dd><p>the principal coordinate axes wanted.</p></dd>

  <dt>hull</dt>
<dd><p>logical; should the convex hull for each group be plotted?</p></dd>

  <dt>ellipse</dt>
<dd><p>logical; should the standard deviation data ellipse for
    each group be plotted?</p></dd>

  <dt>conf</dt>
<dd><p>Expected fractions of data coverage for data ellipses,
    e.g. 0.95. The default is to draw a 1 standard deviation data
    ellipse, but if supplied, <code>conf</code> is multiplied with the
    corresponding value found from the Chi-squared distribution with 2df
    to provide the requested coverage (probability contour).</p></dd>

  <dt>pch</dt>
<dd><p>plot symbols for the groups, a vector of length equal to
    the number of groups.</p></dd>

  <dt>col</dt>
<dd><p>colors for the plot symbols and centroid labels for the groups,
    a vector of length equal to the number of groups.</p></dd>

  <dt>lty, lwd</dt>
<dd><p>linetype, linewidth for convex hulls and confidence
    ellipses.</p></dd>

  <dt>segments</dt>
<dd><p>logical; should segments joining points to their
    centroid be drawn?</p></dd>

  <dt>seg.col</dt>
<dd><p>colour to draw segments between points and their
    centroid. Can be a vector, in which case one colour per group.</p></dd>

  <dt>seg.lty, seg.lwd</dt>
<dd><p>linetype and line width for segments.</p></dd>

  <dt>label</dt>
<dd><p>logical; should the centroids by labelled with their
    respective factor label?</p></dd>

  <dt>label.cex</dt>
<dd><p>numeric; character expansion for centroid labels.</p></dd>

  <dt>cex, ylab, xlab, main, sub</dt>
<dd><p>graphical parameters. For details,
    see <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></code>.</p></dd>

  <dt>which</dt>
<dd><p>A character vector listing terms in the fitted model for
    which the intervals should be calculated. Defaults to the grouping
    factor.</p></dd>

  <dt>ordered</dt>
<dd><p>logical; see <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></code>.</p></dd>

  <dt>conf.level</dt>
<dd><p>A numeric value between zero and one giving the
    family-wise confidence level to use.</p></dd>

  <dt>digits, neigen</dt>
<dd><p>numeric; for the <code>print</code> method, sets the
  number of digits to use (as per <code><a href="https://rdrr.io/r/base/print.default.html" class="external-link">print.default</a></code>) and the
  maximum number of axes to display eigenvalues for, repsectively.</p></dd>

  <dt>...</dt>
<dd><p>arguments, including graphical parameters (for
    <code>plot.betadisper</code> and <code>boxplot.betadisper</code>), passed to
    other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>One measure of multivariate dispersion (variance) for a group of
  samples is to calculate the average distance of group members to the
  group centroid or spatial median (both referred to as 'centroid' from
  now on unless stated otherwise) in multivariate space. To test if the
  dispersions (variances) of one or more groups are different, the
  distances of group members to the group centroid are subject to
  ANOVA. This is a multivariate analogue of Levene's test for
  homogeneity of variances if the distances between group members and
  group centroids is the Euclidean distance.</p>
<p>However, better measures of distance than the Euclidean distance are
  available for ecological data. These can be accommodated by reducing
  the distances produced using any dissimilarity coefficient to
  principal coordinates, which embeds them within a Euclidean space. The
  analysis then proceeds by calculating the Euclidean distances between
  group members and the group centroid on the basis of the principal
  coordinate axes rather than the original distances.</p>  
<p>Non-metric dissimilarity coefficients can produce principal coordinate
  axes that have negative Eigenvalues. These correspond to the
  imaginary, non-metric part of the distance between objects. If
  negative Eigenvalues are produced, we must correct for these imaginary
  distances.</p>
<p>The distance to its centroid of a point is $$z_{ij}^c =
  \sqrt{\Delta^2(u_{ij}^+, c_i^+) - \Delta^2(u_{ij}^-, c_i^-)},$$ where
  \(\Delta^2\) is the squared Euclidean distance between
  \(u_{ij}\), the principal coordinate for the \(j\)th
  point in the \(i\)th group, and \(c_i\), the
  coordinate of the centroid for the \(i\)th group. The
  super-scripted ‘\(+\)’ and ‘\(-\)’ indicate the
  real and imaginary parts respectively. This is equation (3) in
  Anderson (2006). If the imaginary part is greater in magnitude than
  the real part, then we would be taking the square root of a negative
  value, resulting in NaN, and these cases are changed to zero distances
  (with a warning). This is in line with the behaviour of Marti Anderson's
  PERMDISP2 programme.</p>  
<p>To test if one or more groups is more variable than the others, ANOVA
  of the distances to group centroids can be performed and parametric
  theory used to interpret the significance of \(F\). An alternative is to
  use a permutation test. <code><a href="permutest.betadisper.html">permutest.betadisper</a></code> permutes model
  residuals to generate a permutation distribution of \(F\) under the Null
  hypothesis of no difference in dispersion between groups.</p>
<p>Pairwise comparisons of group mean dispersions can also be performed
  using <code><a href="permutest.betadisper.html">permutest.betadisper</a></code>. An alternative to the classical
  comparison of group dispersions, is to calculate Tukey's Honest
  Significant Differences between groups, via
  <code>TukeyHSD.betadisper</code>. This is a simple wrapper to
  <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></code>. The user is directed to read the help file
  for <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></code> before using this function. In particular,
  note the statement about using the function with 
  unbalanced designs.</p>
<p>The results of the analysis can be visualised using the <code>plot</code>
  and <code>boxplot</code> methods.</p>
<p>One additional use of these functions is in assessing beta diversity
  (Anderson <em>et al</em> 2006). Function <code><a href="betadiver.html">betadiver</a></code>
  provides some popular dissimilarity measures for this purpose.</p>
<p>As noted in passing by Anderson (2006) and in a related
  context by O'Neill (2000), estimates of dispersion around a
  central location (median or centroid) that is calculated from the same data
  will be biased downward. This bias matters most when comparing diversity
  among treatments with small, unequal numbers of samples.  Setting
  <code>bias.adjust=TRUE</code> when using <code>betadisper</code> imposes a 
  \(\sqrt{n/(n-1)}\) correction (Stier et al. 2013).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The <code>anova</code> method returns an object of class <code>"anova"</code></p>


<p>inheriting from class <code>"data.frame"</code>.</p>


<p>The <code>scores</code> method returns a list with one or both of the
  components <code>"sites"</code> and <code>"centroids"</code>.</p>
  

<p>The <code>plot</code> function invisibly returns an object of class</p>
<p></p>
<p><code>"ordiplot"</code>, a plotting structure which can be used by</p>
<p></p>
<p><code><a href="ordiplot.html">identify.ordiplot</a></code> (to identify the points) or other
  functions in the <code><a href="ordiplot.html">ordiplot</a></code> family.</p>


<p>The <code>boxplot</code> function invisibly returns a list whose components
  are documented in <code><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></code>.</p>
<p></p>
<p><code>eigenvals.betadisper</code> returns a named vector of eigenvalues.</p>
<p></p>
<p><code>TukeyHSD.betadisper</code> returns a list. See <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></code></p>


<p>for further details.</p>
<p></p>
<p><code>betadisper</code> returns a list of class <code>"betadisper"</code> with the
  following components:</p>
<dl><dt>eig</dt>
<dd><p>numeric; the eigenvalues of the principal coordinates
    analysis.</p></dd>

  <dt>vectors</dt>
<dd><p>matrix; the eigenvectors of the principal coordinates
    analysis.</p></dd>

  <dt>distances</dt>
<dd><p>numeric; the Euclidean distances in principal
    coordinate space between the samples and their respective group
    centroid or median.</p></dd>

  <dt>group</dt>
<dd><p>factor; vector describing the group structure</p></dd>

  <dt>centroids</dt>
<dd><p>matrix; the locations of the group centroids or
    medians on the principal coordinates.</p></dd>

  <dt>group.distances</dt>
<dd><p>numeric; the mean distance to each group
    centroid or median.</p></dd>

  <dt>call</dt>
<dd><p>the matched function call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If <code>group</code> consists of a single level or group, then the
  <code>anova</code> and <code>permutest</code> methods are not appropriate and if
  used on such data will stop with an error.</p>
<p>Missing values in either <code>d</code> or <code>group</code> will be removed
  prior to performing the analysis.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>Stewart Schultz noticed that the permutation test for
  <code>type="centroid"</code> had the wrong type I error and was
  anti-conservative. As such, the default for <code>type</code> has been
  changed to <code>"median"</code>, which uses the spatial median as the group
  centroid. Tests suggests that the permutation test for this type of
  analysis gives the correct error rates.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anderson, M.J. (2006) Distance-based tests for homogeneity of
  multivariate dispersions. <em>Biometrics</em> <strong>62</strong>, 245--253.</p>
<p>Anderson, M.J., Ellingsen, K.E. &amp; McArdle, B.H. (2006) Multivariate
  dispersion as a measure of beta diversity. <em>Ecology Letters</em>
  <strong>9</strong>, 683--693.</p>
<p>O'Neill, M.E. (2000) A Weighted Least Squares Approach to Levene's 
  Test of Homogeneity of Variance. <em>Australian &amp; New Zealand Journal of 
  Statistics</em> <strong>42</strong>, 81-–100.</p>
<p>Stier, A.C., Geange, S.W., Hanson, K.M., &amp; Bolker, B.M. (2013) Predator 
  density and timing of arrival affect reef fish community
  assembly. <em>Ecology</em> <strong>94</strong>, 1057--1068.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gavin L. Simpson; bias correction by Adrian Stier and Ben Bolker.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="permutest.betadisper.html">permutest.betadisper</a></code>, <code><a href="https://rdrr.io/r/stats/anova.lm.html" class="external-link">anova.lm</a></code>,
  <code><a href="scores.html">scores</a></code>, <code><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></code>,
  <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></code>. Further measure of beta diversity
  can be found in <code><a href="betadiver.html">betadiver</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Bray-Curtis distances between samples</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## First 16 sites grazed, remaining 8 sites ungrazed</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grazed"</span>,<span class="st">"ungrazed"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate multivariate dispersions</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: betadisper(d = dis, group = groups)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Positive Eigenvalues: 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Negative Eigenvalues: 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average distance to median:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   grazed ungrazed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.3926   0.2706 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for PCoA axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 23 eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform test</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df  Sum Sq  Mean Sq F value  Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.07931 0.079306  4.6156 0.04295 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 22 0.37801 0.017182                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Permutation test for F</span></span></span>
<span class="r-in"><span><span class="fu"><a href="anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod</span>, pairwise <span class="op">=</span> <span class="cn">TRUE</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.07931 0.079306 4.6156     99   0.07 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 22 0.37801 0.017182                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pairwise comparisons:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Observed p-value below diagonal, permuted p-value above diagonal)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           grazed ungrazed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> grazed               0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ungrazed 0.04295         </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tukey's Honest Significant Differences</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mod.HSD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tukey multiple comparisons of means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% family-wise confidence level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit: aov(formula = distances ~ group, data = df)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       diff        lwr          upr     p adj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ungrazed-grazed -0.1219422 -0.2396552 -0.004229243 0.0429502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod.HSD</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the groups and distances to centroids on the</span></span></span>
<span class="r-in"><span><span class="co">## first two PCoA axes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with data ellipses instead of hulls</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span>, hull <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># 1 sd data ellipse</span></span></span>
<span class="r-plt img"><img src="betadisper-3.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, ellipse <span class="op">=</span> <span class="cn">TRUE</span>, hull <span class="op">=</span> <span class="cn">FALSE</span>, conf <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="co"># 90% data ellipse</span></span></span>
<span class="r-plt img"><img src="betadisper-4.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot with manual colour specification</span></span></span>
<span class="r-in"><span><span class="va">my_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1b9e77"</span>, <span class="st">"#7570b3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, col <span class="op">=</span> <span class="va">my_cols</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-5.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## can also specify which axes to plot, ordering respected</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, seg.col <span class="op">=</span> <span class="st">"forestgreen"</span>, seg.lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-6.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Draw a boxplot of the distances to centroid for each group</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-7.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## `scores` and `eigenvals` also work</span></span></span>
<span class="r-in"><span><span class="va">scrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">scrs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sites    : num [1:24, 1:2] 0.0946 -0.3125 -0.3511 -0.3291 -0.1926 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:24] "18" "15" "24" "27" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "PCoA1" "PCoA2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ centroids: num [1:2, 1:2] -0.1455 0.2786 0.0758 -0.2111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "grazed" "ungrazed"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "PCoA1" "PCoA2"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, display <span class="op">=</span> <span class="st">"sites"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          PCoA1       PCoA2        PCoA3        PCoA4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  0.09459373  0.15914576  0.074400844 -0.202466025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 -0.31248809  0.10032751 -0.062243360  0.110844864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 -0.35106507 -0.05954096 -0.038079447  0.095060928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 -0.32914546 -0.17019348  0.231623720  0.019110623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 -0.19259443 -0.01459250 -0.005679372 -0.209718312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 -0.06794575 -0.14501690 -0.085645653  0.002431355</span>
<span class="r-in"><span><span class="co"># group centroids/medians </span></span></span>
<span class="r-in"><span><span class="fu"><a href="scores.html">scores</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, display <span class="op">=</span> <span class="st">"centroids"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               PCoA1       PCoA2       PCoA3      PCoA4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> grazed   -0.1455200  0.07584572 -0.01366220 -0.0178990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ungrazed  0.2786095 -0.21114993 -0.03475586  0.0220129</span>
<span class="r-in"><span><span class="co"># eigenvalues from the underlying principal coordinates analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="eigenvals.html">eigenvals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PCoA1      PCoA2      PCoA3      PCoA4      PCoA5      PCoA6      PCoA7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.7552165  1.1334455  0.4429018  0.3698054  0.2453532  0.1960921  0.1751131 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PCoA8      PCoA9     PCoA10     PCoA11     PCoA12     PCoA13     PCoA14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.1284467  0.0971594  0.0759601  0.0637178  0.0583225  0.0394934  0.0172699 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCoA15     PCoA16     PCoA17     PCoA18     PCoA19     PCoA20     PCoA21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0051011 -0.0004131 -0.0064654 -0.0133147 -0.0253944 -0.0375105 -0.0480069 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PCoA22     PCoA23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0537146 -0.0741390 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## try out bias correction; compare with mod3</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mod3B</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span>, type <span class="op">=</span> <span class="st">"median"</span>, bias.adjust<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: betadisper(d = dis, group = groups, type = "median", bias.adjust</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Positive Eigenvalues: 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Negative Eigenvalues: 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average distance to median:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   grazed ungrazed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.4055   0.2893 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for PCoA axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 23 eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod3B</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df  Sum Sq  Mean Sq F value  Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.07193 0.071927  3.7826 0.06468 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 22 0.41834 0.019015                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="fu"><a href="anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod3B</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.07193 0.071927 3.7826     99   0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 22 0.41834 0.019015                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## should always work for a single group</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"grazed"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">dis</span>, <span class="va">group</span>, type <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: betadisper(d = dis, group = group, type = "median")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Positive Eigenvalues: 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Negative Eigenvalues: 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average distance to median:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> grazed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4255 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for PCoA axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 23 eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">dis</span>, <span class="va">group</span>, type <span class="op">=</span> <span class="st">"centroid"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: betadisper(d = dis, group = group, type = "centroid")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Positive Eigenvalues: 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Negative Eigenvalues: 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average distance to centroid:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> grazed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4261 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for PCoA axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 23 eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.7552 1.1334 0.4429 0.3698 0.2454 0.1961 0.1751 0.1284 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## simulate missing values in 'd' and 'group'</span></span></span>
<span class="r-in"><span><span class="co">## using spatial medians</span></span></span>
<span class="r-in"><span><span class="va">groups</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">20</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">dis</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span><span class="op">)</span> <span class="co">## messages</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> missing observations due to 'group' removed</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> missing observations due to 'd' removed</span>
<span class="r-in"><span><span class="va">mod2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: betadisper(d = dis, group = groups)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Positive Eigenvalues: 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Negative Eigenvalues: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average distance to median:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   grazed ungrazed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.3984   0.3008 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for PCoA axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.4755 0.8245 0.4218 0.3456 0.2159 0.1688 0.1150 0.1060 </span>
<span class="r-in"><span><span class="fu"><a href="anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod2</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df   Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.039979 0.039979 2.4237     99   0.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 18 0.296910 0.016495                     </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df   Sum Sq  Mean Sq F value Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.039979 0.039979  2.4237 0.1369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 18 0.296910 0.016495               </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-8.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-9.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-10.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using group centroids</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">dis</span>, <span class="va">groups</span>, type <span class="op">=</span> <span class="st">"centroid"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> missing observations due to 'group' removed</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> missing observations due to 'd' removed</span>
<span class="r-in"><span><span class="va">mod3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: betadisper(d = dis, group = groups, type = "centroid")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Positive Eigenvalues: 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. of Negative Eigenvalues: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average distance to centroid:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   grazed ungrazed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.4001   0.3108 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for PCoA axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.4755 0.8245 0.4218 0.3456 0.2159 0.1688 0.1150 0.1060 </span>
<span class="r-in"><span><span class="fu"><a href="anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">mod3</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for homogeneity of multivariate dispersions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df   Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.033468 0.033468 3.1749     99   0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 18 0.189749 0.010542                     </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Df   Sum Sq  Mean Sq F value  Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Groups     1 0.033468 0.033468  3.1749 0.09166 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals 18 0.189749 0.010542                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-11.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-12.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="betadisper-13.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

