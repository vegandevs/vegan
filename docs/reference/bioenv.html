<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function finds the best subset of environmental variables, so that
  the Euclidean distances of scaled environmental variables have the
  maximum (rank) correlation with community dissimilarities."><title>Best Subset of Environmental Variables with
  Maximum (Rank) Correlation with Community Dissimilarities — bioenv • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Best Subset of Environmental Variables with
  Maximum (Rank) Correlation with Community Dissimilarities — bioenv"><meta property="og:description" content="Function finds the best subset of environmental variables, so that
  the Euclidean distances of scaled environmental variables have the
  maximum (rank) correlation with community dissimilarities."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Best Subset of Environmental Variables with
  Maximum (Rank) Correlation with Community Dissimilarities</h1>
      
      <div class="d-none name"><code>bioenv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function finds the best subset of environmental variables, so that
  the Euclidean distances of scaled environmental variables have the
  maximum (rank) correlation with community dissimilarities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu">bioenv</span><span class="op">(</span><span class="va">comm</span>, <span class="va">env</span>, method <span class="op">=</span> <span class="st">"spearman"</span>, index <span class="op">=</span> <span class="st">"bray"</span>,</span>
<span>       upto <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, partial <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>       metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>, <span class="st">"mahalanobis"</span>, <span class="st">"manhattan"</span>, <span class="st">"gower"</span><span class="op">)</span>,</span>
<span>       parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">bioenv</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">bioenvdist</span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>comm</dt>
<dd><p>Community data frame or a dissimilarity object or a square
    matrix that can be interpreted as dissimilarities.</p></dd>

  <dt>env</dt>
<dd><p>Data frame of continuous environmental variables.</p></dd>

  <dt>method</dt>
<dd><p>The correlation method used in <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>.</p></dd>

  <dt>index</dt>
<dd><p>The dissimilarity index used for community data (<code>comm</code>) 
    in <code><a href="vegdist.html">vegdist</a></code>. This is ignored if <code>comm</code> are dissimilarities.</p></dd>

  <dt>upto</dt>
<dd><p>Maximum number of parameters in studied subsets.</p></dd>

  <dt>formula, data</dt>
<dd><p>Model <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> and data.</p></dd>

  <dt>trace</dt>
<dd><p>Trace the calculations</p></dd>

  <dt>partial</dt>
<dd><p>Dissimilarities partialled out when inspecting
    variables in <code>env</code>.</p></dd>

  <dt>metric</dt>
<dd><p>Metric used for distances of environmental distances. See 
    Details.</p></dd>

  <dt>parallel</dt>
<dd><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.</p></dd>

  <dt>x</dt>
<dd><p><code>bioenv</code> result object.</p></dd>

  <dt>which</dt>
<dd><p>The number of the model for which the environmental
    distances are evaluated, or the <code>"best"</code> model.</p></dd>

  <dt>...</dt>
<dd><p>Other arguments passed to <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
  
<p>The function calculates a community dissimilarity matrix using
  <code><a href="vegdist.html">vegdist</a></code>.  Then it selects all possible subsets of
  environmental variables, <code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></code>s the variables, and
  calculates Euclidean distances for this subset using
  <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>.  The function finds the correlation between
  community dissimilarities and environmental distances, and for each
  size of subsets, saves the best result.  There are \(2^p-1\)
  subsets of \(p\) variables, and an exhaustive search may take a
  very, very, very long time (parameter <code>upto</code> offers a partial
  relief).</p>
<p>The argument <code>metric</code> defines distances in the given set of
  environmental variables.  With <code>metric = "euclidean"</code>, the
  variables are scaled to unit variance and Euclidean distances are
  calculated. With <code>metric = "mahalanobis"</code>, the Mahalanobis
  distances are calculated: in addition to scaling to unit variance,
  the matrix of the current set of environmental variables is also
  made orthogonal (uncorrelated). With <code>metric = "manhattan"</code>,
  the variables are scaled to unit range and Manhattan distances are
  calculated, so that the distances are sums of differences of
  environmental variables.  With <code>metric = "gower"</code>, the Gower
  distances are calculated using function
  <code><a href="https://rdrr.io/pkg/cluster/man/daisy.html" class="external-link">daisy</a></code>. This allows also using factor
  variables, but with continuous variables the results are equal to
  <code>metric = "manhattan"</code>.</p>
<p>The function can be called with a model <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> where
  the LHS is the data matrix and RHS lists the environmental variables.
  The formula interface is practical in selecting or transforming
  environmental variables.</p>
<p>With argument <code>partial</code> you can perform “partial”
  analysis. The partializing item must be a dissimilarity object of
  class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>. The
  <code>partial</code> item can be used with any correlation <code>method</code>,
  but it is strictly correct only for Pearson.</p>
<p>Function <code>bioenvdist</code> recalculates the environmental distances
  used within the function. The default is to calculate distances for
  the best model, but the number of any model can be given.</p>  
<p>Clarke &amp; Ainsworth (1993) suggested this method to be used for
  selecting the best subset of environmental variables in interpreting
  results of nonmetric multidimensional scaling (NMDS). They recommended a
  parallel display of NMDS of community dissimilarities and NMDS of
  Euclidean distances from the best subset of scaled environmental
  variables.  They warned against the use of Procrustes analysis, but
  to me this looks like a good way of comparing these two ordinations.</p>
<p>Clarke &amp; Ainsworth wrote a computer program BIO-ENV giving the name to
  the current function. Presumably BIO-ENV
  was later incorporated in Clarke's PRIMER software (available for
  Windows).  In addition, Clarke &amp; Ainsworth suggested a novel method of
  rank correlation which is not available in the current function.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The function returns an object of class <code>bioenv</code> with a</p>
<p></p>
<p><code>summary</code> method.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Clarke, K. R &amp; Ainsworth, M. 1993. A method of linking multivariate
  community structure to environmental variables. <em>Marine Ecology
    Progress Series</em>, 92, 205--219.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If you want to study the ‘significance’ of <code>bioenv</code>
  results, you can use function <code><a href="mantel.html">mantel</a></code> or
  <code><a href="mantel.html">mantel.partial</a></code> which use the same definition of
  correlation.  However, <code>bioenv</code> standardizes environmental
  variables depending on the used metric, and you must do the same in
  <code><a href="mantel.html">mantel</a></code> for comparable results (the standardized data are
  returned as item <code>x</code> in the result object). It is safest to use
  <code>bioenvdist</code> to extract the environmental distances that really
  were used within <code>bioenv</code>. NB., <code>bioenv</code> selects variables
  to maximize the Mantel correlation, and significance tests based on
  <em>a priori</em> selection of variables are biased.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="vegdist.html">vegdist</a></code>, <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>
  for underlying routines, <code><a href="monoMDS.html">monoMDS</a></code> and
  <code><a href="metaMDS.html">metaMDS</a></code> for ordination, <code><a href="procrustes.html">procrustes</a></code> for
  Procrustes analysis, <code><a href="procrustes.html">protest</a></code> for an alternative, and
  <code><a href="rankindex.html">rankindex</a></code> for studying alternatives to the default
  Bray-Curtis index.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The method is very slow for large number of possible subsets.</span></span></span>
<span class="r-in"><span><span class="co"># Therefore only 6 variables in this example.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu">bioenv</span><span class="op">(</span><span class="fu"><a href="decostand.html">wisconsin</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="va">Ca</span> <span class="op">+</span> <span class="va">pH</span> <span class="op">+</span> <span class="va">Al</span>, <span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sol</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bioenv(formula = wisconsin(varespec) ~ log(N) + P + K + Ca +      pH + Al, data = varechem) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subset of environmental variables with best correlation to community data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlations:    spearman </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dissimilarities: bray </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Metric:          euclidean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best model has 3 parameters (max. 6 allowed):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P Ca Al</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> with correlation  0.4004806 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_BEGIN</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     size correlation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P                      1      0.2513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P Al                   2      0.4004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P Ca Al                3      0.4005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P Ca pH Al             4      0.3619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(N) P Ca pH Al      5      0.3216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(N) P K Ca pH Al    6      0.2822</span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_END</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

