<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Result Object from Constrained Ordination — cca.object • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Result Object from Constrained Ordination — cca.object"><meta name="description" content="

Ordination methods cca, rda,
  dbrda and capscale return similar result
  objects. All these methods use the same internal function
  ordConstrained. They differ only in (1) initial
  transformation of the data and in defining inertia, (2) weighting,
  and (3) the use of rectangular rows \(\times\) columns data or
  symmetric rows \(\times\) rows dissimilarities:
  rda initializes data to give variance or correlations
  as inertia, cca is based on double-standardized data
  to give Chi-square inertia and uses row and column weights,
  capscale maps the real part of dissimilarities to
  rectangular data and performs RDA, and dbrda performs
  an RDA-like analysis directly on symmetric dissimilarities.
Function ordConstrained returns the same result components
  for all these methods, and the calling function may add some more
  components to the final result. However, you should not access these
  result components directly (using $): the internal structure
  is not regarded as stable application interface (API), but it can
  change at any release. If you access the results components
  directly, you take a risk of breakage at any vegan release.
  The vegan provides a wide set of accessor functions to those
  components, and these functions are updated when the result object
  changes. This documentation gives an overview of accessor functions
  to the cca result object."><meta property="og:description" content="

Ordination methods cca, rda,
  dbrda and capscale return similar result
  objects. All these methods use the same internal function
  ordConstrained. They differ only in (1) initial
  transformation of the data and in defining inertia, (2) weighting,
  and (3) the use of rectangular rows \(\times\) columns data or
  symmetric rows \(\times\) rows dissimilarities:
  rda initializes data to give variance or correlations
  as inertia, cca is based on double-standardized data
  to give Chi-square inertia and uses row and column weights,
  capscale maps the real part of dissimilarities to
  rectangular data and performs RDA, and dbrda performs
  an RDA-like analysis directly on symmetric dissimilarities.
Function ordConstrained returns the same result components
  for all these methods, and the calling function may add some more
  components to the final result. However, you should not access these
  result components directly (using $): the internal structure
  is not regarded as stable application interface (API), but it can
  change at any release. If you access the results components
  directly, you take a risk of breakage at any vegan release.
  The vegan provides a wide set of accessor functions to those
  components, and these functions are updated when the result object
  changes. This documentation gives an overview of accessor functions
  to the cca result object."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.8-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Result Object from Constrained Ordination</h1>

      <div class="d-none name"><code>cca.object.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Ordination methods <code><a href="cca.html">cca</a></code>, <code><a href="cca.html">rda</a></code>,
  <code><a href="dbrda.html">dbrda</a></code> and <code><a href="dbrda.html">capscale</a></code> return similar result
  objects. All these methods use the same internal function
  <code>ordConstrained</code>. They differ only in (1) initial
  transformation of the data and in defining inertia, (2) weighting,
  and (3) the use of rectangular rows \(\times\) columns data or
  symmetric rows \(\times\) rows dissimilarities:
  <code><a href="cca.html">rda</a></code> initializes data to give variance or correlations
  as inertia, <code><a href="cca.html">cca</a></code> is based on double-standardized data
  to give Chi-square inertia and uses row and column weights,
  <code><a href="dbrda.html">capscale</a></code> maps the real part of dissimilarities to
  rectangular data and performs RDA, and <code><a href="dbrda.html">dbrda</a></code> performs
  an RDA-like analysis directly on symmetric dissimilarities.</p>
<p>Function <code>ordConstrained</code> returns the same result components
  for all these methods, and the calling function may add some more
  components to the final result. However, you should not access these
  result components directly (using <code>$</code>): the internal structure
  is not regarded as stable application interface (API), but it can
  change at any release. If you access the results components
  directly, you take a risk of breakage at any <span class="pkg">vegan</span> release.
  The <span class="pkg">vegan</span> provides a wide set of accessor functions to those
  components, and these functions are updated when the result object
  changes. This documentation gives an overview of accessor functions
  to the <code>cca</code> result object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ordConstrained</span><span class="op">(</span><span class="va">Y</span>, X <span class="op">=</span> <span class="cn">NULL</span>, Z <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cca"</span>, <span class="st">"rda"</span>,</span>
<span>    <span class="st">"capscale"</span>, <span class="st">"dbrda"</span>, <span class="st">"pass"</span><span class="op">)</span>, arg <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">ordiYbar</span><span class="op">(</span><span class="va">x</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCA"</span>, <span class="st">"CA"</span>, <span class="st">"pCCA"</span>, <span class="st">"partial"</span>, <span class="st">"initial"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'cca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights</a></span><span class="op">(</span><span class="va">object</span>, display <span class="op">=</span> <span class="st">"sites"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-y-x-z">Y, X, Z<a class="anchor" aria-label="anchor" href="#arg-y-x-z"></a></dt>
<dd><p>Input matrix of responses (<code>Y</code>) and model matrices
    of constraints (<code>X</code>) and conditions (<code>Z</code>). <code>NULL</code>
    matrices are ignored.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Ordination method. If <code>"pass"</code>, method is defined
    by <code>Y</code> of fitted ordination model.</p></dd>

  <dt id="arg-arg">arg<a class="anchor" aria-label="anchor" href="#arg-arg"></a></dt>
<dd><p>Possible extra argument passed to <code>method</code>; in
    <code><a href="cca.html">rda</a></code> this is <code>scale</code>.</p></dd>

  <dt id="arg-object-x-formula">object, x, formula<a class="anchor" aria-label="anchor" href="#arg-object-x-formula"></a></dt>
<dd><p>A result object from <code><a href="cca.html">cca</a></code>,
    <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code>, or
    <code><a href="dbrda.html">capscale</a></code>.</p></dd>


  <dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Show constrained (<code>"CCA"</code>), unconstrained
    (<code>"CA"</code>) or conditioned “partial” (<code>"pCCA"</code>)
    results. In <code>ordiYbar</code> the value can also be <code>"initial"</code>
    for the internal working input data, and <code>"partial"</code> for the
    internal working input data after removing the partial effects.</p></dd>


  <dt id="arg-display">display<a class="anchor" aria-label="anchor" href="#arg-display"></a></dt>
<dd><p>Display either <code>"sites"</code> or <code>"species"</code>.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to the the function.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Function <code>ordConstrained</code> is used as the basic analysis engine
  in all [partial] constrained ordination methods (<code><a href="cca.html">cca</a></code>,
  <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code> _etc_). Those higher-level
  functions set up the data for <code>ordConstrained</code> and add items
  used in printing or further analysis of the results. Function
  <code>ordConstrained</code> can also be called directly, but the user
  should be very careful in setting up the input arguments and in
  processing the result. All supported ordination methods have an
  <code>initXXX</code> function that transforms the data for analysis and
  sets data attributes for analytic steps. These arguments include
  attribute <code>METHOD</code> and for <code><a href="cca.html">cca</a></code> row and column
  weights (attributes <code>RW</code> and <code>CW</code>). These are used to
  select the branch of analysis in further steps. Argument
  <code>method</code> selects the ordination type. <code>method = "pass"</code> is
  used when the dependent matrix <code>Y</code> already was processed with
  an <code>initXXX</code> method. This allows embedding
  <code>ordConstrained</code> in other functions with any constrained
  ordination method or using your own <code>initXXX</code> method (see
  Examples). Dependent matrix <code>Y</code> must be supplied but conditions
  <code>Z</code> and constraints <code>X</code> can be <code>NULL</code> and then this
  analysis step is skipped (if both are <code>NULL</code>, unconstrained
  ordination is performed). Steps for conditions (partialling) and
  constraints return residuals of input <code>Y</code> for the next step,
  and all methods return their analysis results.</p>
<p>The internal (“working”) form of the dependent (community)
  data can be accessed with function <code>ordiYbar</code>. The form depends
  on the ordination method: for instance, in <code><a href="cca.html">cca</a></code> the
  data are weighted and Chi-square transformed, and in
  <code><a href="dbrda.html">dbrda</a></code> they are Gower-centred dissimilarities. The
  input data in the original (“response”) form can be accessed
  with <code><a href="predict.cca.html">fitted.cca</a></code> and <code><a href="predict.cca.html">residuals.cca</a></code>.
  Function <code><a href="predict.cca.html">predict.cca</a></code> can return either working or
  response data, and also their lower-rank approximations.</p>
<p>The model matrix of independent data (“Constraints” and
  “Conditions”) can be extracted with <code>model.matrix</code>. In
  partial analysis, the function returns a list of design matrices
  called <code>Conditions</code> and <code>Constraints</code>. If either component
  was missing, a single matrix is returned. The redundant (aliased)
  terms do not appear in the model matrix. These terms can be found
  with <code><a href="goodness.cca.html">alias.cca</a></code>. Function <code>model.frame</code> tries to
  reconstruct the data frame from which the model matrices were
  derived. This is only possible if the original model was fitted with
  <code>formula</code> and <code>data</code> arguments, and still fails if the
  <code>data</code> are unavailable.</p>
<p>The number of observations can be accessed with
  <code><a href="nobs.cca.html">nobs.cca</a></code>, and the residual degrees of freedom with
  <code><a href="influence.cca.html">df.residual.cca</a></code>. The information on observations with
  missing values can be accessed with <code><a href="https://rdrr.io/r/stats/na.action.html" class="external-link">na.action</a></code>.  The
  terms and formula of the fitted model can be accessed with
  <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> and <code><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></code>.</p>
<p>The weights used in <code><a href="cca.html">cca</a></code> can be accessed with
  <code>weights</code>. In unweighted methods (<code><a href="cca.html">rda</a></code>) all
  weights are equal.</p>
<p>The ordination results are saved in separate components for partial
  terms, constraints and residual unconstrained ordination. There is
  no guarantee that these components will have the same internal names
  as currently, and you should be cautious when developing scripts and
  functions that directly access these components.</p>
<p>The constrained ordination algorithm is based on QR decomposition of
  constraints and conditions (environmental data), and the QR
  component is saved separately for partial and constrained
  components.  The QR decomposition of constraints can be accessed
  with <code><a href="influence.cca.html">qr.cca</a></code>. This will also include the residual
  effects of partial terms (Conditions), and it should be used
  together with <code>ordiYbar(x, "partial")</code>. The environmental data
  are first centred in <code>rda</code> or weighted and centred in
  <code>cca</code>.  The QR decomposition is used in many functions that
  access <code>cca</code> results, and it can be used to find many items
  that are not directly stored in the object.  For examples, see
  <code><a href="predict.cca.html">coef.cca</a></code>, <code><a href="predict.cca.html">coef.rda</a></code>,
  <code><a href="goodness.cca.html">vif.cca</a></code>, <code><a href="anova.cca.html">permutest.cca</a></code>,
  <code><a href="predict.cca.html">predict.cca</a></code>, <code><a href="predict.cca.html">predict.rda</a></code>,
  <code><a href="predict.cca.html">calibrate.cca</a></code>. See <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></code> for other possible
  uses of this component. For instance, the rank of the constraints
  can be found from the QR decomposition.</p>
<p>The eigenvalues of the solution can be accessed with
  <code><a href="eigenvals.html">eigenvals.cca</a></code>. Eigenvalues are not evaluated for
  partial component, and they will only be available for constrained
  and residual components.</p>
<p>The ordination scores are internally stored as (weighted)
  orthonormal scores matrices. These results can be accessed with
  <code><a href="plot.cca.html">scores.cca</a></code> and <code><a href="plot.cca.html">scores.rda</a></code> functions. The
  ordination scores are scaled when accessed with <code><a href="scores.html">scores</a></code>
  functions, but internal (weighted) orthonormal scores can be
  accessed by setting <code>scaling = FALSE</code>. Unconstrained residual
  component has species and site scores, and constrained component has
  also fitted site scores or linear combination scores for sites and
  biplot scores and centroids for constraint variables. The biplot
  scores correspond to the <code>model.matrix</code>, and centroids
  are calculated for factor variables when they were used. The scores
  can be selected by defining the axes, and there is no direct way of
  accessing all scores of a certain component. The number of dimensions
  can be assessed from <code><a href="eigenvals.html">eigenvals</a></code>. In addition, some
  other types can be derived from the results although not saved in
  the results. For instance, regression scores and model coefficients
  can be accessed with <code><a href="scores.html">scores</a></code> and <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>
  functions. Partial component will have no scores.</p>
<p>Distance-based methods (<code><a href="dbrda.html">dbrda</a></code>, <code><a href="dbrda.html">capscale</a></code>)
  can have negative eigenvalues and associated imaginary axis scores. In
  addition, species scores are initially missing in <code><a href="dbrda.html">dbrda</a></code>
  and they are accessory and found after analysis in
  <code><a href="dbrda.html">capscale</a></code> (and may be misleading). Function
  <code><a href="sppscores.html">sppscores</a></code> can be used to add species scores or replace
  them with more meaningful ones.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">

<p>The core function is <code>ordConstrained</code> which is called by
  <code><a href="cca.html">cca</a></code>, <code><a href="cca.html">rda</a></code>, <code><a href="dbrda.html">dbrda</a></code>,
  <code><a href="dbrda.html">capscale</a></code> as well as by unconstrained methods
  <code><a href="cca.html">pca</a></code>, <code><a href="cca.html">ca</a></code> and <code><a href="dbrda.html">pco</a></code>. The basic
  class is <code>"cca"</code> for all methods, and the following functions are
  defined for this class: <code><a href="add1.cca.html">add1.cca</a></code>, <code><a href="goodness.cca.html">alias.cca</a></code>, <code><a href="anova.cca.html">anova.cca</a></code>, <code><a href="vegan-defunct.html">as.mlm.cca</a></code>, <code><a href="biplot.rda.html">biplot.cca</a></code>, <code><a href="screeplot.cca.html">bstick.cca</a></code>, <code><a href="predict.cca.html">calibrate.cca</a></code>, <code><a href="predict.cca.html">coef.cca</a></code>, <code><a href="influence.cca.html">cooks.distance.cca</a></code>, <code><a href="deviance.cca.html">deviance.cca</a></code>, <code><a href="influence.cca.html">df.residual.cca</a></code>, <code><a href="add1.cca.html">drop1.cca</a></code>, <code><a href="eigenvals.html">eigenvals.cca</a></code>, <code><a href="deviance.cca.html">extractAIC.cca</a></code>, <code><a href="predict.cca.html">fitted.cca</a></code>, <code><a href="goodness.cca.html">goodness.cca</a></code>, <code><a href="influence.cca.html">hatvalues.cca</a></code>, <code><a href="influence.cca.html">influence.cca</a></code>, <code><a href="plot.cca.html">labels.cca</a></code>, <code>model.frame.cca</code>, <code>model.matrix.cca</code>, <code><a href="nobs.cca.html">nobs.cca</a></code>, <code><a href="anova.cca.html">permutest.cca</a></code>, <code><a href="plot.cca.html">plot.cca</a></code>, <code><a href="plot.cca.html">points.cca</a></code>, <code><a href="predict.cca.html">predict.cca</a></code>, <code>print.cca</code>, <code><a href="influence.cca.html">qr.cca</a></code>, <code><a href="predict.cca.html">residuals.cca</a></code>, <code><a href="RsquareAdj.html">RsquareAdj.cca</a></code>, <code><a href="influence.cca.html">rstandard.cca</a></code>, <code><a href="influence.cca.html">rstudent.cca</a></code>, <code><a href="plot.cca.html">scores.cca</a></code>, <code><a href="screeplot.cca.html">screeplot.cca</a></code>, <code><a href="influence.cca.html">sigma.cca</a></code>, <code><a href="simulate.rda.html">simulate.cca</a></code>, <code><a href="influence.cca.html">SSD.cca</a></code>, <code><a href="stressplot.wcmdscale.html">stressplot.cca</a></code>, <code><a href="plot.cca.html">summary.cca</a></code>, <code><a href="plot.cca.html">text.cca</a></code>, <code><a href="tolerance.html">tolerance.cca</a></code>, <code><a href="influence.cca.html">vcov.cca</a></code>, <code>weights.cca</code>
.  Other functions handling <code>"cca"</code> objects
  include <code><a href="goodness.cca.html">inertcomp</a></code>, <code><a href="goodness.cca.html">intersetcor</a></code>,
  <code><a href="mso.html">mso</a></code>, <code><a href="ordistep.html">ordistep</a></code>, <code><a href="ordistep.html">ordiR2step</a></code>
  and <code><a href="goodness.cca.html">vif.cca</a></code>. Functions that can be regarded as special
  cases of <code>"cca"</code> methods include <code><a href="adonis.html">adonis2</a></code> and
  <code><a href="varpart.html">varpart</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The latest large change of result object was made in release 2.5-1 in
  2016. You can modernize ancient stray results with
  <code>modernobject &lt;- update(ancientobject)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd English
  ed. Elsevier.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mod0</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">cca</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">Management</span> <span class="op">+</span> <span class="va">Moisture</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">## refit the model in ordConstrained</span></span></span>
<span class="r-in"><span>  <span class="va">mrefit</span> <span class="op">&lt;-</span> <span class="fu">ordConstrained</span><span class="op">(</span><span class="fu">ordiYbar</span><span class="op">(</span><span class="va">mod0</span>, <span class="st">"initial"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">mod0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                         <span class="st">"pass"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## implement weighted RDA (weights w)</span></span></span>
<span class="r-in"><span>  <span class="va">initWPCA</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">w</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/CallExternal.html" class="external-link">.Call</a></span><span class="op">(</span><span class="st">"do_wcentre"</span>, <span class="va">Y</span>, <span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">Y</span>, <span class="st">"RW"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">w</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">Y</span>, <span class="st">"METHOD"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"WPCA"</span></span></span>
<span class="r-in"><span>    <span class="va">Y</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="va">dune</span> <span class="op">~</span> <span class="va">Management</span> <span class="op">+</span> <span class="va">Moisture</span>, <span class="va">dune.env</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = dune ~ Management + Moisture, data = dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         84.1237     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   46.4249     0.5519    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 37.6988     0.4481   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RDA1   RDA2   RDA3   RDA4   RDA5   RDA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21.588 14.075  4.123  3.163  2.369  1.107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10  PC11  PC12  PC13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.241 7.138 5.355 4.409 3.143 2.770 1.878 1.741 0.952 0.909 0.627 0.311 0.227 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">adjust</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">wmod</span> <span class="op">&lt;-</span> <span class="fu">ordConstrained</span><span class="op">(</span><span class="fu">initWPCA</span><span class="op">(</span><span class="va">dune</span>, <span class="va">w</span> <span class="op">*</span> <span class="va">adjust</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Management</span> <span class="op">+</span> <span class="va">Moisture</span>,<span class="va">dune.env</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                         <span class="cn">NULL</span>, <span class="st">"pass"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">wmod</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wrda"</span>, <span class="st">"cca"</span><span class="op">)</span> <span class="co"># for clean print.cca</span></span></span>
<span class="r-in"><span>  <span class="va">wmod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: ordConstrained(Y = initWPCA(dune, w * adjust), X =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model.matrix(~Management + Moisture, dune.env)[, -1], Z = NULL, method =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "pass")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         84.2528     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   47.8693     0.5682    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 36.3836     0.4318   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1      2      3      4      5      6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22.766 13.150  5.332  3.279  2.400  0.941 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1     2     3     4     5     6     7     8     9    10    11    12    13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8.208 7.795 5.218 3.585 2.950 2.417 1.911 1.560 0.920 0.703 0.577 0.326 0.214 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## CCA as weighted RDA (species scores differ, though).</span></span></span>
<span class="r-in"><span>  <span class="va">dchi</span> <span class="op">&lt;-</span> <span class="fu"><a href="decostand.html">decostand</a></span><span class="op">(</span><span class="va">dune</span>, <span class="st">"chi.sq"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ccmod</span> <span class="op">&lt;-</span> <span class="fu">ordConstrained</span><span class="op">(</span><span class="fu">initWPCA</span><span class="op">(</span><span class="va">dchi</span>, <span class="va">w</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          <span class="cn">NULL</span>, <span class="st">"pass"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ccmod</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wrda"</span>, <span class="st">"cca"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ccmod</span> <span class="co"># wrda</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: ordConstrained(Y = initWPCA(dchi, w), X = model.matrix(mod), Z =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL, method = "pass")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.1153     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    1.0024     0.4739    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  1.1129     0.5261   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1      2      3      4      5      6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4458 0.2887 0.1124 0.0717 0.0494 0.0344 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1      2      3      4      5      6      7      8      9     10     11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3504 0.1521 0.1251 0.1098 0.0922 0.0771 0.0594 0.0478 0.0370 0.0223 0.0207 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     12     13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0108 0.0083 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="va">mod0</span>  <span class="co"># cca</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = dune ~ Management + Moisture, data = dune.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.1153     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    1.0024     0.4739    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  1.1129     0.5261   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4458 0.2887 0.1124 0.0717 0.0494 0.0344 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8    CA9   CA10   CA11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3504 0.1521 0.1251 0.1098 0.0922 0.0771 0.0594 0.0478 0.0370 0.0223 0.0207 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CA12   CA13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0108 0.0083 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Cameron Martino, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

