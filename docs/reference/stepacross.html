<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stepacross as Flexible Shortest Paths or Extended Dissimilarities — stepacross • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stepacross as Flexible Shortest Paths or Extended Dissimilarities — stepacross"><meta name="description" content="Function stepacross tries to replace dissimilarities with
  shortest paths stepping across intermediate
  sites while regarding dissimilarities above a threshold as missing
  data (NA). With path = &quot;shortest&quot; this is the flexible shortest
  path (Williamson 1978, Bradfield &amp;amp; Kenkel 1987),
  and with path = &quot;extended&quot; an
  approximation known as extended dissimilarities (De'ath 1999).
  The use of stepacross should improve the ordination with high
  beta diversity, when there are many sites with no species in common."><meta property="og:description" content="Function stepacross tries to replace dissimilarities with
  shortest paths stepping across intermediate
  sites while regarding dissimilarities above a threshold as missing
  data (NA). With path = &quot;shortest&quot; this is the flexible shortest
  path (Williamson 1978, Bradfield &amp;amp; Kenkel 1987),
  and with path = &quot;extended&quot; an
  approximation known as extended dissimilarities (De'ath 1999).
  The use of stepacross should improve the ordination with high
  beta diversity, when there are many sites with no species in common."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.7-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stepacross as Flexible Shortest Paths or Extended Dissimilarities</h1>

      <div class="d-none name"><code>stepacross.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function <code>stepacross</code> tries to replace dissimilarities with
  shortest paths stepping across intermediate
  sites while regarding dissimilarities above a threshold as missing
  data (<code>NA</code>). With <code>path = "shortest"</code> this is the flexible shortest
  path (Williamson 1978, Bradfield &amp; Kenkel 1987),
  and with <code>path = "extended"</code> an
  approximation known as extended dissimilarities (De'ath 1999).
  The use of <code>stepacross</code> should improve the ordination with high
  beta diversity, when there are many sites with no species in common.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stepacross</span><span class="op">(</span><span class="va">dis</span>, path <span class="op">=</span> <span class="st">"shortest"</span>, toolong <span class="op">=</span> <span class="fl">1</span>, trace <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-dis">dis<a class="anchor" aria-label="anchor" href="#arg-dis"></a></dt>
<dd><p>Dissimilarity data inheriting from class <code>dist</code> or
    a an object, such as a matrix, that can be converted to a
    dissimilarity matrix. Functions <code><a href="vegdist.html">vegdist</a></code> and
    <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> are some functions producing suitable
    dissimilarity data.</p></dd>

  <dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>The method of stepping across (partial match)
    Alternative <code>"shortest"</code> finds the shortest paths, and
    <code>"extended"</code>  their approximation known as extended
    dissimilarities.</p></dd>

  <dt id="arg-toolong">toolong<a class="anchor" aria-label="anchor" href="#arg-toolong"></a></dt>
<dd><p>Shortest dissimilarity regarded as <code>NA</code>.
    The function uses a fuzz factor, so
    that dissimilarities close to the limit will be made <code>NA</code>, too.</p></dd>

  <dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>Trace the calculations.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters (ignored).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Williamson (1978) suggested using flexible shortest paths to estimate
  dissimilarities between sites which have nothing in common, or no shared
  species. With <code>path = "shortest"</code> function <code>stepacross</code>
  replaces dissimilarities that are
  <code>toolong</code> or longer with <code>NA</code>, and tries to find shortest
  paths between all sites using remaining dissimilarities. Several
  dissimilarity indices are semi-metric which means that they do not
  obey the triangle inequality \(d_{ij} \leq d_{ik} + d_{kj}\), and shortest path algorithm can replace these
  dissimilarities as well, even when they are shorter than
  <code>toolong</code>.</p>
<p>De'ath (1999) suggested a simplified method known as extended
  dissimilarities, which are calculated with <code>path = "extended"</code>.
  In this method, dissimilarities that are
  <code>toolong</code> or longer are first made <code>NA</code>, and then the function
  tries to replace these <code>NA</code> dissimilarities with a path through
  single stepping stone points. If not all <code>NA</code> could be
  replaced with one pass, the function will make new passes with updated
  dissimilarities as long as
  all <code>NA</code> are replaced with extended dissimilarities. This mean
  that in the second and further passes, the remaining <code>NA</code>
  dissimilarities are allowed to have more than one stepping stone site,
  but previously replaced dissimilarities are not updated. Further, the
  function does not consider dissimilarities shorter than <code>toolong</code>,
  although some of these could be replaced with a shorter path in
  semi-metric indices, and used as a part of other paths. In optimal
  cases, the extended dissimilarities are equal to shortest paths, but
  they may be longer.</p>
<p>As an alternative to defining too long dissimilarities with parameter
  <code>toolong</code>, the input dissimilarities can contain <code>NA</code>s. If
  <code>toolong</code> is zero or negative, the function does not make any
  dissimilarities into <code>NA</code>. If there are no <code>NA</code>s in the
  input  and <code>toolong = 0</code>, <code>path = "shortest"</code>
  will find shorter paths for semi-metric indices, and <code>path = "extended"</code>
  will do nothing. Function <code><a href="distconnected.html">no.shared</a></code> can be
  used to set dissimilarities to <code>NA</code>.</p>
<p>If the data are disconnected or there is no path between all points,
  the result will
  contain <code>NA</code>s and a warning is issued. Several methods cannot
  handle <code>NA</code> dissimilarities, and this warning should be taken
  seriously. Function <code><a href="distconnected.html">distconnected</a></code> can be used to find
  connected groups and remove rare outlier observations or groups of
  observations.</p>
<p>Alternative <code>path = "shortest"</code> uses Dijkstra's method for
  finding flexible shortest paths, implemented as priority-first search
  for dense graphs (Sedgewick 1990). Alternative <code>path = "extended"</code>
  follows De'ath (1999), but implementation is simpler
  than in his code.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function returns an object of class <code>dist</code> with extended
  dissimilarities (see functions <code><a href="vegdist.html">vegdist</a></code> and
  <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>).
  The value of <code>path</code> is appended to the <code>method</code> attribute.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bradfield, G.E. &amp; Kenkel, N.C. (1987). Nonlinear ordination using
  flexible shortest path adjustment of ecological
  distances. <em>Ecology</em> 68, 750–753.</p>
<p>De'ath, G. (1999). Extended dissimilarity: a method of robust
  estimation of ecological distances from high beta diversity
  data. <em>Plant Ecol.</em> 144, 191–199.</p>
<p>Sedgewick, R. (1990). <em>Algorithms in C</em>. Addison Wesley.</p>
<p>Williamson, M.H. (1978). The ordination of incidence
  data. <em>J. Ecol.</em> 66, 911-920.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jari Oksanen</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The function changes the original dissimilarities, and not all
  like this. It may be best to  use  the
  function only when you really <em>must</em>:  extremely high
  beta diversity where a large proportion of dissimilarities are at their
  upper limit (no species in common).</p>
<p>Semi-metric indices vary in their degree of violating the triangle
  inequality. Morisita and Horn–Morisita indices of
  <code><a href="vegdist.html">vegdist</a></code> may be very strongly semi-metric, and shortest
  paths can change these indices very much. Mountford index violates
  basic rules of dissimilarities: non-identical sites have zero
  dissimilarity if species composition of the poorer site is a subset of
  the richer. With Mountford index, you can find three sites \(i, j,
    k\) so that \(d_{ik} = 0\) and \(d_{jk} = 0\), but \(d_{ij} &gt; 0\). The results of <code>stepacross</code>
  on Mountford index can be very weird. If <code>stepacross</code> is needed,
  it is best to try to use it with more metric indices only.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Function <code><a href="distconnected.html">distconnected</a></code> can find connected groups in
  disconnected data, and function <code><a href="distconnected.html">no.shared</a></code> can be used to
  set dissimilarities as <code>NA</code>.  See <code><a href="beals.html">swan</a></code> for an
  alternative approach. Function <code>stepacross</code> is an essential
  component in <code><a href="isomap.html">isomap</a></code> and <code><a href="spantree.html">cophenetic.spantree</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># There are no data sets with high beta diversity in vegan, but this</span></span></span>
<span class="r-in"><span><span class="co"># should give an idea.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edis</span> <span class="op">&lt;-</span> <span class="fu">stepacross</span><span class="op">(</span><span class="va">dis</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Too long or NA distances: 5 out of 190 (2.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepping across 190 dissimilarities...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">edis</span>, <span class="va">dis</span>, xlab <span class="op">=</span> <span class="st">"Shortest path"</span>, ylab <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stepacross-1.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Manhattan distance have no fixed upper limit.</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span>, <span class="st">"manhattan"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dis</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="distconnected.html">no.shared</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu">stepacross</span><span class="op">(</span><span class="va">dis</span>, toolong<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Too long or NA distances: 5 out of 190 (2.6%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepping across 190 dissimilarities...</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Tuomas Borman, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

