<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function ordisurf fits a smooth surface for given variable and
  plots the result on ordination diagram."><title>Fit and Plot Smooth Surfaces of Variables on Ordination. — ordisurf • vegan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit and Plot Smooth Surfaces of Variables on Ordination. — ordisurf"><meta property="og:description" content="Function ordisurf fits a smooth surface for given variable and
  plots the result on ordination diagram."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.6-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/FAQ-vegan.html">Vegan FAQ</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vegandevs/vegan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit and Plot Smooth Surfaces of Variables on Ordination.</h1>
      
      <div class="d-none name"><code>ordisurf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function <code>ordisurf</code> fits a smooth surface for given variable and
  plots the result on ordination diagram.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, knots <span class="op">=</span> <span class="fl">10</span>,</span>
<span>         family <span class="op">=</span> <span class="st">"gaussian"</span>, col <span class="op">=</span> <span class="st">"red"</span>, isotropic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         thinplate <span class="op">=</span> <span class="cn">TRUE</span>, bs <span class="op">=</span> <span class="st">"tp"</span>, fx <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         display <span class="op">=</span> <span class="st">"sites"</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">display</span><span class="op">)</span>, <span class="va">main</span>, nlevels <span class="op">=</span> <span class="fl">10</span>,</span>
<span>         <span class="va">levels</span>, npoints <span class="op">=</span> <span class="fl">31</span>, labcex <span class="op">=</span> <span class="fl">0.6</span>, bubble <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         cex <span class="op">=</span> <span class="fl">1</span>, select <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"REML"</span>, gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         plot <span class="op">=</span> <span class="cn">TRUE</span>, lwd.cl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for ordisurf</span></span>
<span><span class="fu"><a href="predict.cca.html">calibrate</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for ordisurf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contour"</span>,<span class="st">"persp"</span>,<span class="st">"gam"</span><span class="op">)</span>,</span>
<span>     add <span class="op">=</span> <span class="cn">FALSE</span>, bubble <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     nlevels <span class="op">=</span> <span class="fl">10</span>, <span class="va">levels</span>, labcex <span class="op">=</span> <span class="fl">0.6</span>, lwd.cl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>For <code>ordisurf</code> an ordination configuration, either a
    matrix or a result known by <code><a href="scores.html">scores</a></code>. For
    <code>plot.ordisurf</code> an object of class <code>"ordisurf"</code> as
    returned by <code>ordisurf</code>.</p></dd>

  <dt>y</dt>
<dd><p>Variable to be plotted / modelled as a function of the
    ordination scores.</p></dd>

  <dt>choices</dt>
<dd><p>Ordination axes.</p></dd>

  <dt>knots</dt>
<dd><p>Number of initial knots in <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> (one
    more than degrees of freedom). If <code>knots = 0</code> or
    <code>knots = 1</code>  the function will fit a linear trend surface, and
    if <code>knots = 2</code> the function  will fit a quadratic trend surface
    instead of a smooth surface. A vector of length 2 is allowed when
    <code>isotropic = FALSE</code>, with the first and second elements of
    <code>knots</code> referring to the first and second of ordination
    dimensions (as indicated by <code>choices</code>) respectively.</p></dd>

  <dt>family</dt>
<dd><p>Error distribution in <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code>.</p></dd>

  <dt>col</dt>
<dd><p>Colour of contours.</p></dd>

  <dt>isotropic, thinplate</dt>
<dd><p>Fit an isotropic smooth surface (i.e. same
    smoothness in both ordination dimensions) via
    <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code>. Use of <code>thinplate</code> is deprecated and
    will be removed in a future version of the package.</p></dd>

  <dt>bs</dt>
<dd><p>a two letter character string indicating the smoothing basis
    to use. (e.g. <code>"tp"</code> for thin plate regression spline,
    <code>"cr"</code> for cubic regression spline). One of <code>c("tp", "ts",
      "cr", "cs", "ds", "ps", "ad")</code>. See
    <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.terms.html" class="external-link">smooth.terms</a></code> for an over view of what these
    refer to. The default is to use thin plate splines: <code>bs = "tp"</code>.</p></dd>

  <dt>fx</dt>
<dd><p>indicates whether the smoothers are fixed degree of freedom
    regression splines (<code>fx = FALSE</code>) or penalised regression
    splines (<code>fx = TRUE</code>). Can be a vector of length 2 for
    anisotropic surfaces (<code>isotropic = FALSE</code>). It doesn't make
    sense to use <code>fx = TRUE</code> <strong>and</strong> <code>select = TRUE</code> and
    it is an <strong>error</strong> to do so. A warning is issued if you specify
    <code>fx = TRUE</code> and forget to use <code>select = FALSE</code> though
    fitting continues using <code>select = FALSE</code>.</p></dd>

  <dt>add</dt>
<dd><p>Add contours to an existing diagram or draw a new plot?</p></dd>

  <dt>display</dt>
<dd><p>Type of scores known by <code><a href="scores.html">scores</a></code>: typically
    "sites" for ordinary site scores or "lc" for linear combination scores.</p></dd>

  <dt>w</dt>
<dd><p>Prior weights on the data. Concerns mainly <code><a href="cca.html">cca</a></code>
    and <code><a href="decorana.html">decorana</a></code> results which have nonconstant weights.</p></dd>

  <dt>main</dt>
<dd><p>The main title for the plot, or as default the name of
    plotted variable in a new plot.</p></dd>

  <dt>nlevels, levels</dt>
<dd><p>Either a vector of <code>levels</code> for which contours
    are drawn, or suggested number of contours in <code>nlevels</code> if
    <code>levels</code> are not supplied.</p></dd>

  <dt>npoints</dt>
<dd><p>numeric; the number of locations at which to evaluate
    the fitted surface. This represents the number of locations in each
    dimension.</p></dd>

  <dt>labcex</dt>
<dd><p>Label size in contours.  Setting this zero will suppress
    labels.</p></dd>

  <dt>bubble</dt>
<dd><p>Use a “bubble plot” for points, or vary the point
    diameter by the value of the plotted variable. If <code>bubble</code> is
    numeric, its value is used for the maximum symbol size (as in
    <code>cex</code>), or if <code>bubble = TRUE</code>, the value of <code>cex</code> gives
    the maximum. The minimum size will always be <code>cex = 0.4</code>.  The
    option only has an effect if <code>add = FALSE</code>.</p></dd>

  <dt>cex</dt>
<dd><p>Character expansion of plotting symbols.</p></dd>

  <dt>select</dt>
<dd><p>Logical; specify <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> argument
    <code>"select"</code>. If this is <code>TRUE</code> then <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> can
    add an extra  penalty to each term so that it can be penalized to
    zero. This means that the smoothing parameter estimation that is part
    of fitting can completely remove terms from the model. If the
    corresponding smoothing parameter is estimated as zero then the extra
    penalty has no effect.</p></dd>

  <dt>method</dt>
<dd><p>character; the smoothing parameter estimation
    method. Options allowed are: <code>"GCV.Cp"</code> uses GCV for models with
    unknown scale parameter and Mallows' Cp/UBRE/AIC for models with
    known scale; <code>"GACV.Cp"</code> as for <code>"GCV.Cp"</code> but uses GACV
    (Generalised Approximate CV) instead of GCV; <code>"REML"</code> and
    <code>"ML"</code> use restricted maximum likelihood or maximum likelihood
    estimation for both known and unknown scale; and <code>"P-REML"</code> and
    <code>"P-ML"</code> use REML or ML estimation but use a Pearson estimate
    of the scale.</p></dd>

  <dt>gamma</dt>
<dd><p>Multiplier to inflate model degrees of freedom in GCV or
    UBRE/AIC score by. This effectively places an extra penalty on
    complex models. An oft-used value is <code>gamma = 1.4</code>.</p></dd>

  <dt>plot</dt>
<dd><p>logical; should any plotting be done by
    <code>ordisurf</code>? Useful if all you want is the fitted response
    surface model.</p></dd>

  <dt>lwd.cl</dt>
<dd><p>numeric; the <code>lwd</code> (line width) parameter to use
    when drawing the contour lines.</p></dd>

  <dt>formula, data</dt>
<dd><p>Alternative definition of the fitted model as
    <code>x ~ y</code>, where left-hand side is the ordination <code>x</code> and
    right-hand side the single fitted continuous variable
    <code>y</code>. The variable <code>y</code> must be in the working environment
    or in the data frame or environment given by <code>data</code>. All
    other arguments of are passed to the default method.</p></dd>

  <dt>object</dt>
<dd><p>An <code>ordisurf</code> result object.</p></dd>

  <dt>newdata</dt>
<dd><p>Coordinates in two-dimensional ordination for new
    points.</p></dd>

  <dt>what</dt>
<dd><p>character; what type of plot to produce. <code>"contour"</code>
    produces a contour plot of the response surface, see
    <code><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></code> for details. <code>"persp"</code> produces a
    perspective plot of the same, see <code><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></code> for
    details. <code>"gam"</code> plots the fitted GAM model, an object that
    inherits from class <code>"gam"</code> returned by <code>ordisurf</code>, see
    <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>.</p></dd>

  <dt>...</dt>
<dd><p>Other parameters passed to <code><a href="scores.html">scores</a></code>, or
    to the graphical functions. See Note below for exceptions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>Function <code>ordisurf</code> fits a smooth surface using penalised
  splines (Wood 2003) in <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code>, and uses
  <code><a href="https://rdrr.io/pkg/mgcv/man/predict.gam.html" class="external-link">predict.gam</a></code> to find fitted values in a regular
  grid. The smooth surface can be fitted with an extra penalty that
  allows the entire smoother to be penalized back to 0 degrees of
  freedom, effectively removing the term from the model (see Marra &amp;
  Wood, 2011). The addition of this extra penalty is invoked by
  setting argument <code>select</code> to <code>TRUE</code>. An alternative is to
  use a spline basis that includes shrinkage (<code>bs = "ts"</code> or
  <code>bs = "cs"</code>).</p>
<p><code>ordisurf()</code> exposes a large number of options from
  <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> for specifying the basis functions used for
  the surface. If you stray from the defaults, do read the
  <strong>Notes</strong> section below and relevant documentation in
  <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></code> and <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.terms.html" class="external-link">smooth.terms</a></code>.</p>
<p>The function plots the fitted contours with convex hull of data points
  either over an existing ordination diagram or draws a new plot. If
  <code>select = TRUE</code> and the smooth is effectively penalised out of
  the model, no contours will be plotted.</p>
<p><code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> determines the degree of smoothness for the
  fitted response surface during model fitting, unless <code>fx =
  TRUE</code>. Argument <code>method</code> controls how <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code>
  performs this smoothness selection. See <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> for
  details of the available options. Using <code>"REML"</code> or <code>"ML"</code>
  yields p-values for smooths with the best coverage properties if such
  things matter to you.</p>
<p>The function uses <code><a href="scores.html">scores</a></code> to extract ordination scores,
  and <code>x</code> can be any result object known by that function.</p>
<p>The user can supply a vector of prior weights <code>w</code>. If the
  ordination object has weights, these will be used. In practise this
  means that the row totals are used as weights with <code><a href="cca.html">cca</a></code>
  or <code><a href="decorana.html">decorana</a></code> results. If you do not like this, but want
  to give equal weights to all sites, you should set <code>w =
  NULL</code>. The behaviour is consistent with <code><a href="envfit.html">envfit</a></code>. For
  complete accordance with constrained <code><a href="cca.html">cca</a></code>, you should set
  <code>display = "lc"</code>.</p>
<p>Function <code>calibrate</code> returns the fitted values of the response
  variable. The <code>newdata</code> must be coordinates of points for which
  the fitted values are desired. The function is based on
  <code><a href="https://rdrr.io/pkg/mgcv/man/predict.gam.html" class="external-link">predict.gam</a></code> and will pass extra arguments to
  that function.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>ordisurf</code> is usually called for its side effect of drawing the
  contour plot. The function returns a result object of class</p>
<p></p>
<p><code>"ordisurf"</code> that inherits from <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> used
  internally to fit the surface, but adds an item <code>grid</code> that
  contains the data for the grid surface. The item <code>grid</code> has
  elements <code>x</code> and <code>y</code> which are vectors of axis coordinates,
  and element <code>z</code> that is a matrix of fitted values for</p>
<p></p>
<p><code><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></code>. The values outside the convex hull of observed
  points are indicated as <code>NA</code> in <code>z</code>. The</p>
<p></p>
<p><code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> component of the result can be used for
  further analysis like predicting new values (see</p>
<p></p>
<p><code><a href="https://rdrr.io/pkg/mgcv/man/predict.gam.html" class="external-link">predict.gam</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dave Roberts, Jari Oksanen and Gavin L. Simpson</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The default is to use an isotropic smoother via
  <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></code> employing thin plate regression splines
  (<code>bs = "tp"</code>). These make sense in ordination as they have
  equal smoothing in all directions and are rotation invariant. However,
  if different degrees of smoothness along dimensions are required, an
  anisotropic smooth surface may be more applicable. This can be
  achieved through the use of <code>isotropic = FALSE</code>, wherein the
  surface is fitted via a tensor product smoother via
  <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te</a></code> (unless <code>bs = "ad"</code>, in which case
  separate splines for each dimension are fitted using
  <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></code>).</p>
<p>Cubic regression splines and P splines can <strong>only</strong> be used with
  <code>isotropic = FALSE</code>.</p>
<p>Adaptive smooths (<code>bs = "ad"</code>), especially in two dimensions,
  require a large number of observations; without many hundreds of
  observations, the default complexities for the smoother will exceed
  the number of observations and fitting will fail.</p>
<p>To get the old behaviour of <code>ordisurf</code> use <code>select = FALSE</code>,
  <code>method = "GCV.Cp"</code>, <code>fx = FALSE</code>, and <code>bs = "tp"</code>. The
  latter two options are the current defaults.</p>
<p>Graphical arguments supplied to <code>plot.ordisurf</code> are passed on to
  the underlying plotting functions, <code>contour</code>, <code>persp</code>, and
  <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>. The exception to this is that arguments
  <code>col</code> and <code>cex</code> can not currently be passed to
  <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code> because of a bug in the way that function
  evaluates arguments when arranging the plot.</p>
<p>A work-around is to call <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code> directly on the
  result of a call to <code>ordisurf</code>. See the Examples for an
  illustration of this.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>The fitted GAM is a regression model and has the usual assumptions of
  such models. Of particular note is the assumption of independence of
  residuals. If the observations are not independent (e.g. they are
  repeat measures on a set of objects, or from an experimental design,
  <em>inter alia</em>) do not trust the <em>p</em>-values from the GAM
  output.</p>
<p>If you need further control (i.e. to add additional fixed effects to
  the model, or use more complex smoothers), extract the ordination
  scores using the <code>scores</code> function and then generate your own
  <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> call.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p>Marra, G.P &amp; Wood, S.N. (2011) Practical variable selection for
  generalized additive models. <em>Comput. Stat. Data Analysis</em> 55,
  2372--2387.</p>
<p>Wood, S.N. (2003) Thin plate regression splines.
  <em>J. R. Statist. Soc. B</em> 65, 95--114.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For basic routines <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code>,
  and <code><a href="scores.html">scores</a></code>. Function
  <code><a href="envfit.html">envfit</a></code> provides a more traditional and compact
  alternative.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vare.mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="monoMDS.html">monoMDS</a></span><span class="op">(</span><span class="va">vare.dist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_BEGIN</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, bubble <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.33  total = 6.33 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 93.94112     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## as above but without the extra penalties on smooth terms,</span></span></span>
<span class="r-in"><span><span class="co">## and using GCV smoothness selection (old behaviour of `ordisurf()`):</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, col <span class="op">=</span> <span class="st">"blue"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        select <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"GCV.Cp"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-1.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.34  total = 8.34 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV score: 154.2897     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Cover of Cladina arbuscula</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Cladarbu</span>, <span class="va">varespec</span>, family<span class="op">=</span><span class="va">quasipoisson</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-2.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## Get fitted values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.cca.html">calibrate</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         18         15         24         27         23         19         22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21.6245333  8.0344376  3.8614798  2.4595115  6.3958275  5.4260377  6.7158154 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         16         28         13         14         20         25          7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.6759768  0.8041457 31.1726268 16.1942820  9.5897933  5.4219853 29.8214589 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5          6          3          4          2          9         12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22.8500283 29.9936019  7.1653707 15.5309226  2.8467735  0.9051372  3.5541639 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         10         11         21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.3099294 10.7783687  0.9177922 </span>
<span class="r-in"><span><span class="co">## Variable selection via additional shrinkage penalties</span></span></span>
<span class="r-in"><span><span class="co">## This allows non-significant smooths to be selected out</span></span></span>
<span class="r-in"><span><span class="co">## of the model not just to a linear surface. There are 2</span></span></span>
<span class="r-in"><span><span class="co">## options available:</span></span></span>
<span class="r-in"><span><span class="co">##  - option 1: `select = TRUE` --- the *default*</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, method <span class="op">=</span> <span class="st">"REML"</span>, select <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-3.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.33  total = 6.33 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 93.94112     </span>
<span class="r-in"><span><span class="co">##  - option 2: use a basis with shrinkage</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, method <span class="op">=</span> <span class="st">"REML"</span>, bs <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-4.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "ts", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6.26  total = 7.26 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 98.83943     </span>
<span class="r-in"><span><span class="co">## or bs = "cs" with `isotropic = FALSE`</span></span></span>
<span class="r-in"><span><span class="co">## IGNORE_RDIFF_END</span></span></span>
<span class="r-in"><span><span class="co">## Plot method</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"contour"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-5.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plotting the "gam" object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"gam"</span><span class="op">)</span> <span class="co">## 'col' and 'cex' not passed on</span></span></span>
<span class="r-plt img"><img src="ordisurf-6.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## or via plot.gam directly</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: nlme</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is mgcv 1.9-1. For overview type 'help("mgcv-package")'.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></span><span class="op">(</span><span class="va">fit</span>, cex <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-7.png" alt="" width="700" height="1133"></span>
<span class="r-in"><span><span class="co">## 'col' effects all objects drawn...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### controlling the basis functions used</span></span></span>
<span class="r-in"><span><span class="co">## Use Duchon splines</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, bs <span class="op">=</span> <span class="st">"ds"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-8.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 10, bs = "ds", fx = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.33  total = 6.33 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 93.94117     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A fixed degrees of freedom smooth, must use 'select = FALSE'</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, knots <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                        fx <span class="op">=</span> <span class="cn">TRUE</span>, select <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-9.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ s(x1, x2, k = 4, bs = "tp", fx = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  total = 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 85.55126     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An anisotropic smoother with cubic regression spline bases</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, isotropic <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                        bs <span class="op">=</span> <span class="st">"cr"</span>, knots <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-10.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ te(x1, x2, k = c(4, 4), bs = c("cr", "cr"), fx = c(FALSE, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     FALSE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.08  total = 4.08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 93.02782     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An anisotropic smoother with cubic regression spline with</span></span></span>
<span class="r-in"><span><span class="co">## shrinkage bases &amp; different degrees of freedom in each dimension</span></span></span>
<span class="r-in"><span><span class="fu">ordisurf</span><span class="op">(</span><span class="va">vare.mds</span> <span class="op">~</span> <span class="va">Baresoil</span>, <span class="va">varechem</span>, isotropic <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                        bs <span class="op">=</span> <span class="st">"cs"</span>, knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, fx <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        select <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordisurf-11.png" alt="" width="700" height="1133"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: identity </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y ~ te(x1, x2, k = c(3, 4), bs = c("cs", "cs"), fx = c(TRUE, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  total = 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 42.9834     </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jari Oksanen, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R.B. O’Hara, Peter Solymos, M. Henry H. Stevens, Eduard Szoecs, Helene Wagner, Matt Barbour, Michael Bedward, Ben Bolker, Daniel Borcard, Gustavo Carvalho, Michael Chirico, Miquel De Caceres, Sebastien Durand, Heloisa Beatriz Antoniazi Evangelista, Rich FitzJohn, Michael Friendly, Brendan Furneaux, Geoffrey Hannigan, Mark O. Hill, Leo Lahti, Dan McGlinn, Marie-Helene Ouellette, Eduardo Ribeiro Cunha, Tyler Smith, Adrian Stier, Cajo J.F. Ter Braak, James Weedon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

